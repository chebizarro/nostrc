/* GNostr Signer application stylesheet */

/* ===== Responsive Design Styles ===== */

/*
 * Responsive Breakpoints (defined in signer-window.ui via AdwBreakpoint):
 *
 * Mobile (< 500px):
 *   - Bottom bar (AdwViewSwitcherBar) is revealed
 *   - Sidebar is collapsed and hidden
 *   - AdwViewSwitcherTitle shows title instead of switcher
 *   - Forms stack vertically with reduced margins (12px)
 *   - Touch targets are enlarged (44px minimum)
 *
 * Tablet (500px - 800px):
 *   - Sidebar is in overlay mode (collapsed but accessible)
 *   - Bottom bar is hidden
 *   - Content uses AdwClamp tightening at ~400px
 *
 * Desktop (> 800px):
 *   - Sidebar is always visible (split view)
 *   - Full navigation visible in header
 *   - Standard margins and spacing
 *
 * Common Test Widths:
 *   - 360px: Mobile portrait (minimum supported)
 *   - 768px: Tablet portrait
 *   - 1024px: Tablet landscape / small desktop
 *   - 1440px: Standard desktop
 *
 * AdwClamp tightening-threshold values:
 *   - Dialogs/sheets: 360-400px
 *   - Main content: 400-500px
 *   - Profile dashboard: 400px
 */

/* Base responsive spacing - mobile first */
.responsive-margins {
  margin-start: 12px;
  margin-end: 12px;
}

/* Larger margins on wider screens */
@media (min-width: 600px) {
  .responsive-margins {
    margin-start: 16px;
    margin-end: 16px;
  }
}

@media (min-width: 1024px) {
  .responsive-margins {
    margin-start: 24px;
    margin-end: 24px;
  }
}

/* Responsive form field spacing */
.form-spacing-mobile {
  margin-bottom: 12px;
}

.form-spacing-tablet {
  margin-bottom: 16px;
}

/* Compact sidebar for narrow screens */
.navigation-sidebar.compact row {
  padding: 6px 8px;
}

/* Bottom bar styling for mobile */
viewswitcherbar {
  border-top: 1px solid alpha(@borders, 0.5);
}

/* Responsive dialog sizing - ensure dialogs work on mobile */
dialog.responsive {
  min-width: 280px;
  max-width: 100vw;
}

/* Stack forms vertically on narrow screens */
.responsive-form-row {
  flex-direction: row;
}

@media (max-width: 480px) {
  .responsive-form-row {
    flex-direction: column;
  }

  .responsive-form-row > * {
    margin-bottom: 8px;
  }
}

/* Responsive font scaling for narrow screens */
@media (max-width: 360px) {
  .title-1 {
    font-size: 1.4em;
  }

  .title-2 {
    font-size: 1.2em;
  }

  .title-3 {
    font-size: 1.1em;
  }
}

/* Touch-friendly targets for mobile */
@media (pointer: coarse) {
  button,
  .activatable,
  row.activatable {
    min-height: 44px;
  }

  listboxrow {
    min-height: 48px;
  }
}

/* ===== Adaptive Layout Helpers ===== */

/* Action button grid - responsive sizing */
.action-button {
  min-width: 100px;
  transition: all 200ms ease;
}

@media (max-width: 480px) {
  .action-button {
    min-width: 80px;
    padding: 8px;
  }

  .action-button image {
    -gtk-icon-size: 24px;
  }
}

/* Profile dashboard responsive adjustments */
.profile-header {
  padding: 16px;
}

@media (max-width: 400px) {
  .profile-header {
    padding: 8px;
  }

  .profile-header avatar {
    -gtk-avatar-size: 72px;
  }
}

/* Sidebar navigation - compact mode */
.navigation-sidebar row {
  padding: 8px 12px;
  min-height: 44px;
}

@media (max-width: 500px) {
  .navigation-sidebar row {
    padding: 6px 8px;
  }
}

/* Dialog responsive behavior */
dialog {
  min-width: 280px;
}

@media (max-width: 400px) {
  dialog headerbar button {
    padding: 6px 8px;
  }
}

/* Bottom bar styling for mobile view */
viewswitcherbar {
  background-color: @headerbar_bg_color;
}

/* Ensure proper spacing on narrow screens */
@media (max-width: 360px) {
  preferencesgroup {
    margin-start: 8px;
    margin-end: 8px;
  }

  entryrow,
  actionrow,
  passwordentryrow {
    margin-start: 4px;
    margin-end: 4px;
  }
}

/* ===== Status label styles ===== */
.status-ok {
  color: #2e7d32;
  font-weight: bold;
}
.status-error {
  color: #c62828;
  font-weight: bold;
}

/* Ensure suffix action buttons in rows follow HIG sizing */
.suffix-action {
  min-height: 28px; /* HIG comfortable touch target */
  padding: 4px 10px;
}

/* ===== Keyboard Navigation & Focus Indicators ===== */

/* Enhanced focus indicators for keyboard navigation */
*:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* Focus ring for buttons */
button:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* Focus ring for suggested/destructive action buttons - higher contrast */
button.suggested-action:focus-visible,
button.destructive-action:focus-visible {
  outline: 3px solid @accent_color;
  outline-offset: 2px;
}

/* Focus indicator for entry rows */
entry:focus-visible,
password-entry:focus-visible,
row.activatable:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: -1px;
}

/* Focus indicator for text views */
textview:focus-visible text {
  outline: 2px solid @accent_color;
  outline-offset: 1px;
}

/* Focus indicator for list box rows */
listboxrow:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: -2px;
}

/* Focus indicator for sidebar navigation */
.navigation-sidebar row:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: -2px;
  background-color: alpha(@accent_color, 0.1);
}

/* Focus indicator for check buttons */
checkbutton:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* Focus indicator for switches */
switch:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 3px;
}

/* Focus indicator for drop downs */
dropdown:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* Focus indicator for menu buttons */
menubutton:focus-visible > button {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* Focus indicator for link buttons */
linkbutton:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* ===== Keyboard Shortcut Hints ===== */

/* Style for shortcut hints shown in tooltips */
.keyboard-shortcut {
  font-family: monospace;
  font-size: 0.9em;
  padding: 2px 6px;
  background-color: alpha(@window_fg_color, 0.1);
  border-radius: 4px;
}

/* ===== Dialog Focus Management ===== */

/* Ensure dialogs have visible focus indicators */
dialog *:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
}

/* Default button styling in dialogs for Enter key activation */
dialog button.suggested-action {
  font-weight: bold;
}

/* ===== Action Button Grid Focus ===== */

/* Focus indicator for action buttons in profile dashboard */
.action-button:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 3px;
  border-radius: 12px;
}

/* Flowbox focus handling */
flowboxchild:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 2px;
  border-radius: 8px;
}

/* ===== Skip Links for Keyboard Navigation (nostrc-tz8w) ===== */

/* Skip link button - hidden by default, shown on focus */
.skip-link {
  position: absolute;
  top: -100px;
  left: 12px;
  z-index: 9999;
  padding: 8px 16px;
  background-color: @accent_bg_color;
  color: @accent_fg_color;
  border-radius: 6px;
  font-weight: bold;
  transition: top 0.2s ease;
}

.skip-link:focus-visible {
  top: 12px;
  outline: 3px solid @accent_color;
  outline-offset: 2px;
}

/* ===== Enhanced Focus States for Lists (nostrc-tz8w) ===== */

/* Selection and focus for sidebar rows */
.navigation-sidebar row:selected {
  background-color: alpha(@accent_color, 0.15);
}

.navigation-sidebar row:selected:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: -2px;
  background-color: alpha(@accent_color, 0.2);
}

/* Focus for AdwEntryRow and AdwPasswordEntryRow */
row.entry:focus-within {
  outline: 2px solid @accent_color;
  outline-offset: -1px;
  border-radius: 8px;
}

/* Focus for AdwActionRow when activatable */
row.activatable:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: -2px;
}

/* ===== Dialog Default Button Enhancement (nostrc-tz8w) ===== */

/* Pulse animation for default action button when focused */
@keyframes pulse-focus {
  0%, 100% { box-shadow: 0 0 0 0 alpha(@accent_color, 0.4); }
  50% { box-shadow: 0 0 0 4px alpha(@accent_color, 0.2); }
}

dialog button.suggested-action:focus-visible {
  animation: pulse-focus 2s ease-in-out infinite;
}

/* ===== Spinner Focus (for forms in progress) ===== */

spinner:focus-visible {
  outline: 2px solid @accent_color;
  outline-offset: 4px;
  border-radius: 50%;
}

/* ===== High Contrast Mode Support ===== */

@media (prefers-contrast: more) {
  *:focus-visible {
    outline: 3px solid @accent_color;
    outline-offset: 3px;
  }

  button.suggested-action:focus-visible,
  button.destructive-action:focus-visible {
    outline: 4px solid @accent_color;
    outline-offset: 3px;
  }

  .skip-link:focus-visible {
    outline: 4px solid @accent_color;
    outline-offset: 3px;
  }

  .navigation-sidebar row:focus-visible {
    outline: 3px solid @accent_color;
    outline-offset: -3px;
  }
}

/* ===== Reduced Motion Support ===== */

@media (prefers-reduced-motion: reduce) {
  * {
    transition-duration: 0s !important;
  }
}

/* ===== Onboarding Assistant Styles ===== */

/* Passphrase strength meter colors */
levelbar.strength-weak block.filled {
  background-color: #c62828; /* Red - weak */
}

levelbar.strength-fair block.filled {
  background-color: #ef6c00; /* Orange - fair */
}

levelbar.strength-good block.filled {
  background-color: #f9a825; /* Yellow/amber - good */
}

levelbar.strength-strong block.filled {
  background-color: #2e7d32; /* Green - strong */
}

/* Card style for path selection boxes */
.card {
  padding: 16px;
  border-radius: 12px;
  background-color: alpha(@card_bg_color, 0.8);
  border: 1px solid alpha(@borders, 0.5);
}

.card:hover {
  background-color: alpha(@card_bg_color, 1.0);
  border-color: @accent_color;
}

/* Heading style for option titles */
.heading {
  font-weight: bold;
  font-size: 1.1em;
}

/* Caption style for small helper text */
.caption {
  font-size: 0.85em;
}

/* Success icon color */
image.success {
  color: #2e7d32;
}

/* Warning icon color */
image.warning {
  color: #ef6c00;
}

/* Accent icon color */
image.accent {
  color: @accent_color;
}

/* ===== Approval Dialog Styles ===== */

/* Status banner for pending signature request */
.status-banner {
  padding: 12px 16px;
  border-radius: 8px;
  margin-bottom: 8px;
}

.status-banner.pending {
  background-color: alpha(#8b2635, 0.15);
}

.pending-title {
  color: #8b2635;
  font-weight: bold;
}

.pending-icon {
  color: #8b2635;
}

/* Approve button - green */
button.approve-btn {
  background-color: #2e7d32;
  color: white;
}

button.approve-btn:hover {
  background-color: #388e3c;
}

button.approve-btn:active {
  background-color: #1b5e20;
}

button.approve-btn:disabled {
  background-color: alpha(#2e7d32, 0.5);
  color: alpha(white, 0.5);
}

/* Deny button - red */
button.deny-btn {
  background-color: #c62828;
  color: white;
}

button.deny-btn:hover {
  background-color: #d32f2f;
}

button.deny-btn:active {
  background-color: #b71c1c;
}

/* Details expander styling */
.details-expander {
  margin-top: 8px;
}

.details-expander > title {
  font-size: 0.9em;
  color: alpha(@window_fg_color, 0.7);
}
