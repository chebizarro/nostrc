using Gtk 4.0;
using Adw 1;

template $SheetRelayConfig: Adw.Dialog {
  title: _("Manage Relays");
  content-width: 400;
  content-height: -1;
  can-close: true;
  follows-content-size: true;

  accessibility {
    label: "Relay configuration dialog";
    description: "Configure which Nostr relays to use";
  }

  Adw.ToolbarView {
    [top]
    Adw.HeaderBar {
      show-title: false;

      styles [
        "flat",
      ]
    }

    Box {
      orientation: vertical;
      spacing: 16;
      margin-start: 20;
      margin-end: 20;
      margin-bottom: 20;

      /* Header */
      Label {
        label: _("Manage Relays");
        halign: start;

        styles [
          "title-2",
        ]
      }

      /* Relay List */
      ListBox list_relays {
        selection-mode: none;

        accessibility {
          label: "Configured relays";
          description: "List of relays. Check to enable, uncheck to disable.";
        }

        styles [
          "boxed-list",
        ]
      }

      /* Add Relay Link */
      Box box_add_relay {
        orientation: vertical;
        spacing: 8;

        Button btn_add_relay {
          halign: start;

          Box {
            orientation: horizontal;
            spacing: 6;

            Image {
              icon-name: "list-add-symbolic";
            }

            Label {
              label: _("Add Relay");
            }
          }

          accessibility {
            label: "Add new relay";
            description: "Click to add a new relay URL";
          }

          styles [
            "flat",
            "link",
          ]
        }

        /* Hidden entry that appears when adding */
        Box box_add_entry {
          orientation: horizontal;
          spacing: 8;
          visible: false;

          Entry entry_url {
            placeholder-text: _("wss://relay.example.com");
            hexpand: true;

            accessibility {
              label: "Relay URL";
              description: "Enter a WebSocket relay URL";
            }
          }

          Button btn_add {
            icon-name: "list-add-symbolic";

            accessibility {
              label: "Add";
              description: "Add the relay";
            }

            styles [
              "suggested-action",
            ]
          }

          Button btn_cancel_add {
            icon-name: "window-close-symbolic";

            accessibility {
              label: "Cancel";
              description: "Cancel adding relay";
            }
          }
        }
      }

      /* Action Buttons */
      Box {
        orientation: horizontal;
        spacing: 12;
        homogeneous: true;
        margin-top: 12;

        Button btn_cancel {
          label: _("Cancel");
          hexpand: true;

          accessibility {
            label: "Cancel";
            description: "Close without saving";
          }

          styles [
            "pill",
          ]
        }

        Button btn_save {
          label: _("Save");
          hexpand: true;

          accessibility {
            label: "Save";
            description: "Save relay configuration";
          }

          styles [
            "pill",
            "suggested-action",
          ]
        }
      }
    }
  }
}
