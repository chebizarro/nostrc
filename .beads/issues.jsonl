{"id":"nostrc-00u","title":"Implement NIP-57 Lightning Zaps","description":"Implement NIP-57 Lightning Zaps ‚Äî the tipping/payment layer for Nostr.\n\n- Parse zap receipts (kind 9735) and display zap amounts on notes\n- Zap button on note cards with amount selector\n- Create zap request (kind 9734) with proper tags (relays, amount, lnurl, p, e)\n- LNURL-pay flow: fetch callback URL, get invoice, present to user\n- Zap receipt verification (validate bolt11 description hash matches zap request)\n- Zap statistics from ndb_note_meta if available\n- Integration with existing reaction/repost count display","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-02-08T04:42:47.663647-08:00","created_by":"mayor","updated_at":"2026-02-08T12:29:29.367701-08:00","closed_at":"2026-02-08T12:29:29.367701-08:00","close_reason":"Closed"}
{"id":"nostrc-05yz","title":"harden-6+8: Label guard header + disposed flags","status":"open","priority":1,"issue_type":"task","assignee":"brett","created_at":"2026-02-10T16:44:55.70865-08:00","created_by":"mayor","updated_at":"2026-02-10T16:44:55.70865-08:00"}
{"id":"nostrc-0hp","title":"Timeline architecture overhaul: Calm, graceful, crash-free UI","description":"## Problem Statement\n\nThe timeline views are fundamentally broken at an architectural level. Crashes appearing in GTK/Pango/GLib are NOT bugs at those crash sites - they are **heap corruption caused by overwhelming the UI toolkit**.\n\n### Symptoms\n- Events cascade in chaotically\n- \"New Notes\" button has janky timeout then sudden rush of items\n- No smooth animation - events fly past without rendering properly\n- 1 in 10 chance of crashing the app\n- Backtraces show crashes in random GTK/Pango locations (heap corruption)\n\n### Root Cause\nThe timeline architecture floods GTK with updates faster than it can handle:\n1. Each g_list_model_items_changed() triggers widget creation, layout, rendering\n2. Items arrive faster than 16ms frame time\n3. Widgets created/destroyed faster than GLib's allocator can handle\n4. No backpressure from UI to data layer\n5. Deferred items dumped all at once instead of smoothly animated\n\n### Current Anti-Patterns\n- g_list_model_items_changed() called per-item in tight loops\n- g_idle_add() used for batching but still overwhelms\n- No awareness of GdkFrameClock or frame budget\n- No rate limiting on insertions\n- Animation attempts fight with rapid model changes\n\n## Required Architecture\n\n### 1. Frame-Aware Update Loop\n- Hook into GdkFrameClock::update signal\n- Accumulate model changes between frames\n- Apply ONE batched items_changed per frame maximum\n- Respect 16ms frame budget\n\n### 2. Throttled Insertion Pipeline\nEvents arrive -\u003e Queue (unlimited) -\u003e Throttle (N per frame) -\u003e Model -\u003e UI\n- Max 3-5 items inserted per frame\n- Smooth reveal animation for each item\n- If queue grows too large, increase batch size but add delay\n\n### 3. Calm \"New Notes\" Reveal\n- When user clicks \"New Notes\", don't dump all at once\n- Animate items in one-by-one with 50-100ms stagger\n- Smooth scroll accompanies insertion\n- User sees items \"arriving\" gracefully\n\n### 4. Backpressure Mechanism\n- If pending queue \u003e threshold, signal upstream to slow down\n- Pause subscription processing during heavy UI work\n- Resume when queue drains below threshold\n\n### 5. Widget Recycling Respect\n- GtkListView recycles widgets - work WITH this, not against it\n- Ensure prepare_for_unbind completes before widget reuse\n- Don't trigger rapid bind/unbind cycles\n\n### 6. Memory Allocation Pacing\n- Avoid malloc/free storms that corrupt heap\n- Pool frequently allocated objects\n- Batch deallocations to idle periods\n\n## Implementation Phases\n\n### Phase 1: Frame-Aware Batching\n- Add GdkFrameClock integration to GnNostrEventModel\n- Accumulate changes, apply once per frame\n- Remove per-item items_changed calls\n\n### Phase 2: Throttled Insertion\n- Implement insertion queue with rate limiting\n- Max items per frame configurable\n- Metrics on queue depth and insertion rate\n\n### Phase 3: Smooth Animation\n- Staggered reveal for new items\n- CSS transitions for opacity/transform\n- Scroll position management during insertion\n\n### Phase 4: Backpressure\n- Queue depth monitoring\n- Upstream throttling signals\n- Graceful degradation under load\n\n### Phase 5: Testing \u0026 Hardening\n- Stress test with rapid event streams\n- Memory profiling for allocation patterns\n- Crash-free guarantee under all conditions\n\n## Success Criteria\n- Zero crashes under rapid event load\n- Smooth 60fps scrolling during updates\n- \"New Notes\" reveals items gracefully over ~500ms\n- No janky timeouts or sudden rushes\n- Memory usage stable under load\n- User experience is \"calm, graceful, responsive, solid\"\n\n## Files Likely Affected\n- apps/gnostr/src/model/gn-nostr-event-model.c (core changes)\n- apps/gnostr/src/ui/gnostr-timeline-view.c\n- apps/gnostr/src/ui/gn-timeline-view.c\n- apps/gnostr/src/ui/gnostr-main-window.c (New Notes handling)\n- New: apps/gnostr/src/ui/timeline-animator.c (animation controller)\n\n## Review Requirements\nThis is a critical architectural change. Before ANY code is committed:\n1. Design document reviewed by 2+ agents\n2. Implementation plan approved\n3. Each phase reviewed before merge\n4. Stress testing required before close","status":"closed","priority":0,"issue_type":"epic","assignee":"billy","created_at":"2026-01-29T18:12:06.794172-08:00","created_by":"mayor","updated_at":"2026-01-29T21:01:27.368779-08:00","closed_at":"2026-01-29T21:01:27.368779-08:00","close_reason":"All 5 phases complete: (1) Frame-aware batching, (2) Throttled insertion pipeline, (3) Smooth reveal animation, (4) Backpressure, (5) Stress testing passed. 8/8 stress tests pass including 1000+ events/minute with 0% frame budget overruns.","labels":["architecture","multi-agent-review","needs-design-review"]}
{"id":"nostrc-0kz","title":"Fix heap-buffer-overflow in note_card_row prepare_for_unbind","description":"## Problem\n\nASAN crash during widget unbinding when clicking 'New Notes' or rapid scrolling:\n\n```\nheap-buffer-overflow on address in gnostr_note_embed_prepare_for_unbind\nWRITE of size 4 at offset 720 bytes past allocated region\n```\n\n## Root Cause\n\n`self-\u003enote_embed` and `self-\u003eog_preview` cached pointers become stale when:\n1. Widget is destroyed during row recycling\n2. Memory is reused for other allocations (signal handler data)\n3. prepare_for_unbind tries to write to freed memory\n\n## Fix\n\nDon't call prepare_for_unbind on embedded widgets directly. Instead:\n- Cancel parent's async_cancellable (which they share)\n- Let their own dispose() handle cleanup\n- Just clear the cached pointers\n\nAlso fixed related issue: timer callbacks returning G_SOURCE_REMOVE without clearing\ntimestamp_timer_id, causing 'Source ID not found' GLib-CRITICAL errors.\n\n## Files Changed\n- apps/gnostr/src/ui/note_card_row.c","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-30T10:30:19.828051-08:00","created_by":"mayor","updated_at":"2026-01-30T10:30:29.172862-08:00","closed_at":"2026-01-30T10:30:29.172862-08:00","close_reason":"Fixed by removing direct prepare_for_unbind calls on cached widget pointers and clearing timer_id on G_SOURCE_REMOVE","labels":["asan","crash"]}
{"id":"nostrc-0q4","title":"P0 ASAN: go_channel_try_receive heap-buffer-overflow - channel corruption","description":"The go_channel_try_receive at channel.c:542 is reading chan-\u003ebuffer[chan-\u003eout] past the end of allocated memory. The 184-byte region (actually a pango layout object) was allocated in gtk_widget_create_pango_layout. This suggests the channel struct is corrupted, uninitialized, or being accessed after the channel was freed. Check: (1) channel lifetime vs relay thread lifetime, (2) initialization of channel struct members, (3) possibility of double-free or use-after-free on the channel itself. Stack: message_loop -\u003e nostr_connection_read_message -\u003e go_select -\u003e go_channel_try_receive.","status":"closed","priority":0,"issue_type":"bug","assignee":"billy","created_at":"2026-01-29T15:53:21.884014-08:00","created_by":"mayor","updated_at":"2026-01-29T16:01:50.826251-08:00","closed_at":"2026-01-29T16:01:50.826251-08:00","close_reason":"Fixed use-after-free by holding context refs in worker threads"}
{"id":"nostrc-0v0","title":"Invalid signature tracking list grows unbounded","description":"\n## Location\nlibnostr/src/relay.c:36-69\n\n## Description\nThe `InvalidSigNode` linked list for tracking pubkeys with invalid signatures grows without bound:\n\n```c\nstatic InvalidSigNode *invalidsig_get_or_add(NostrRelay *r, const char *pk) {\n    InvalidSigNode *n = invalidsig_find(head, pk);\n    if (n) return n;\n    n = (InvalidSigNode *)calloc(1, sizeof(InvalidSigNode));\n    // ... adds to head, never evicts\n}\n```\n\nEvery unique pubkey that sends an invalid signature is added, but there's no eviction mechanism.\n\n## Impact\nA malicious actor could exhaust memory by sending events with many different invalid pubkeys. Even legitimate use could accumulate entries over time.\n\n## Fix Suggestion\nAdd an LRU eviction policy or a maximum list size (e.g., 10,000 entries). When limit is reached, evict oldest entries or those whose ban has expired.\n","status":"closed","priority":2,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T10:30:16.72532-08:00","created_by":"nostrc/crew/billy","updated_at":"2026-01-29T11:06:03.629497-08:00","closed_at":"2026-01-29T11:06:03.629497-08:00","close_reason":"Added LRU eviction to invalid signature list with 10k max entries","labels":["memory-growth","security"]}
{"id":"nostrc-1","title":"NIP-01: Note Publishing \u0026 Event Creation","description":"Implement complete note publishing functionality following NIP-01 specifications. The gnostr app has a composer widget (GnostrComposer) but needs full event creation, signing, and publishing to relays.\n\n## Current State\n- GnostrComposer widget exists at apps/gnostr/src/ui/gnostr-composer.c\n- Signing infrastructure exists (NIP-46 remote signer, NIP-49 local keys)\n- SimplePool handles relay connections\n- **libnostr already provides**: event serialization, SHA256 ID calculation, Schnorr signing, and relay publishing APIs\n\n## What's Already Done (libnostr)\n- `nostr_event_serialize_nip01_array()` - NIP-01 canonical serialization\n- `nostr_event_get_id()` - SHA256 hash calculation\n- `nostr_event_sign()` / `nostr_event_sign_secure()` - Schnorr signatures\n- `nostr_relay_publish()` - Publishing to relays\n- `nostr_nip01_add_e_tag()` / `nostr_nip01_add_p_tag()` - Tag builders\n\n## What Needs Implementation\n1. Wire composer to create and publish events using libnostr\n2. Access user's private key from signing infrastructure\n3. Handle OK responses and show feedback\n4. Reply threading UI and tag generation\n5. Mention detection and autocomplete","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:17:07.850105-08:00","closed_at":"2026-01-19T13:17:07.850105-08:00","close_reason":"Already implemented in libnostr","labels":["core","nip-01","publishing"]}
{"id":"nostrc-10","title":"Implement gift wrap creation (kind 1059)","description":"Create gift-wrapped messages for private DM delivery.\n\n## Technical Requirements\n\n### Gift Wrap Structure\nKind 1059 event:\n```json\n{\n  \"kind\": 1059,\n  \"created_at\": \u003crandomized timestamp\u003e,\n  \"pubkey\": \"\u003crandom-public-key\u003e\",\n  \"tags\": [[\"p\", \"\u003creceiver-pubkey\u003e\"]],\n  \"content\": \"\u003cnip44-encrypted-seal\u003e\",\n  \"sig\": \"\u003csignature-with-random-key\u003e\"\n}\n```\n\n### Creation Flow\n1. Create unsigned kind 14 chat message\n2. Encrypt kind 14 with NIP-44 (sender privkey + receiver pubkey)\n3. Create kind 13 seal with encrypted content, sign with sender key\n4. Generate random keypair for anonymity\n5. Encrypt seal with NIP-44 (random privkey + receiver pubkey)\n6. Create kind 1059 with encrypted seal\n7. Sign with random private key\n8. Randomize created_at (up to 2 days in past)\n\n### For Each Message, Create Two Gift Wraps\n1. One for the receiver\n2. One for the sender (backup/recovery)\n\n## Implementation\n```c\nGPtrArray* create_gift_wraps(const char *message,\n                             const uint8_t *sender_privkey,\n                             GPtrArray *receiver_pubkeys);\n```\n\n## Files to Modify\n- Create: apps/gnostr/src/nostr/gift_wrap.c\n- Create: apps/gnostr/src/nostr/gift_wrap.h\n\n## Security\n- Use cryptographically secure random for keypair\n- Destroy random private key after signing\n- Randomize timestamp convincingly","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:32:28.362763-08:00","closed_at":"2026-01-19T13:32:28.362763-08:00","close_reason":"Implemented in nips/nip17/","labels":["encryption","nip-17"]}
{"id":"nostrc-11","title":"Implement gift wrap decryption and verification","description":"Decrypt received gift wraps and verify sender authenticity.\n\n## Technical Requirements\n\n### Decryption Flow\n1. Receive kind 1059 gift wrap event\n2. Decrypt content with NIP-44 (receiver privkey + gift wrap pubkey)\n3. Parse decrypted content as kind 13 seal\n4. Decrypt seal content with NIP-44 (receiver privkey + seal pubkey)\n5. Parse decrypted content as kind 14/15 message\n\n### CRITICAL: Sender Verification\nMUST verify: seal.pubkey == inner_message.pubkey\n- Prevents sender impersonation attacks\n- If mismatch, discard message and log warning\n\n### Message Structure After Decryption\n```c\ntypedef struct {\n    char *sender_pubkey;      // from seal\n    char *content;            // message text\n    GPtrArray *recipients;    // p-tags from kind 14\n    char *subject;            // optional conversation topic\n    char *reply_to;           // e-tag if reply\n    int64_t created_at;       // original timestamp\n} DecryptedDM;\n```\n\n## Files to Create/Modify\n- apps/gnostr/src/nostr/gift_wrap.c\n- Add decryption to event processing pipeline\n\n## Error Handling\n- Invalid encryption: log and discard\n- Verification failure: log warning, discard\n- Malformed inner message: log and discard","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:32:28.363996-08:00","closed_at":"2026-01-19T13:32:28.363996-08:00","close_reason":"Implemented in nips/nip17/","labels":["encryption","nip-17","security"]}
{"id":"nostrc-12","title":"Create DM inbox view","description":"Build the direct messages inbox UI with conversation list and message view.\n\n## UI Requirements\n\n### Inbox Layout\n1. Left panel: Conversation list\n   - Avatar + name of conversation partner(s)\n   - Last message preview (truncated)\n   - Timestamp of last message\n   - Unread indicator badge\n   - Sorted by most recent\n\n2. Right panel: Message thread\n   - Message bubbles (left=received, right=sent)\n   - Timestamps on messages\n   - Read receipts (optional)\n   - Scroll to bottom on new message\n\n3. Compose area at bottom\n   - Text input with send button\n   - Attachment button for files\n   - Subject/topic display\n\n### Navigation\n- Add DM tab/icon to main window header\n- Badge showing unread DM count\n- Click conversation to open thread\n- New DM button to start conversation\n\n### Conversation Grouping\nConversations defined by: sender_pubkey + set of p-tags\n- Same participants = same conversation\n- Adding/removing participant = new conversation\n\n## Files to Create\n- apps/gnostr/src/ui/gnostr-dm-inbox.c\n- apps/gnostr/src/ui/gnostr-dm-inbox.h\n- apps/gnostr/src/ui/gnostr-dm-thread.c\n- apps/gnostr/src/ui/gnostr-dm-thread.h\n- apps/gnostr/data/ui/widgets/gnostr-dm-inbox.ui\n- apps/gnostr/data/ui/widgets/gnostr-dm-thread.ui\n\n## Model\n- Create GnDMConversation model\n- Create GnDMMessage model\n- Use GListModel for conversation list","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:54:04.43787-08:00","closed_at":"2026-01-19T13:54:04.43787-08:00","close_reason":"Implemented DM inbox view UI components","labels":["gtk","nip-17","ui"]}
{"id":"nostrc-13","title":"Implement DM relay preferences (kind 10050)","description":"Manage user's preferred relays for receiving DMs.\n\n## Technical Requirements\n\n### Kind 10050 Event Structure\n```json\n{\n  \"kind\": 10050,\n  \"content\": \"\",\n  \"tags\": [\n    [\"relay\", \"wss://inbox.example.com\"],\n    [\"relay\", \"wss://dm.relay.io\"]\n  ]\n}\n```\n\n### Publishing User's DM Relays\n1. User configures preferred DM relays in settings\n2. Publish kind 10050 event signed by user\n3. Spread to multiple relays for discovery\n\n### Reading Recipient's DM Relays\n1. Before sending DM, query recipient's kind 10050\n2. If found, publish gift wraps to those relays\n3. If not found, recipient not ready for NIP-17 DMs\n   - Show warning to sender\n   - Optionally fall back to legacy DM (NIP-04)\n\n### UI Settings\n- DM relay configuration in settings dialog\n- List of relay URLs\n- Add/remove/edit relays\n- Recommended: 1-3 relays (privacy vs reliability)\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-settings-dialog.c (UI)\n- Create: apps/gnostr/src/nostr/dm_relays.c (logic)\n- apps/gnostr/data/ui/dialogs/gnostr-settings-dialog.ui\n\n## Integration\n- Fetch kind 10050 before sending any DM\n- Cache recipient DM relays with TTL\n- Handle relay failures gracefully","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:59:39.921332-08:00","closed_at":"2026-01-19T13:59:39.921332-08:00","close_reason":"Implemented kind 10050 DM relay preferences: nostr_nip17_create_dm_relay_list, nostr_nip17_parse_dm_relay_list, nostr_nip17_free_dm_relay_list, nostr_nip17_get_dm_relays_from_event. All 14 NIP-17 tests pass.","labels":["nip-17","settings"]}
{"id":"nostrc-14","title":"Implement DM file attachments (kind 15)","description":"Support sending encrypted files in direct messages.\n\n## Technical Requirements\n\n### Kind 15 Event Structure\n```json\n{\n  \"kind\": 15,\n  \"content\": \"\u003cencrypted-file-url\u003e\",\n  \"tags\": [\n    [\"p\", \"\u003creceiver-pubkey\u003e\"],\n    [\"file-type\", \"image/jpeg\"],\n    [\"encryption-algorithm\", \"aes-gcm\"],\n    [\"decryption-key\", \"\u003cbase64-key\u003e\"],\n    [\"decryption-nonce\", \"\u003cbase64-nonce\u003e\"],\n    [\"x\", \"\u003csha256-of-encrypted-file\u003e\"],\n    [\"ox\", \"\u003csha256-of-original-file\u003e\"],\n    [\"size\", \"\u003cbytes\u003e\"],\n    [\"dim\", \"\u003cwidth\u003ex\u003cheight\u003e\"],\n    [\"blurhash\", \"\u003cblurhash-string\u003e\"],\n    [\"thumb\", \"\u003cencrypted-thumbnail-url\u003e\"]\n  ]\n}\n```\n\n### File Upload Flow\n1. User selects file to attach\n2. Generate random AES-GCM key and nonce\n3. Encrypt file with AES-GCM\n4. Calculate SHA256 of original and encrypted\n5. Generate blurhash for images\n6. Create encrypted thumbnail for images\n7. Upload encrypted file(s) to hosting service\n8. Create kind 15 event with metadata tags\n9. Gift wrap and send like kind 14\n\n### File Download Flow\n1. Decrypt gift wrap to get kind 15\n2. Download encrypted file from URL\n3. Verify SHA256 hash matches x tag\n4. Decrypt with key/nonce from tags\n5. Verify original hash matches ox tag\n6. Display/save decrypted file\n\n## UI Integration\n- Attachment button in DM compose area\n- File picker dialog\n- Upload progress indicator\n- Image preview in message thread\n- Download button for files\n\n## Files to Create\n- apps/gnostr/src/nostr/dm_files.c\n- apps/gnostr/src/nostr/dm_files.h\n- Integrate with DM thread view","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/bruce","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T04:01:42.491819-08:00","closed_at":"2026-02-08T04:01:42.491819-08:00","close_reason":"Closed","labels":["encryption","files","nip-17"]}
{"id":"nostrc-15","title":"NIP-51: User Lists Management","description":"Implement user list management following NIP-51 for follows, mutes, bookmarks, and other lists.\n\n## Overview\nNIP-51 defines standardized lists that users can maintain:\n- Follow list (who you follow)\n- Mute list (who/what you've muted)\n- Bookmarks (saved notes)\n- Pinned notes\n- And more specialized lists\n\n## Key Features\n1. Follow list (kind 3) - who you follow\n2. Mute list (kind 10000) - users/words to hide\n3. Bookmarks (kind 10003) - saved notes\n4. Custom sets with d-tag identifiers\n5. Public vs private list entries (NIP-44 encryption)\n\n## List Types to Implement\n### Standard Lists (one per user)\n- kind 3: Follow list\n- kind 10000: Mute list  \n- kind 10001: Pinned notes\n- kind 10002: Relay list (read/write)\n- kind 10003: Bookmarks\n\n### Sets (multiple per user, with d-tag)\n- kind 30000: Follow sets (custom groups)\n- kind 30003: Bookmark sets","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T14:30:39.410491-08:00","closed_at":"2026-01-19T14:30:39.410491-08:00","close_reason":"Implemented NIP-51 user lists library with mute lists (kind 10000), bookmarks (kind 10003), addressable lists (kind 30000+), and NIP-44 private entry encryption. All 13 tests pass.","labels":["lists","nip-51"]}
{"id":"nostrc-16","title":"Implement follow list management (kind 3)","description":"Manage the user's follow list with follow/unfollow functionality.\n\n## Technical Requirements\n\n### Kind 3 Event Structure\n```json\n{\n  \"kind\": 3,\n  \"content\": \"\",\n  \"tags\": [\n    [\"p\", \"\u003cpubkey\u003e\", \"\u003crelay-hint\u003e\", \"\u003cpetname\u003e\"],\n    [\"p\", \"\u003cpubkey2\u003e\", \"\u003crelay-hint\u003e\", \"\u003cpetname\u003e\"]\n  ]\n}\n```\n\n### Features\n1. **Follow a user**\n   - Add p-tag with pubkey\n   - Optional relay hint for better discovery\n   - Optional petname (local nickname)\n   - Publish updated kind 3 event\n\n2. **Unfollow a user**\n   - Remove p-tag for pubkey\n   - Publish updated kind 3 event\n\n3. **Load following list**\n   - Fetch user's kind 3 on startup\n   - Populate local following set\n   - Use for timeline filtering\n\n4. **Following indicator**\n   - Show \"Following\" badge on profiles\n   - Follow/Unfollow button state\n\n### UI Integration\n- Follow button on profile pane\n- Following list in settings/profile\n- Following count display\n- Search within following\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-profile-pane.c (button)\n- Create: apps/gnostr/src/nostr/follow_list.c\n- Create: apps/gnostr/src/nostr/follow_list.h\n\n## Considerations\n- Kind 3 is replaceable (only latest matters)\n- Must preserve existing follows when updating\n- Handle concurrent updates gracefully","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:17:07.852107-08:00","closed_at":"2026-01-19T13:17:07.852107-08:00","close_reason":"Already implemented in libnostr","labels":["nip-51","social"]}
{"id":"nostrc-17","title":"Implement mute list management (kind 10000)","description":"Manage muted users and words with kind 10000 events.\n\n## Technical Requirements\n\n### Kind 10000 Event Structure\n```json\n{\n  \"kind\": 10000,\n  \"content\": \"\u003cnip44-encrypted-private-mutes\u003e\",\n  \"tags\": [\n    [\"p\", \"\u003cpubkey\u003e\"],\n    [\"t\", \"\u003chashtag\u003e\"],\n    [\"word\", \"\u003clowercase-word\u003e\"],\n    [\"e\", \"\u003cevent-id\u003e\"]\n  ]\n}\n```\n\n### Mute Types\n1. **User mute** (p-tag): Hide all content from user\n2. **Hashtag mute** (t-tag): Hide posts with hashtag\n3. **Word mute** (word-tag): Hide posts containing word\n4. **Event mute** (e-tag): Hide specific post/thread\n\n### Public vs Private Mutes\n- Public: in tags array (visible to relays/others)\n- Private: encrypted in content field using NIP-44\n- Private mutes useful for hiding your preferences\n\n### Features\n1. Mute user from profile/note\n2. Mute word/hashtag from settings\n3. Mute specific thread\n4. Unmute from mute list\n5. Filter timeline using mute list\n\n### UI Integration\n- \"Mute\" option in note/profile menu\n- Mute list management in settings\n- Toggle public/private per mute\n- Visual indicator for muted content (optional show)\n\n## Files to Create\n- apps/gnostr/src/nostr/mute_list.c\n- apps/gnostr/src/nostr/mute_list.h\n- Add to settings dialog\n\n## Integration\n- Filter timeline events against mute list\n- Filter notifications against mute list\n- Cache mute list locally for performance","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T14:30:39.411757-08:00","closed_at":"2026-01-19T14:30:39.411757-08:00","close_reason":"Implemented NIP-51 user lists library with mute lists (kind 10000), bookmarks (kind 10003), addressable lists (kind 30000+), and NIP-44 private entry encryption. All 13 tests pass.","labels":["moderation","nip-51"]}
{"id":"nostrc-18","title":"Implement bookmarks (kind 10003)","description":"Allow users to bookmark notes for later reference.\n\n## Technical Requirements\n\n### Kind 10003 Event Structure\n```json\n{\n  \"kind\": 10003,\n  \"content\": \"\u003cnip44-encrypted-private-bookmarks\u003e\",\n  \"tags\": [\n    [\"e\", \"\u003cevent-id\u003e\", \"\u003crelay-hint\u003e\"],\n    [\"a\", \"\u003ckind:pubkey:d-tag\u003e\", \"\u003crelay-hint\u003e\"],\n    [\"t\", \"\u003chashtag\u003e\"],\n    [\"r\", \"\u003curl\u003e\"]  \n  ]\n}\n```\n\n### Bookmark Types\n1. **Note bookmark** (e-tag): Save a specific note\n2. **Article bookmark** (a-tag): Save long-form content\n3. **Hashtag bookmark** (t-tag): Track hashtag\n4. **URL bookmark** (r-tag): Save external link\n\n### Public vs Private\n- Public bookmarks in tags\n- Private bookmarks encrypted in content\n\n### Features\n1. Bookmark button on notes\n2. Bookmark from note menu\n3. View all bookmarks list\n4. Remove bookmark\n5. Toggle public/private\n\n### UI Integration\n- Bookmark icon on note cards (filled when bookmarked)\n- Bookmarks view/tab in app\n- Organize by type (notes, articles, links)\n- Search within bookmarks\n\n## Files to Create\n- apps/gnostr/src/nostr/bookmarks.c\n- apps/gnostr/src/nostr/bookmarks.h\n- apps/gnostr/src/ui/gnostr-bookmarks-view.c\n\n## Files to Modify\n- apps/gnostr/src/ui/note_card_row.c (bookmark button)\n- apps/gnostr/src/ui/gnostr-main-window.c (bookmarks tab)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T14:30:39.412497-08:00","closed_at":"2026-01-19T14:30:39.412497-08:00","close_reason":"Implemented NIP-51 user lists library with mute lists (kind 10000), bookmarks (kind 10003), addressable lists (kind 30000+), and NIP-44 private entry encryption. All 13 tests pass.","labels":["bookmarks","nip-51"]}
{"id":"nostrc-19","title":"Implement private list entry encryption","description":"Add NIP-44 encryption for private list entries in NIP-51 lists.\n\n## Technical Requirements\n\n### Private Entry Format\nPrivate entries stored in event content as encrypted JSON:\n```json\n[\n  [\"p\", \"\u003cpubkey\u003e\"],\n  [\"e\", \"\u003cevent-id\u003e\"],\n  [\"word\", \"secret\"]\n]\n```\n\n### Encryption\n- Use NIP-44 with author's own pubkey\n- Shared key: ECDH(author_privkey, author_pubkey)\n- Only the author can decrypt\n\n### Backward Compatibility\n- Detect NIP-04 encrypted content (look for \"iv\" marker)\n- Support reading NIP-04 encrypted private lists\n- Always write new content with NIP-44\n\n### Implementation\n```c\n// Encrypt private entries\nchar* encrypt_private_list_entries(GPtrArray *entries,\n                                   const uint8_t *privkey);\n\n// Decrypt private entries  \nGPtrArray* decrypt_private_list_entries(const char *content,\n                                        const uint8_t *privkey);\n```\n\n### Integration\n- All NIP-51 list types should support private entries\n- Merge public (tags) and private (content) when reading\n- Split by public/private flag when writing\n\n## Files to Modify\n- Extend NIP-44 implementation\n- All list management modules\n\n## Security\n- Never expose private entries to relays\n- Clear decrypted entries from memory when done","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T14:30:39.413078-08:00","closed_at":"2026-01-19T14:30:39.413078-08:00","close_reason":"Implemented NIP-51 user lists library with mute lists (kind 10000), bookmarks (kind 10003), addressable lists (kind 30000+), and NIP-44 private entry encryption. All 13 tests pass.","labels":["encryption","nip-51","security"]}
{"id":"nostrc-19o","title":"Package: macOS tarball","description":"## Goal\n\nCreate macOS tarball for manual installation.\n\n## Tasks\n\n1. Create tarball structure\n   ```\n   gnostr-x.y.z-macos-arm64/\n   ‚îú‚îÄ‚îÄ Gnostr.app/\n   ‚îî‚îÄ‚îÄ README.txt\n   ```\n\n2. CI workflow\n   - Build for both architectures (Intel + Apple Silicon)\n   - Create universal binary or separate builds\n   - Create .tar.gz\n   - Upload as release artifact\n\n## Notes\n- Alternative to DMG for users who prefer it\n- No signing required (user accepts Gatekeeper warning)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T11:00:06.846277-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:01.38949-08:00","closed_at":"2026-01-30T12:22:01.38949-08:00","close_reason":"CI job added: build-macos-tarball creates tarball with gnostr, gnostr-signer, daemon","labels":["deployment","macos"],"dependencies":[{"issue_id":"nostrc-19o","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.465664-08:00","created_by":"mayor"}]}
{"id":"nostrc-1du","title":"Play YouTube videos inline from OG card click","description":"When a note contains a YouTube link, the app currently shows an OG preview card. Clicking the card should play the linked video inline.\n\nImplementation:\n- Detect YouTube URLs in note content (youtube.com/watch, youtu.be, etc)\n- Show OG card with thumbnail as default (existing behavior)\n- On card click: expand card to embedded video player\n- Use GtkVideo or WebKitWebView to play the video (prefer lightweight approach)\n- Extract video ID from URL, use youtube-nocookie.com/embed/ for privacy\n- Play/pause controls, fullscreen toggle\n- Clicking again or scrolling away could collapse back to OG card\n\nConsider: libsoup for fetching oEmbed data, or direct embed URL construction from video ID.","status":"closed","priority":2,"issue_type":"feature","assignee":"nostrc/barry","created_at":"2026-02-08T03:29:51.364617-08:00","created_by":"mayor","updated_at":"2026-02-08T13:55:31.192529-08:00","closed_at":"2026-02-08T13:55:31.192529-08:00","close_reason":"YouTube video playback done by barry, pushed a7607b8"}
{"id":"nostrc-1dy","title":"Package: Arch Linux (AUR)","description":"## Goal\n\nCreate PKGBUILD and submit to Arch User Repository (AUR).\n\n## Tasks\n\n1. Create PKGBUILD\n   - gnostr (release version)\n   - gnostr-git (latest git)\n   - Proper dependencies (gtk4, libadwaita, gstreamer, etc.)\n\n2. Submit to AUR\n   - Create AUR account\n   - Upload PKGBUILD\n   - Maintain updates\n\n3. CI workflow\n   - Test PKGBUILD builds in Arch container\n   - Validate with namcap\n\n## Notes\n- AUR packages are user-maintained\n- Consider official repo submission once stable","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:45.194674-08:00","created_by":"mayor","updated_at":"2026-01-30T12:24:25.330254-08:00","closed_at":"2026-01-30T12:24:25.330254-08:00","close_reason":"PKGBUILD created for AUR with split packages (gnostr, gnostr-signer), systemd integration","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-1dy","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.132669-08:00","created_by":"mayor"}]}
{"id":"nostrc-1wx","title":"Videos don't reliably load or play on timeline","description":"## Problem\n\nVideos in the timeline don't reliably load or play. Playback is inconsistent.\n\n## Expected Behavior\n\n- Videos should load and display thumbnail/preview\n- Clicking should start playback reliably\n- Video controls should work\n\n## Notes\n\nMay be related to the video player widget implementation in gnostr-video-player.c.\nAlso note: clangd reports unused include of gnostr-main-window.h in that file.","status":"closed","priority":2,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-30T01:59:55.163139-08:00","created_by":"mayor","updated_at":"2026-01-30T12:13:40.94614-08:00","closed_at":"2026-01-30T12:13:40.94614-08:00","close_reason":"Added 15-second loading timeout to prevent infinite spinner. Videos that fail to prepare now show error state."}
{"id":"nostrc-1zqm","title":"ASAN: heap-use-after-free in nostr_subscription_fire during relay reconnect","description":"AddressSanitizer caught a heap-use-after-free in nostr_subscription_fire (subscription.c:590). Thread T26 (relay message_loop) calls relay_refire_subscriptions during reconnect, which iterates the subscription hash map and fires each subscription. But the subscription data was already freed by thread T0 (main GLib loop) via libsoup cleanup in g_main_context_iteration. Call chain: message_loop -\u003e relay_attempt_reconnect -\u003e relay_refire_subscriptions -\u003e go_hash_map_for_each -\u003e refire_subscription_cb -\u003e nostr_subscription_fire (READ of freed memory). The subscription hash map has no synchronization between the relay thread removing/refiring subscriptions and the main thread freeing them. Fix: either add refcounting to subscription objects so the relay thread holds a ref during iteration, or add mutex protection around the subscription hash map access, or copy the subscription list before iterating in refire.","status":"in_progress","priority":1,"issue_type":"bug","assignee":"nostrc/boris","created_at":"2026-02-08T15:32:20.711449-08:00","created_by":"mayor","updated_at":"2026-02-08T15:32:29.476975-08:00"}
{"id":"nostrc-2","title":"[DONE] NIP-01 event serialization - already in libnostr","description":"## Status: COMPLETE - No implementation needed\n\nlibnostr already provides full NIP-01 event serialization.\n\n### Available APIs\n\n**Canonical NIP-01 Array** (for hashing/signing):\n```c\nchar *nostr_event_serialize_nip01_array(const NostrEvent *event);\n// Returns: [0, pubkey, created_at, kind, tags, content]\n```\n\n**Compact JSON** (for publishing):\n```c\nchar *nostr_event_serialize_compact(const NostrEvent *event);\n// Returns: {\"id\":..., \"pubkey\":..., \"created_at\":..., ...}\n```\n\n### Location\n- File: libnostr/src/event.c (lines 27-66, 779-840)\n- Header: libnostr/include/nostr-event.h\n\n### Character Escaping\nAlready handles all NIP-01 escaping rules:\n- Line breaks, quotes, backslashes, tabs, etc.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-17T00:00:00Z","closed_at":"2026-01-17T00:00:01Z","labels":["core","libnostr","nip-01"]}
{"id":"nostrc-20","title":"NIP-11: Relay Information","description":"Implement relay information document fetching and display per NIP-11.\n\n## Overview\nNIP-11 allows clients to discover relay capabilities and policies by fetching a JSON document via HTTP.\n\n## Key Features\n1. Fetch relay info on connection\n2. Display relay metadata (name, description, icon)\n3. Respect relay limitations\n4. Show supported NIPs\n5. Display policies (ToS, privacy)\n6. Handle payment requirements\n\n## Implementation Areas\n- HTTP fetch with Accept: application/nostr+json\n- Parse and cache relay information\n- UI for relay details\n- Constraint enforcement (max message length, etc.)\n- Relay selection based on capabilities","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/boris","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T02:19:27.987565-08:00","closed_at":"2026-02-08T02:19:27.987565-08:00","close_reason":"Closed","labels":["nip-11","relays"]}
{"id":"nostrc-201","title":"SEGV in gnutls during libsoup connection cleanup","description":"**Crash**: NULL pointer dereference in gnutls_subject_alt_names_deinit during TLS connection teardown.\n\n**Stack trace**:\n```\ngnutls_subject_alt_names_deinit (0x8 = NULL+offset)\n‚Üê gnutls_x509_crt_deinit\n‚Üê libgiognutls g_object_unref\n‚Üê libsoup-3.0 (multiple unref chain)\n‚Üê g_main_context_iteration\n‚Üê g_application_run\n‚Üê main\n```\n\n**Analysis**:\n- Crash at address 0x8 (offset from NULL) suggests freed/uninitialized certificate data\n- Happens during main loop iteration, likely connection pool cleanup\n- Chain of g_object_unref suggests dispose cascade\n- Could be: double-unref of SoupSession, race in connection disposal, or upstream gnutls/libsoup bug\n\n**Likely locations to investigate**:\n1. Any SoupSession usage - check ref counting\n2. Profile fetcher / relay connections using libsoup\n3. OG preview fetcher (uses soup for HTTP)\n4. Check if SoupSession is being shared improperly across threads\n\n**Environment**: Linux x86_64, libsoup-3.0, libgnutls.so.30","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-30T12:34:24.902675-08:00","created_by":"mayor","updated_at":"2026-01-31T13:59:35.089533-08:00","closed_at":"2026-01-31T13:59:35.089533-08:00","close_reason":"Fixed by billy: 3f8422f - shared SoupSession"}
{"id":"nostrc-21","title":"Implement relay info document fetching","description":"Fetch NIP-11 relay information documents via HTTP.\n\n## Technical Requirements\n\n### HTTP Request\n- Method: GET (or HEAD)\n- URL: Same as WebSocket URL (wss://relay.example.com ‚Üí https://relay.example.com)\n- Header: `Accept: application/nostr+json`\n- Handle CORS (relays must send Access-Control-* headers)\n\n### Response Parsing\n```json\n{\n  \"name\": \"Relay Name\",\n  \"description\": \"Description text\",\n  \"pubkey\": \"\u003cadmin-pubkey\u003e\",\n  \"contact\": \"admin@example.com\",\n  \"supported_nips\": [1, 11, 17, 42],\n  \"software\": \"https://github.com/...\",\n  \"version\": \"1.0.0\",\n  \"icon\": \"https://relay.example.com/icon.png\",\n  \"banner\": \"https://relay.example.com/banner.jpg\",\n  \"limitation\": {\n    \"max_message_length\": 16384,\n    \"max_subscriptions\": 20,\n    \"auth_required\": false,\n    \"payment_required\": false\n  }\n}\n```\n\n### Caching\n- Cache relay info with 1-hour TTL\n- Store in local database or memory\n- Refresh on reconnection\n\n### Error Handling\n- Timeout after reasonable period (5s)\n- Handle missing/malformed responses\n- Ignore unknown fields (forward compatibility)\n- Relay works without NIP-11 (optional)\n\n## Files to Create\n- apps/gnostr/src/nostr/relay_info.c\n- apps/gnostr/src/nostr/relay_info.h\n\n## Integration\n- Fetch after WebSocket connected\n- Update relay manager UI with info\n- Log warnings for required auth/payment","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:17:07.852658-08:00","closed_at":"2026-01-19T13:17:07.852658-08:00","close_reason":"Already implemented in libnostr","labels":["networking","nip-11"]}
{"id":"nostrc-22","title":"Display relay information in relay manager","description":"Show NIP-11 relay metadata in the relay manager dialog.\n\n## UI Requirements\n\n### Relay List Enhancement\nFor each relay in the list:\n- Name (from NIP-11) or URL fallback\n- Icon/favicon if available\n- Connection status indicator\n- Supported NIPs badges\n\n### Relay Detail View\nWhen relay selected:\n- Banner image\n- Name and description\n- Admin contact (pubkey link, email)\n- Software version\n- Supported NIPs list\n- Limitations summary\n- Links to ToS/Privacy Policy\n\n### Limitation Display\n- Max message size\n- Max subscriptions\n- Auth required indicator\n- Payment required indicator\n- Write restrictions\n\n### Warnings\n- Show warning if auth_required and not authenticated\n- Show warning if payment_required\n- Show warning if restricted_writes\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-relay-manager.c\n- apps/gnostr/data/ui/dialogs/gnostr-relay-manager.ui\n\n## Design\n- Expandable relay rows\n- Use GTK4 ListBox with custom row template\n- Lazy load relay info on expand","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/boris","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T14:37:29.0887-08:00","closed_at":"2026-02-08T14:37:29.0887-08:00","close_reason":"Already implemented in prior session","labels":["nip-11","ui"]}
{"id":"nostrc-23","title":"Enforce relay limitations from NIP-11","description":"Respect relay constraints from NIP-11 limitation field.\n\n## Technical Requirements\n\n### Limitations to Enforce\n\n1. **max_message_length**\n   - Check outgoing message size before send\n   - Split large subscription requests if needed\n   - Warn user if event too large\n\n2. **max_subscriptions**\n   - Track active subscriptions per relay\n   - Queue subscriptions if at limit\n   - Close old subscriptions when needed\n\n3. **max_subid_length**\n   - Generate subscription IDs within limit\n   - Default to 64 chars if not specified\n\n4. **max_limit**\n   - Clamp filter limit to relay max\n   - Paginate if more results needed\n\n5. **max_event_tags / max_content_length**\n   - Validate before publishing\n   - Show error if event exceeds limits\n\n6. **created_at_lower/upper_limit**\n   - Validate event timestamps\n   - Warn if event outside accepted range\n\n7. **min_pow_difficulty**\n   - Calculate PoW if required (NIP-13)\n   - Skip relay if PoW too expensive\n\n8. **auth_required**\n   - Trigger NIP-42 auth flow\n   - Queue requests until authenticated\n\n9. **payment_required**\n   - Display payment info\n   - Mark relay as unavailable until paid\n\n## Files to Modify\n- apps/gnostr/src/nostr/relay_info.c (validation functions)\n- SimplePool relay connection code\n- Event publishing logic\n\n## Graceful Degradation\n- Work without NIP-11 info (use defaults)\n- Log when hitting limitations","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/brett","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T03:35:03.746704-08:00","closed_at":"2026-02-08T03:35:03.746704-08:00","close_reason":"Closed","labels":["nip-11","validation"]}
{"id":"nostrc-24","title":"Add repost/quote functionality","description":"Implement reposting and quote-posting of notes.\n\n## Technical Requirements\n\n### Simple Repost (Kind 6)\n```json\n{\n  \"kind\": 6,\n  \"content\": \"\",\n  \"tags\": [\n    [\"e\", \"\u003creposted-event-id\u003e\", \"\u003crelay-hint\u003e\"],\n    [\"p\", \"\u003coriginal-author-pubkey\u003e\"]\n  ]\n}\n```\n\n### Quote Post (Kind 1 with q-tag)\n```json\n{\n  \"kind\": 1,\n  \"content\": \"My comment about this note\\n\\nnostr:\u003cnote-id\u003e\",\n  \"tags\": [\n    [\"q\", \"\u003cquoted-event-id\u003e\", \"\u003crelay-hint\u003e\"],\n    [\"p\", \"\u003cquoted-author-pubkey\u003e\"]\n  ]\n}\n```\n\n### UI Features\n1. Repost button on note cards\n2. Repost confirmation dialog\n3. Quote option (opens composer with quote)\n4. Repost count display\n5. \"Reposted by X\" attribution in timeline\n\n### Timeline Integration\n- Fetch and display reposted content\n- Show original note embedded in repost\n- Link to original author profile\n\n## Files to Modify\n- apps/gnostr/src/ui/note_card_row.c (buttons)\n- apps/gnostr/src/ui/gnostr-composer.c (quote mode)\n- apps/gnostr/src/ui/gnostr-timeline-view.c (repost display)\n\n## Considerations\n- Don't double-fetch if original in cache\n- Handle deleted original gracefully\n- Repost count may need relay aggregation","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/brett","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T02:55:31.474483-08:00","closed_at":"2026-02-08T02:55:31.474483-08:00","close_reason":"Closed","labels":["nip-01","social"]}
{"id":"nostrc-25","title":"Add like/reaction functionality","description":"Implement reactions to notes (likes, emoji reactions).\n\n## Technical Requirements\n\n### Reaction Event (Kind 7)\n```json\n{\n  \"kind\": 7,\n  \"content\": \"+\",  // or emoji like \"üî•\" or \"‚ù§Ô∏è\"\n  \"tags\": [\n    [\"e\", \"\u003creacted-event-id\u003e\", \"\u003crelay-hint\u003e\"],\n    [\"p\", \"\u003creacted-event-author\u003e\"],\n    [\"k\", \"\u003creacted-event-kind\u003e\"]\n  ]\n}\n```\n\n### Content Values\n- `+` = like\n- `-` = dislike (optional display)\n- Any emoji = custom reaction\n\n### UI Features\n1. Like button (heart icon) on note cards\n2. Like count display\n3. Emoji picker for custom reactions (optional)\n4. Your reaction indicator (filled heart)\n5. List of who liked (on click)\n\n### Timeline Integration\n- Query reactions for displayed notes\n- Aggregate reaction counts\n- Cache reaction state locally\n- Update counts in real-time\n\n## Files to Modify\n- apps/gnostr/src/ui/note_card_row.c (like button)\n- apps/gnostr/src/model/gn-nostr-event-item.c (reaction count)\n- May need reaction aggregation service\n\n## Performance\n- Batch fetch reactions for visible notes\n- Don't fetch reactions for every note upfront\n- Use count queries if relays support (NIP-45)","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T02:26:34.71879-08:00","closed_at":"2026-02-08T02:26:34.71879-08:00","close_reason":"Closed","labels":["nip-25","social"]}
{"id":"nostrc-26","title":"Add note deletion functionality","description":"Implement event deletion requests per NIP-09.\n\n## Technical Requirements\n\n### Deletion Event (Kind 5)\n```json\n{\n  \"kind\": 5,\n  \"content\": \"\u003creason for deletion\u003e\",\n  \"tags\": [\n    [\"e\", \"\u003cevent-id-to-delete\u003e\"],\n    [\"e\", \"\u003canother-event-id\u003e\"],\n    [\"k\", \"\u003ckind-of-deleted-events\u003e\"]\n  ]\n}\n```\n\n### Rules\n- Can only delete your own events (same pubkey)\n- Relays SHOULD delete events matching the e-tags\n- Relays SHOULD stop serving deleted events\n- Clients SHOULD hide deleted events\n- Deletion is a request, not guaranteed\n\n### UI Features\n1. Delete option in note menu (only for own notes)\n2. Confirmation dialog with reason input\n3. Remove from local display immediately\n4. Show \"deleted\" placeholder optionally\n\n### Local Handling\n- Track deleted event IDs locally\n- Filter out deleted events from timeline\n- Clean up from local database\n\n## Files to Modify\n- apps/gnostr/src/ui/note_card_row.c (delete menu item)\n- Create: apps/gnostr/src/nostr/deletion.c\n- apps/gnostr/src/ui/gnostr-timeline-view.c (filtering)\n\n## Edge Cases\n- Deleting replies (doesn't delete parent/children)\n- Deleting reposts\n- Handling deletion of already-propagated events","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T02:57:45.310165-08:00","closed_at":"2026-02-08T02:57:45.310165-08:00","close_reason":"Closed","labels":["moderation","nip-09"]}
{"id":"nostrc-27","title":"Implement notifications view","description":"Create a notifications view showing mentions, replies, reposts, and reactions.\n\n## Technical Requirements\n\n### Notification Types\n1. **Mentions** - Notes with your pubkey in p-tag\n2. **Replies** - Notes replying to your notes\n3. **Reposts** - Kind 6 events reposting your notes\n4. **Reactions** - Kind 7 events reacting to your notes\n5. **Follows** - New followers (optional, detect via kind 3)\n\n### Query Strategy\n```json\n{\n  \"kinds\": [1, 6, 7],\n  \"#p\": [\"\u003cyour-pubkey\u003e\"],\n  \"since\": \u003clast-checked\u003e,\n  \"limit\": 50\n}\n```\n\n### UI Layout\n1. Notification tab in main window\n2. Chronological list of notifications\n3. Grouped by type or unified stream\n4. Unread indicator/badge\n5. Mark as read functionality\n\n### Notification Row\n- Avatar of actor\n- Action description (\"X liked your note\")\n- Preview of relevant content\n- Timestamp\n- Click to navigate to note/profile\n\n## Files to Create\n- apps/gnostr/src/ui/gnostr-notifications-view.c\n- apps/gnostr/src/ui/gnostr-notifications-view.h\n- apps/gnostr/data/ui/widgets/gnostr-notifications-view.ui\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-main-window.c (add tab)\n\n## State Management\n- Track last seen notification timestamp\n- Persist read state across sessions\n- Badge count in header","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/barry","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T03:24:57.071685-08:00","closed_at":"2026-02-08T03:24:57.071685-08:00","close_reason":"Closed","labels":["notifications","ui"]}
{"id":"nostrc-28","title":"Implement user search","description":"Add ability to search for users by name, NIP-05, or pubkey.\n\n## Technical Requirements\n\n### Search Methods\n1. **By pubkey/npub** - Direct lookup\n2. **By NIP-05** - Domain verification lookup\n3. **By name** - Search kind 0 metadata\n\n### NIP-05 Resolution\n```\n1. Parse identifier: name@domain.com\n2. Fetch: https://domain.com/.well-known/nostr.json?name=name\n3. Response: {\"names\": {\"name\": \"\u003cpubkey\u003e\"}}\n4. Optionally get relay hints from \"relays\" field\n```\n\n### Kind 0 Search\n- Query relays for kind 0 with text search\n- Some relays support content search\n- Fall back to local cache search\n\n### UI Features\n1. Search bar in header or dedicated search view\n2. Search results list with profiles\n3. Recent searches\n4. Search suggestions from cache\n\n### Search Result Display\n- Avatar\n- Display name\n- Username/NIP-05\n- Bio preview\n- Follow button\n\n## Files to Create\n- apps/gnostr/src/ui/gnostr-search-view.c\n- apps/gnostr/src/nostr/nip05.c (NIP-05 resolution)\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-main-window.c\n\n## Performance\n- Debounce search input\n- Cancel pending searches on new input\n- Cache NIP-05 resolutions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:17:07.853149-08:00","closed_at":"2026-01-19T13:17:07.853149-08:00","close_reason":"Already implemented in libnostr","labels":["nip-05","search","ui"]}
{"id":"nostrc-29","title":"Implement note search","description":"Add ability to search notes by content.\n\n## Technical Requirements\n\n### Search Approaches\n1. **Local search** - Search NostrdB cache\n2. **Relay search** - Query relays with search filter\n\n### NostrdB Local Search\n- Already has text search capabilities\n- Search kind 1 content field\n- Fast, works offline\n\n### Relay Search (if supported)\n```json\n{\n  \"kinds\": [1],\n  \"search\": \"\u003csearch-query\u003e\",\n  \"limit\": 30\n}\n```\nNote: Not all relays support search filter\n\n### UI Features\n1. Search input field\n2. Toggle: local vs global search\n3. Results as note cards\n4. Filter by:\n   - Date range\n   - Author (from following only)\n   - Contains media\n\n### Search Results\n- Display as timeline view\n- Highlight matching text\n- Show result count\n- Pagination/load more\n\n## Files to Create\n- apps/gnostr/src/ui/gnostr-search-results-view.c\n\n## Files to Modify\n- apps/gnostr/src/storage_ndb.c (may need search function)\n- apps/gnostr/src/ui/gnostr-main-window.c\n\n## Considerations\n- Relay search may have rate limits\n- Local search preferred for privacy\n- Combine results from multiple sources","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/barry","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T13:02:51.275826-08:00","closed_at":"2026-02-08T13:02:51.275826-08:00","close_reason":"Closed","labels":["search","ui"]}
{"id":"nostrc-2n7","title":"timeline load_older emits incorrect items_changed signal after sorting","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-01-29T09:42:29.697399-08:00","created_by":"flotilla_budabit/crew/gus","updated_at":"2026-02-08T04:11:47.32074-08:00","closed_at":"2026-02-08T04:11:47.32074-08:00","close_reason":"Closed"}
{"id":"nostrc-3","title":"[DONE] Event ID calculation - already in libnostr","description":"## Status: COMPLETE - No implementation needed\n\nlibnostr already provides SHA256 event ID calculation.\n\n### Available API\n```c\nchar *nostr_event_get_id(const NostrEvent *event);\n// Returns: 64-char hex SHA256 hash of NIP-01 canonical array\n```\n\n### Implementation\n- Uses OpenSSL SHA256\n- Serializes to NIP-01 array format first\n- Returns lowercase hex string\n\n### Location\n- File: libnostr/src/event.c (lines 495-512)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-17T00:00:00Z","closed_at":"2026-01-17T00:00:01Z","labels":["crypto","libnostr","nip-01"]}
{"id":"nostrc-30","title":"Add image/media upload for notes","description":"Enable attaching images and media to notes.\n\n## Technical Requirements\n\n### Image Attachment Flow\n1. User selects image(s) from file picker\n2. Optionally resize/compress\n3. Upload to media hosting service\n4. Insert URL into note content\n5. Optionally add imeta tag with metadata\n\n### Media Hosting Options\n- nostr.build\n- void.cat  \n- User-configured server\n- NIP-96 compliant servers\n\n### NIP-94 imeta Tag (Optional)\n```json\n[\"imeta\", \n  \"url https://example.com/image.jpg\",\n  \"m image/jpeg\",\n  \"dim 1920x1080\",\n  \"x \u003csha256\u003e\",\n  \"blurhash ...\"\n]\n```\n\n### UI Features\n1. Image button in composer\n2. File picker (images, videos, etc.)\n3. Upload progress indicator\n4. Image preview before posting\n5. Remove attachment button\n6. Drag-and-drop support\n\n### Image Display in Timeline\n- Parse URLs in content\n- Detect image extensions (.jpg, .png, .gif, etc.)\n- Display inline with proper sizing\n- Lightbox for full view\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-composer.c\n- Create: apps/gnostr/src/nostr/media_upload.c\n- apps/gnostr/src/ui/note_card_row.c (display)\n\n## Configuration\n- Media server URL in settings\n- Auth tokens if required\n- Image size limits","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T02:55:26.324604-08:00","closed_at":"2026-02-08T02:55:26.324604-08:00","close_reason":"Closed","labels":["media","ui"]}
{"id":"nostrc-34u","title":"Deep codebase audit: memory optimization and crash resistance","description":"## Objective\n\nComprehensive review of the entire nostrc codebase with focus on memory efficiency and crash resistance. Think like a seasoned C developer working with restricted resources.\n\n## Focus Areas\n\n### 1. Memory Optimization\n- **Large structure allocations**: Identify structs that could be smaller, use bitfields, or pack better\n- **Vector/array growth patterns**: Look for unbounded growth, missing capacity hints, realloc thrashing\n- **Small object proliferation**: Many small allocations vs arena/pool allocators\n- **String handling**: Unnecessary copies, missing string interning opportunities\n- **Cache efficiency**: Data layout for cache-friendly access patterns\n- **Temporary allocations**: Stack vs heap decisions, scope-based cleanup\n\n### 2. Crash Resistance (beyond timeline)\n- **Multi-threading hazards**: Race conditions, lock ordering, missing synchronization\n- **Null/invalid pointer handling**: Missing null checks, use-after-free patterns\n- **Error propagation**: Functions that can fail silently, missing error handling\n- **Resource cleanup**: Missing frees, double frees, cleanup in error paths\n- **GTK widget lifecycle**: Proper ref counting, signal disconnection, dispose patterns\n- **Buffer handling**: Overflow potential, bounds checking\n\n### 3. Specific Areas to Audit\n- Relay connection management\n- Event parsing and validation\n- Profile/metadata caching\n- Subscription handling\n- Any code using GLib data structures (GHashTable, GArray, GPtrArray, etc.)\n- Any code interfacing with nostrdb\n\n## Mindset\n\nThink like you have 64MB of RAM and every allocation matters:\n- Question every malloc/g_new\n- Look for opportunities to reuse buffers\n- Consider object pools for frequently allocated types\n- Prefer stack allocation where lifetime permits\n- Look for memory that outlives its usefulness\n\n## Deliverables\n\n- File beads for each issue found (with specific file:line references)\n- Categorize as: P0 (crash risk), P1 (memory leak/growth), P2 (inefficiency), P3 (style/minor)\n- Include concrete fix suggestions where possible\n- Summary of systemic patterns that need addressing","status":"closed","priority":1,"issue_type":"task","assignee":"billy","created_at":"2026-01-29T09:51:42.972669-08:00","created_by":"mayor","updated_at":"2026-01-29T10:31:02.609824-08:00","closed_at":"2026-01-29T10:31:02.609824-08:00","close_reason":"Closed"}
{"id":"nostrc-35i","title":"NIP-34 Phase 2: Repository Browser and Git Client UI","description":"Continue NIP-34 plugin implementation with full UI views.\n\n## Dependencies\n- Add libgit2 to project (pkg_check_modules for libgit2)\n- Link nip34-git plugin against libgit2\n\n## Remaining Work\n\n### Repository Event Parsing\n- Implement parse_repository_event() in nip34-git-plugin.c (currently stub)\n- Parse kind 30617 events into RepoInfo structs\n\n### Repository Browser View\n- Full UI for browsing published repositories\n- Show repo metadata, maintainers, clone URLs\n- Filter/search functionality\n- Activity feed (recent patches, issues)\n\n### Graphical Git Client View (requires libgit2)\n- Clone/open repositories with git_clone/git_repository_open\n- Commit history with DAG visualization (git_revwalk)\n- Branch visualization (git_branch_iterator)\n- Diff viewer for commits and patches (git_diff)\n- Stage/unstage changes (git_index)\n- Commit interface (git_commit_create)\n- Push/pull to Nostr relays\n\n## Reference\n- Phase 1 complete in apps/gnostr/plugins/nip34-git/\n- libgit2 docs: https://libgit2.org/docs/\n- Existing flotilla_budabit/packages/nostr-git-ui for UI patterns","status":"in_progress","priority":2,"issue_type":"feature","assignee":"nostrc/bruce","created_at":"2026-01-31T20:38:07.358385-08:00","created_by":"mayor","updated_at":"2026-02-08T04:01:58.958132-08:00"}
{"id":"nostrc-38wc","title":"Profile highlights tab spinner spins endlessly, never loads","description":"The highlights tab in the profile viewer never finishes loading - shows an infinite spinner. No content is ever displayed.","status":"in_progress","priority":2,"issue_type":"bug","assignee":"nostrc/brett","created_at":"2026-02-08T13:55:36.346737-08:00","created_by":"mayor","updated_at":"2026-02-08T13:56:34.055932-08:00"}
{"id":"nostrc-3bs","title":"Digest: mol-witness-patrol","description":"Patrol 2: No polecats, refinery running, deacon responsive","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T18:47:35.377002-08:00","updated_at":"2026-01-24T18:47:35.377002-08:00","closed_at":"2026-01-24T18:47:35.376958-08:00","close_reason":"Squashed from 10 wisps"}
{"id":"nostrc-3g8","title":"Iteration 1: Increase queue capacity and add adaptive sizing","description":"## Goal\n\nFirst iteration: simple capacity increase with adaptive growth.\n\n## Changes\n\n### 1. Increase default queue capacity\n```c\n// Current (assumed)\n#define EVENT_QUEUE_CAPACITY 256\n\n// New default\n#define EVENT_QUEUE_CAPACITY_DEFAULT 1024\n#define EVENT_QUEUE_CAPACITY_MAX 8192\n```\n\n### 2. Adaptive queue growth\n```c\n// When queue hits 80% capacity, double it (up to max)\nif (queue-\u003elen \u003e queue-\u003ecapacity * 0.8) {\n  guint new_cap = MIN(queue-\u003ecapacity * 2, EVENT_QUEUE_CAPACITY_MAX);\n  if (new_cap \u003e queue-\u003ecapacity) {\n    resize_queue(queue, new_cap);\n    g_debug(\"Queue resized: %u -\u003e %u\", queue-\u003ecapacity, new_cap);\n  }\n}\n```\n\n### 3. Shrink when idle\n```c\n// Every 30s, if queue \u003c 25% capacity for sustained period, shrink\nif (queue-\u003elen \u003c queue-\u003ecapacity * 0.25 \u0026\u0026 \n    time_since_last_resize \u003e 30) {\n  guint new_cap = MAX(queue-\u003ecapacity / 2, EVENT_QUEUE_CAPACITY_DEFAULT);\n  resize_queue(queue, new_cap);\n}\n```\n\n## Success Criteria\n\n- Drop rate \u003c 0.1% under normal load\n- Memory usage remains reasonable (\u003c 10MB for queues)\n- No regression in event processing latency\n\n## Depends On\n\n- nostrc-sjv (metrics) to measure improvement","notes":"Implemented adaptive queue capacity (Iteration 1):\n\n## Changes\n- Added queue capacity configuration constants (DEFAULT=4096, MIN=256, MAX=16384)\n- Added adaptive capacity state tracking (suggested_capacity, max_observed_peak)\n- nostr_subscription_suggest_capacity() returns optimal capacity for new subscriptions\n- nostr_subscription_report_peak_usage() updates adaptive state based on actual usage\n- Updated nostr_subscription_new() to use adaptive capacity suggestion\n- Added utilization monitoring in dispatch_event() with warnings at 90% capacity\n- Reports to adaptive system when utilization hits 80% grow threshold\n\n## Behavior\n- New subscriptions get capacity based on historical peak usage\n- When utilization \u003e= 80%, future subscriptions get double capacity (up to max)\n- Rate-limited warnings logged when queue approaches capacity\n- Metrics tracked: queue_capacity_increase, queue_near_capacity\n\n## Limitations\n- GoChannel has fixed capacity at creation - true runtime resizing not implemented\n- Shrink-when-idle not implemented (would require channel replacement)\n- These are tracked as future iteration work\n\nAll subscription tests pass.","status":"closed","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-01-30T11:28:19.75946-08:00","created_by":"mayor","updated_at":"2026-01-30T13:39:53.208663-08:00","closed_at":"2026-01-30T13:39:53.208663-08:00","close_reason":"Closed","labels":["performance"],"dependencies":[{"issue_id":"nostrc-3g8","depends_on_id":"nostrc-pvy","type":"parent-child","created_at":"2026-01-30T11:28:41.982561-08:00","created_by":"mayor"},{"issue_id":"nostrc-3g8","depends_on_id":"nostrc-sjv","type":"blocks","created_at":"2026-01-30T11:28:47.129581-08:00","created_by":"mayor"}]}
{"id":"nostrc-3nj","title":"Consolidate JSON parsing: eliminate 116 direct jansson/json-glib usages","description":"116 files bypass the NostrJsonInterface framework, using jansson or json-glib directly. This caused the 'only 3 tag elements' bug and creates maintenance nightmares.\n\n## The Problem\n- libnostr/include/json.h defines NostrJsonInterface with pluggable backends\n- libjson/src/json.c provides jansson backend\n- But 56 files use jansson directly, 60 use json-glib directly\n\n## Categories of Violations\n1. Core NIPs (nip47, nip52, nip53, nip5f) - should use framework\n2. UI layer - uses json-glib for convenience\n3. Model layer - mixed usage\n4. 30+ NIP utilities - roll their own\n\n## Approach\n- Extend NostrJsonInterface if needed for missing functionality\n- Migrate files in priority order (core libs first, then NIPs, then UI)\n- Add lint rule to prevent future direct usage\n\n## Success Criteria\n- Zero direct jansson.h includes outside libjson/\n- Zero direct json-glib includes outside designated bridge files\n- All JSON parsing goes through NostrJsonInterface\n\nSee: nostrc/docs/JSON_PARSER_AUDIT.md for full inventory","notes":"SESSION COMPLETE (2026-01-29):\n\nFILES MIGRATED THIS SESSION:\n1. apps/gnostr/src/util/nip05.c - json.h facade (nostr_json_get_string_at, nostr_json_get_string_array_at)\n2. apps/gnostr/src/util/bookmarks.c - NostrEvent API (nostr_event_deserialize, nostr_tag_*, nostr_event_serialize)\n\nMIGRATION PATTERNS DOCUMENTED:\n- Event parsing: NostrEvent API (deserialize + NostrTags iteration)\n- Event building: NostrEvent API (new + set_* + NostrTags + serialize)  \n- Simple JSON lookups: json.h facade (nostr_json_get_*)\n\nREMAINING SCOPE:\n- 30 files in apps/gnostr still use jansson\n- Most can follow the established patterns\n- Some edge cases (like parsing tag arrays directly) may need new facade helpers\n\nBUILD STATUS: All changes compile and link successfully.\n\nRECOMMENDATIONS:\n1. Break remaining files into smaller sub-tasks (5-10 files per task)\n2. Prioritize files with simpler patterns first\n3. Consider adding facade helpers for common patterns like tag array iteration","status":"closed","priority":1,"issue_type":"epic","assignee":"barry","created_at":"2026-01-29T21:15:16.172794-08:00","created_by":"mayor","updated_at":"2026-01-31T15:08:47.392443-08:00","closed_at":"2026-01-31T15:08:47.392443-08:00","close_reason":"Closed"}
{"id":"nostrc-3r8k","title":"New Notes toast spinner not working","description":"nostrc-3rh added a loading spinner to the New Notes toast but it doesn't work. The spinner either doesn't appear or doesn't animate. Investigate the toast widget in session-view or timeline-view and fix the spinner display.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T15:04:55.063863-08:00","created_by":"mayor","updated_at":"2026-02-08T17:28:24.726489-08:00","closed_at":"2026-02-08T17:28:24.726489-08:00","close_reason":"Closed"}
{"id":"nostrc-3rh","title":"Add loading spinner to New Notes toast","description":"Add a spinner/loading indicator to the New Notes toast notification that appears when new notes arrive in the timeline. Currently the toast shows a static message ‚Äî adding a spinner would give better visual feedback that content is being loaded/prepared.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-07T15:50:17.929377-08:00","created_by":"mayor","updated_at":"2026-02-08T01:28:12.113684-08:00","closed_at":"2026-02-08T01:28:12.113684-08:00","close_reason":"Closed"}
{"id":"nostrc-3sl","title":"Package: Linux tarball","description":"## Goal\n\nCreate portable tarball distribution for generic Linux.\n\n## Tasks\n\n1. Create tarball structure\n   ```\n   gnostr-x.y.z-linux-x86_64/\n   ‚îú‚îÄ‚îÄ bin/gnostr\n   ‚îú‚îÄ‚îÄ lib/  (bundled libs if needed)\n   ‚îú‚îÄ‚îÄ share/\n   ‚îÇ   ‚îú‚îÄ‚îÄ applications/gnostr.desktop\n   ‚îÇ   ‚îú‚îÄ‚îÄ icons/\n   ‚îÇ   ‚îî‚îÄ‚îÄ gnostr/\n   ‚îú‚îÄ‚îÄ install.sh\n   ‚îî‚îÄ‚îÄ README.txt\n   ```\n\n2. Install script\n   - Copy to /usr/local or ~/.local\n   - Install desktop file\n   - Install icons\n\n3. CI workflow\n   - Build release binary\n   - Create tarball\n   - Upload as release artifact\n\n## Notes\n- For users who prefer manual installation\n- Document system dependencies","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:52.522606-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:02.32426-08:00","closed_at":"2026-01-30T12:22:02.32426-08:00","close_reason":"CI job added: build-tarball-linux creates tarball with all binaries, desktop files, icons, systemd service","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-3sl","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.266729-08:00","created_by":"mayor"}]}
{"id":"nostrc-3u5","title":"Deprecated sprintf usage - replace with snprintf project-wide","description":"Compiler warning in test code:\n\n```\ntesting/src/mock_relay_server.c:813:17: warning: 'sprintf' is deprecated\nsprintf(envelope, \"[\\\"EVENT\\\",\\\"%s\\\",%s]\", sub_id, event_json);\n```\n\n**Fix:** Replace sprintf with snprintf:\n```c\nsnprintf(envelope, sizeof(envelope), \"[\\\"EVENT\\\",\\\"%s\\\",%s]\", sub_id, event_json);\n```\n\nLow priority - test code only, but should be fixed for clean builds.","status":"closed","priority":3,"issue_type":"bug","assignee":"barry","created_at":"2026-01-31T15:56:39.483202-08:00","created_by":"mayor","updated_at":"2026-01-31T16:25:22.423671-08:00","closed_at":"2026-01-31T16:25:22.423671-08:00","close_reason":"Replaced all sprintf with snprintf in 7 files"}
{"id":"nostrc-4","title":"[DONE] Schnorr signature generation - already in libnostr","description":"## Status: COMPLETE - No implementation needed\n\nlibnostr already provides Schnorr signature generation.\n\n### Available APIs\n\n**Regular signing**:\n```c\nint nostr_event_sign(NostrEvent *event, const char *private_key);\n// private_key: 64-char hex string\n// Returns: 0 on success\n// Sets: event-\u003eid, event-\u003epubkey, event-\u003esig\n```\n\n**Secure signing** (memory-protected):\n```c\nint nostr_event_sign_secure(NostrEvent *event, const nostr_secure_buf *sk);\n// Uses secure memory buffer, wipes after use\n```\n\n### Implementation\n- BIP-340 Schnorr signatures via libsecp256k1\n- Produces 64-byte signature (128-char hex)\n- Automatically sets pubkey if not already set\n\n### Location\n- File: libnostr/src/event.c (lines 69-125, 579+)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-17T00:00:00Z","closed_at":"2026-01-17T00:00:01Z","labels":["crypto","libnostr","nip-01"]}
{"id":"nostrc-46g","title":"Thread view should fetch full chain to root event","description":"## Problem\n\nThread view does not fetch and display the complete thread chain. Should traverse up to the root event, fetching any missing ancestors.\n\n## Expected Behavior\n\nWhen viewing a thread:\n1. Parse e-tags to find root_id and parent_id\n2. Check if root and all ancestors are in local nostrdb\n3. Fetch any missing events from relays\n4. Display complete thread from root down to current event\n5. Show full context of conversation\n\n## Current Behavior\n\n- Only shows events already in local cache\n- Does not fetch missing ancestors\n- Thread appears incomplete/orphaned\n- User loses context of conversation\n\n## Implementation\n\n1. When opening thread view, extract root_id from NIP-10 tags\n2. Recursively walk parent_id chain to build ancestor list\n3. Identify which ancestors are missing from nostrdb\n4. Batch fetch missing events from relays\n5. Update thread view as events arrive\n6. Handle missing events gracefully (show placeholder or \"event not found\")\n\n## Edge Cases\n\n- Root event deleted or unavailable\n- Very deep threads (set reasonable limit, e.g., 100 ancestors)\n- Circular references (detect and break loops)\n- Slow/unresponsive relays (timeout and show partial thread)\n\n## Related\n\n- nostrc-71t: NIP-10/NIP-7D threads implementation\n- nostrc-mef: NIP-10 root-only marker parsing","status":"closed","priority":2,"issue_type":"bug","assignee":"boris","created_at":"2026-01-29T14:38:53.556709-08:00","created_by":"mayor","updated_at":"2026-01-29T21:54:57.704684-08:00","closed_at":"2026-01-29T21:54:57.704684-08:00","close_reason":"Fixed: Implemented ancestor chain traversal with depth limiting and duplicate prevention for both NIP-10 and NIP-7D thread views"}
{"id":"nostrc-498","title":"Package: Flatpak (Flathub)","description":"## Goal\n\nCreate Flatpak manifest and submit to Flathub for universal Linux distribution.\n\n## Tasks\n\n1. Create Flatpak manifest (YAML)\n   - org.gnostr.Gnostr.yml\n   - Runtime: org.gnome.Platform 46\n   - SDK: org.gnome.Sdk\n   - Bundle all dependencies\n\n2. Desktop integration\n   - .desktop file\n   - AppStream metainfo.xml\n   - Icons at all required sizes\n\n3. Flathub submission\n   - Fork flathub/flathub repo\n   - Add manifest\n   - Submit PR\n\n4. CI workflow\n   - Build Flatpak bundle\n   - Test in container\n   - Upload .flatpak as artifact\n\n## Benefits\n- Works on any Linux distro\n- Sandboxed\n- Auto-updates via Flathub","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:34.972202-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:10.464546-08:00","closed_at":"2026-01-30T12:22:10.464546-08:00","close_reason":"CI jobs already exist: build-flatpak and build-flatpak-gnostr create Flatpak bundles","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-498","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:24.997977-08:00","created_by":"mayor"}]}
{"id":"nostrc-4aen","title":"Profile view no longer loads banner images","description":"Profile view banner images stopped loading. This is a regression ‚Äî banners used to display. Investigate the profile view widget, image loading pipeline, and NDB profile metadata to find where the banner URL fetch/render broke.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T13:51:28.130264-08:00","created_by":"mayor","updated_at":"2026-02-08T14:27:30.731737-08:00","closed_at":"2026-02-08T14:27:30.731737-08:00","close_reason":"Banner images fixed by billy: removed duplicate NDB query in on_note_card_open_profile that cancelled banner load. Commit 6485327"}
{"id":"nostrc-4du","title":"Reconnect to relays on network failure with exponential backoff","description":"## Feature\n\nImplement automatic reconnection to relays when network connection is lost, with retry logic and exponential backoff.\n\n## Requirements\n\n### Detection\n- Detect when connection to relay is lost (socket error, timeout, etc.)\n- Detect when network connectivity is restored\n- Handle partial failures (some relays up, others down)\n\n### Reconnection Strategy\n- Automatic retry on connection failure\n- Exponential backoff: start at 1s, double each retry (1s, 2s, 4s, 8s, 16s...)\n- Cap maximum backoff (e.g., 5 minutes)\n- Jitter to prevent thundering herd when network comes back\n- Reset backoff on successful connection\n\n### State Management\n- Track connection state per relay (connected, disconnected, connecting, backoff)\n- Preserve subscription state for restoration after reconnect\n- Re-subscribe to active subscriptions after reconnection\n- Handle pending messages during disconnect\n\n### User Feedback\n- Visual indicator of relay connection status\n- Optional notification on disconnect/reconnect\n- Show which relays are having issues\n\n## Implementation Notes\n\n```\nbackoff = min(initial_delay * 2^attempt, max_delay)\njittered_backoff = backoff * (0.5 + random(0, 0.5))\n```\n\n## Acceptance Criteria\n\n- [ ] Automatic reconnection on network failure\n- [ ] Exponential backoff prevents relay hammering\n- [ ] Subscriptions restored after reconnect\n- [ ] User can see relay connection status\n- [ ] Works with partial relay failures","status":"closed","priority":2,"issue_type":"feature","assignee":"billy","created_at":"2026-01-29T13:09:54.503276-08:00","created_by":"mayor","updated_at":"2026-01-29T15:51:19.016014-08:00","closed_at":"2026-01-29T15:51:19.016014-08:00","close_reason":"Relay reconnection with exponential backoff implemented"}
{"id":"nostrc-4mo","title":"Package: Windows MSI installer","description":"## Goal\n\nCreate Windows MSI installer for traditional Windows installation.\n\n## Tasks\n\n1. Build for Windows\n   - Cross-compile with MinGW or native MSVC\n   - Bundle GTK4 runtime and dependencies\n   - GStreamer Windows runtime\n\n2. Create MSI with WiX Toolset\n   - Product.wxs definition\n   - Start menu shortcuts\n   - File associations (nostr: URI)\n   - Uninstaller\n\n3. Code signing\n   - Code signing certificate\n   - Sign MSI and EXE\n\n4. CI workflow (windows-latest)\n   - Install MSYS2/MinGW or vcpkg\n   - Build application\n   - Create MSI\n   - Sign\n   - Upload as release artifact\n\n## Notes\n- GTK4 on Windows requires bundling runtime\n- Consider MSYS2 for easier dependency management","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T11:00:14.843403-08:00","created_by":"mayor","updated_at":"2026-01-30T12:25:08.703811-08:00","closed_at":"2026-01-30T12:25:08.703811-08:00","close_reason":"Windows installer provided via NSIS (.exe) in windows-build.yml - functionally equivalent to MSI for end users","labels":["deployment","windows"],"dependencies":[{"issue_id":"nostrc-4mo","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.531825-08:00","created_by":"mayor"}]}
{"id":"nostrc-4we","title":"Plugin Manager: runtime loading/unloading and settings UI","description":"## Goal\n\nAdd a Plugin Manager component with UI for managing plugins at runtime.\n\n## Requirements\n\n### Plugin Manager Core\n- Load plugins at runtime (without app restart)\n- Unload/disable plugins at runtime\n- Track plugin state (loaded, enabled, disabled, error)\n- Handle plugin dependencies\n- Validate plugin compatibility (API version check)\n- Sandboxing considerations for untrusted plugins\n\n### Plugin Manager UI (Settings Panel)\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Plugins                                            [‚öôÔ∏è] ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ\n‚îÇ ‚îÇ [‚úì] NIP-57 Zaps                           v1.0.0  ‚îÇ ‚îÇ\n‚îÇ ‚îÇ     Lightning zap support                [Settings]‚îÇ ‚îÇ\n‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ\n‚îÇ ‚îÇ [‚úì] NIP-07 Browser Signer                 v1.2.0  ‚îÇ ‚îÇ\n‚îÇ ‚îÇ     External signer integration          [Settings]‚îÇ ‚îÇ\n‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ\n‚îÇ ‚îÇ [ ] NIP-94 File Metadata                  v0.9.0  ‚îÇ ‚îÇ\n‚îÇ ‚îÇ     Rich file attachments (disabled)     [Settings]‚îÇ ‚îÇ\n‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ\n‚îÇ                                                         ‚îÇ\n‚îÇ [+ Install Plugin...]          [üîÑ Check for Updates]  ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n### Features\n1. **Plugin List View**\n   - Show installed plugins with icon, name, version, description\n   - Toggle enable/disable with checkbox\n   - Status indicator (active, error, needs restart)\n   - Per-plugin settings button\n\n2. **Plugin Settings Dialog**\n   - Each plugin can register a settings page\n   - GSettings-backed configuration\n   - Reset to defaults option\n\n3. **Plugin Installation**\n   - Install from local .so/.plugin file\n   - Future: Install from plugin repository\n   - Dependency resolution\n\n4. **Plugin Information**\n   - View plugin details (author, license, website)\n   - View permissions/capabilities requested\n   - View changelog\n\n### API Extensions needed\n\n```c\n// Plugin Manager\nGnostrPluginManager* gnostr_plugin_manager_get_default(void);\nGPtrArray* gnostr_plugin_manager_get_plugins(GnostrPluginManager *mgr);\ngboolean gnostr_plugin_manager_load(GnostrPluginManager *mgr, const char *path, GError **error);\ngboolean gnostr_plugin_manager_unload(GnostrPluginManager *mgr, const char *plugin_id, GError **error);\ngboolean gnostr_plugin_manager_enable(GnostrPluginManager *mgr, const char *plugin_id, GError **error);\ngboolean gnostr_plugin_manager_disable(GnostrPluginManager *mgr, const char *plugin_id, GError **error);\n\n// Plugin info (from .plugin file)\nconst char* gnostr_plugin_info_get_id(GnostrPluginInfo *info);\nconst char* gnostr_plugin_info_get_name(GnostrPluginInfo *info);\nconst char* gnostr_plugin_info_get_version(GnostrPluginInfo *info);\nconst char* gnostr_plugin_info_get_description(GnostrPluginInfo *info);\nconst char* gnostr_plugin_info_get_author(GnostrPluginInfo *info);\nconst char* gnostr_plugin_info_get_website(GnostrPluginInfo *info);\nconst char** gnostr_plugin_info_get_dependencies(GnostrPluginInfo *info);\nGnostrPluginState gnostr_plugin_info_get_state(GnostrPluginInfo *info);\n\n// Plugin settings widget (for UI)\nGtkWidget* gnostr_plugin_get_settings_widget(GnostrPlugin *plugin);\n```\n\n### Files to Create\n- `src/ui/gnostr-plugin-manager.c/.h` - Core manager\n- `src/ui/gnostr-plugin-manager-panel.c/.h` - Settings UI panel\n- `src/ui/gnostr-plugin-row.c/.h` - List row widget\n- `data/ui/gnostr-plugin-manager-panel.blp` - UI template\n\n## Depends On\n- nostrc-5zi (plugin API design) - DONE\n- nostrc-oxt (libpeas integration)","status":"closed","priority":2,"issue_type":"task","assignee":"brett","created_at":"2026-01-30T13:03:24.993729-08:00","created_by":"mayor","updated_at":"2026-01-30T14:51:04.557453-08:00","closed_at":"2026-01-30T14:51:04.557453-08:00","close_reason":"Implemented Plugin Manager UI: Blueprint templates, C widget code, manager API headers, and CSS styles","dependencies":[{"issue_id":"nostrc-4we","depends_on_id":"nostrc-5zi","type":"discovered-from","created_at":"2026-01-30T13:03:24.99484-08:00","created_by":"mayor"},{"issue_id":"nostrc-4we","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T13:03:30.03524-08:00","created_by":"mayor"}]}
{"id":"nostrc-5","title":"[DONE] Wire composer to publish events via libnostr","description":"IMPLEMENTED: Connected the GnostrComposer post-requested signal to create and publish events.\n\n## Implementation Summary\n\n### Files Modified\n- apps/gnostr/src/ui/gnostr-main-window.c - Full implementation of on_composer_post_requested()\n- apps/gnostr/src/ui/gnostr-composer.c - Added gnostr_composer_clear()\n- apps/gnostr/src/ui/gnostr-composer.h - Added clear function declaration\n\n### Flow\n1. User types note and clicks Post\n2. Composer emits post-requested signal with text\n3. Main window builds unsigned event JSON (kind:1, content, created_at, empty tags)\n4. Calls NIP-55L signer via DBus async (nostr_org_nostr_signer_call_sign_event)\n5. Signer returns fully signed event JSON\n6. Parse signed event with nostr_event_deserialize_compact()\n7. Load relay URLs from config (or use defaults)\n8. For each relay: connect and publish via gnostr_relay_publish()\n9. Show toast with success/failure count\n10. Clear composer and switch to timeline on success\n\n### Features\n- Async signing (non-blocking UI)\n- Multi-relay publishing\n- Per-relay error handling\n- User feedback via toasts\n- Automatic composer clear on success\n- Tab switch to timeline after publish","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-17T00:00:00Z","closed_at":"2026-01-17T00:00:01Z","labels":["integration","nip-01","ui"]}
{"id":"nostrc-50t","title":"Thread viewer doesn't fetch missing events from relays","description":"## Problem\n\nWhen viewing a thread, only events already in nostrdb are displayed. Events that are referenced (root, replies) but not yet in the local database are not fetched from relays.\n\n## Expected Behavior\n\n1. When opening a thread view, identify missing events (root event, parent events, replies)\n2. Create a subscription to fetch those specific events by ID\n3. Display them in the thread view once received\n4. Handle the case where events are received out of order\n\n## Technical Notes\n\n- Need to extract event IDs from e-tags (root, reply markers)\n- Create REQ filter with specific event IDs: `{\"ids\": [\"...\", \"...\"]}`\n- May also need to fetch replies: `{\"#e\": [\"\u003cthread-root-id\u003e\"], \"kinds\": [1]}`\n- Ensure thread view updates as new events arrive\n\n## Related\n\n- Thread info is now stored before deferral (recently fixed)\n- NIP-10 parsing should correctly identify root/reply events","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T02:07:04.470939-08:00","created_by":"mayor","updated_at":"2026-01-30T02:11:28.598112-08:00","closed_at":"2026-01-30T02:11:28.598113-08:00"}
{"id":"nostrc-50v","title":"Relay manager: first relay selected but info pane empty on open","description":"## Problem\n\nWhen opening the Relay Manager window:\n1. The first relay in the list is automatically selected (highlighted)\n2. But the relay information/details pane is empty\n3. User has to click away and click back to populate the info\n\n## Expected Behavior\n\nWhen the window opens with a relay selected, the details pane should show that relay's information.\n\n## Likely Cause\n\nThe initial selection is set programmatically but the selection-changed signal handler isn't triggered, or the details pane update function isn't called on initial load.\n\n## Fix\n\nEither:\n1. Manually call the details update function after setting initial selection\n2. Or emit the selection-changed signal after programmatic selection\n3. Or populate details pane directly during window initialization\n\n## Files to Check\n\n- Relay manager window code (gnostr-relay-manager.c or similar)\n- Look for `gtk_single_selection_set_selected()` or similar calls\n- Check if there's a selection-changed handler that needs to be called manually","status":"closed","priority":2,"issue_type":"bug","assignee":"boris","created_at":"2026-01-30T14:32:27.58965-08:00","created_by":"mayor","updated_at":"2026-01-30T15:47:35.96628-08:00","closed_at":"2026-01-30T15:47:35.96628-08:00","close_reason":"Closed"}
{"id":"nostrc-52k","title":"Migrate nip28_chat.c from direct jansson to NostrJsonInterface","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T23:56:58.974879-08:00","updated_at":"2026-01-29T23:58:30.776508-08:00","closed_at":"2026-01-29T23:58:30.776508-08:00","close_reason":"Successfully migrated nip28_chat.c from direct jansson to NostrJsonInterface facade. Build verified."}
{"id":"nostrc-53l","title":"Migrate NIP-77 negentropy sync to plugin","description":"## Goal\n\nMigrate NIP-77 (Negentropy sync protocol) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip77/` - negentropy protocol bindings\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip77-negentropy/`\n2. Move negentropy protocol implementation\n3. Register message handlers for NEG-OPEN, NEG-MSG, NEG-CLOSE\n4. Plugin API:\n   ```c\n   void gnostr_negentropy_sync(plugin, relay, filter, callback);\n   ```\n5. Add UI hooks for:\n   - Sync status indicator\n   - Manual sync trigger\n6. Settings:\n   - Auto-sync interval\n   - Sync on startup\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"closed","priority":3,"issue_type":"task","assignee":"billy","created_at":"2026-01-30T10:20:37.409888-08:00","created_by":"mayor","updated_at":"2026-01-31T17:49:29.73265-08:00","closed_at":"2026-01-31T17:49:29.73265-08:00","close_reason":"Completed by billy","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-53l","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T10:20:42.314708-08:00","created_by":"mayor"},{"issue_id":"nostrc-53l","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T10:20:42.382558-08:00","created_by":"mayor"}]}
{"id":"nostrc-57g","title":"Relay pool never connects: WebSocket connections fail silently","description":"Pool initializes 4 relays from GSettings but WebSocket connections never establish. pool_subscribe fails in 5-second retry loop. Timeline only shows stale NDB cache. Debug relay connection lifecycle and WebSocket handshake.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/brett","created_at":"2026-02-08T12:34:19.847021-08:00","created_by":"mayor","updated_at":"2026-02-08T12:43:20.347502-08:00","closed_at":"2026-02-08T12:43:20.347502-08:00","close_reason":"Closed"}
{"id":"nostrc-57j","title":"Add relay-aware filtering using NDB relay tracking","description":"NDB_DB_NOTE_RELAYS tracks which relays saw each event. Currently only used by NIP-77. Could integrate into timeline queries to prefer notes seen on multiple relays (trust scoring), or show relay source info on events. NDB_DB_NOTE_RELAY_KIND index supports efficient relay+kind queries.","status":"closed","priority":3,"issue_type":"feature","assignee":"nostrc/brett","created_at":"2026-02-07T17:20:43.027416-08:00","created_by":"mayor","updated_at":"2026-02-08T02:07:10.655608-08:00","closed_at":"2026-02-08T02:07:10.655608-08:00","close_reason":"Closed"}
{"id":"nostrc-5b8","title":"Timeline events with e-tags not recognized as threads/replies","description":"## Problem\n\nEvents in the timeline with \"e\" tags are not being picked up as threads or replies to other events. The NIP-10 parsing implemented in nostrc-71t may not be working correctly, or the timeline view is not using the thread info.\n\n## Expected Behavior\n\n- Events with \"e\" tags should show reply indicators\n- Clicking should navigate to/show the thread context\n- Reply chains should be visually connected\n\n## Current Behavior\n\n- Events with \"e\" tags display as standalone posts\n- No thread/reply relationship shown\n- NIP-10 parsing not reflected in timeline UI\n\n## Investigation\n\n1. Verify NIP-10 parsing is being called for timeline events (not just thread view)\n2. Check if thread info (root_id, reply_id) is being passed to timeline model\n3. Verify timeline card UI is checking for and displaying reply info\n4. Test with known reply events to confirm parsing works\n\n## Possibly Related\n\n- nostrc-71t: NIP-10/NIP-7D threading implementation (just completed)\n- May need to integrate the thread parsing into timeline model, not just thread view\n\n## Notes\n\nThis is a P1 as threading is core functionality for a nostr client.","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-29T11:47:44.266581-08:00","created_by":"mayor","updated_at":"2026-01-29T14:01:28.770174-08:00","closed_at":"2026-01-29T14:01:28.770174-08:00","close_reason":"Verified fix b46b694: Thread info passed to note cards via set_thread_info() in factory_bind_cb(). Reply indicator shown for events with e-tags."}
{"id":"nostrc-5fx","title":"Migrate NIP-46 Nostr Connect to plugin","description":"## Goal\n\nMigrate NIP-46 (Nostr Connect / remote signing) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip46/` - bunker client, envelope parsing, URI handling\n- Remote signer connection UI\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip46-connect/`\n2. Move bunker client implementation\n3. Register event handlers:\n   - Kind 24133 (request/response)\n4. Plugin API for signer operations:\n   ```c\n   void gnostr_nip46_sign_event(plugin, event, callback);\n   void gnostr_nip46_get_public_key(plugin, callback);\n   void gnostr_nip46_nip04_encrypt(plugin, pubkey, plaintext, callback);\n   ```\n5. Add UI hooks for:\n   - Connect to bunker dialog\n   - Connection status indicator\n   - Signer selection in settings\n6. Settings:\n   - Bunker URL / nostrconnect URI\n   - Auto-reconnect\n   - Permissions\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"closed","priority":3,"issue_type":"task","assignee":"brett","created_at":"2026-01-30T10:20:26.563589-08:00","created_by":"mayor","updated_at":"2026-01-31T18:02:22.533362-08:00","closed_at":"2026-01-31T18:02:22.533362-08:00","close_reason":"Completed by brett: ee55f13 - full NIP-46 plugin with UI","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-5fx","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T10:20:37.235516-08:00","created_by":"mayor"},{"issue_id":"nostrc-5fx","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T10:20:37.302058-08:00","created_by":"mayor"}]}
{"id":"nostrc-5g2n","title":"SEGV in profile pane clear: Pango NULL during NoteCardRow dispose","description":"## Crash\n\nClicking a profile in discover view ‚Üí SEGV. ASAN trace shows:\n\n```\n#0 libpango SEGV writing NULL (0x000000000000)\n#16 gnostr_note_card_row_dispose (note_card_row.c:546)\n#18 gtk_list_item_set_child\n#37 g_list_store_remove_all\n#38 gnostr_profile_pane_clear (gnostr-profile-pane.c:1771)\n#40 gnostr_profile_pane_set_pubkey (gnostr-profile-pane.c:4837)\n#49 on_row_clicked (gnostr-profile-row.c:106)\n```\n\n## Root Cause Analysis\n\n`gnostr_profile_pane_clear()` calls `g_list_store_remove_all()` which triggers GtkListView to teardown+dispose NoteCardRows. During dispose, `gtk_widget_dispose_template` unrefs child widgets including labels with PangoLayouts. A Pango layout has a NULL pointer in its line list ‚Üí SEGV.\n\nMEMORY.md rule: \"Any code that manually manages NoteCardRow (not via GtkListItemFactory) MUST call `prepare_for_unbind` before removing rows.\"\n\nThe profile pane's list store removal doesn't call `prepare_for_unbind` before clearing. The 2B deferred media changes (PendingMediaItem + map handler) added state that MUST be cleaned up via `prepare_for_unbind` before row disposal. Without it, stale map signal handlers fire during dispose ‚Üí corrupt widget state ‚Üí Pango SEGV.\n\n## Fix\n\nIn `gnostr-profile-pane.c`, before calling `g_list_store_remove_all()`:\n1. Iterate the GListStore's backing list items\n2. Call `gnostr_note_card_row_prepare_for_unbind()` on each visible NoteCardRow\n3. Then call `g_list_store_remove_all()`\n\nAlternatively, the GtkListView's factory teardown callback should call `prepare_for_unbind`. Check if the profile pane uses a factory and if its unbind/teardown callbacks are correct.\n\n## Files\n- `apps/gnostr/src/ui/gnostr-profile-pane.c` ‚Äî lines 1683, 1771, 4837\n- `apps/gnostr/src/ui/note_card_row.c` ‚Äî dispose at line 546, prepare_for_unbind","status":"closed","priority":0,"issue_type":"bug","assignee":"brett","created_at":"2026-02-10T23:31:38.814981-08:00","created_by":"mayor","updated_at":"2026-02-10T23:39:48.662931-08:00","closed_at":"2026-02-10T23:39:48.662931-08:00","close_reason":"Clear label text in prepare_for_unbind before disposed=TRUE (native surface still valid). Added safety prepare_for_unbind in factory_teardown_cb for mass removal edge case."}
{"id":"nostrc-5hn","title":"Migrate NIP-25 reactions to plugin","description":"## Goal\n\nMigrate NIP-25 (reactions) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip25/` - library code for parsing/creating reactions\n- UI code in gnostr app for displaying and creating reactions\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip25-reactions/`\n2. Move reaction parsing/creation code\n3. Register event handler for kind 7\n4. Add UI hooks for:\n   - Reaction buttons on notes\n   - Reaction count display\n   - Reaction picker\n5. Settings: default reaction emoji\n\n## Why This NIP First\n- Relatively simple event type\n- Self-contained functionality\n- Good test case for UI hooks\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-30T09:26:41.051593-08:00","created_by":"mayor","updated_at":"2026-01-30T10:20:06.345882-08:00","labels":["nip","plugin"],"deleted_at":"2026-01-30T10:20:06.345882-08:00","deleted_by":"mayor","delete_reason":"NIP-25 is now classified as core, not plugin","original_type":"task"}
{"id":"nostrc-5o5","title":"Memory leak: conn-\u003epriv not freed when service thread running","description":"\n## Location\nlibnostr/src/connection.c:571-576\n\n## Description\nThe code explicitly acknowledges a memory leak:\n\n```c\n/* Note: If we don't free conn-\u003epriv here, it will leak. This is a known limitation\n * of the current architecture where we can't safely free while service thread is running.\n * A proper fix would require refcounting or deferred cleanup. */\n```\n\nWhen `should_free_priv` is false (i.e., when the shared LWS context is still in use by other connections), the NostrConnectionPrivate structure leaks.\n\n## Impact\nEach closed connection that isn't the last connection leaks a NostrConnectionPrivate structure. This includes mutex state and token bucket data.\n\n## Fix Suggestion\nImplement deferred cleanup with a reference-counted private struct, or use a cleanup queue that the service thread processes before exiting.\n","status":"closed","priority":1,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T10:29:57.709584-08:00","created_by":"nostrc/crew/billy","updated_at":"2026-01-29T11:06:02.316031-08:00","closed_at":"2026-01-29T11:06:02.316031-08:00","close_reason":"Implemented deferred cleanup queue for conn-\u003epriv when service thread is running","labels":["memory-leak"]}
{"id":"nostrc-5vm","title":"Package: Debian/Ubuntu .deb","description":"## Goal\n\nCreate CI workflow to build .deb packages for Debian and Ubuntu.\n\n## Tasks\n\n1. Create debian/ packaging directory\n   - control file with dependencies\n   - rules file for build\n   - changelog\n   - copyright\n\n2. GitHub Actions workflow\n   - Build on ubuntu-latest\n   - Test installation in container\n   - Upload as release artifact\n\n3. Target distributions\n   - Ubuntu 22.04 LTS\n   - Ubuntu 24.04 LTS\n   - Debian 12 (bookworm)\n\n## Dependencies\n- GTK4, libadwaita, GStreamer, etc. as package deps","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:24.876012-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:08.308016-08:00","closed_at":"2026-01-30T12:22:08.308016-08:00","close_reason":"CI job already exists: build-deb creates .deb packages using fpm","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-5vm","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:24.8493-08:00","created_by":"mayor"}]}
{"id":"nostrc-5yt","title":"timeline hex conversion doesn't validate all 32 bytes","description":"In load_older() (lines 537-545), the hex-to-binary conversion loop breaks on sscanf failure but doesn't validate all 32 bytes were converted. Could result in partially-converted ID being used for note_key lookup, potentially returning wrong note or causing undefined behavior. File: apps/gnostr/src/model/gn-timeline-model.c","status":"closed","priority":2,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T09:43:29.268333-08:00","created_by":"flotilla_budabit/crew/gus","updated_at":"2026-01-29T10:33:42.227736-08:00","closed_at":"2026-01-29T10:33:42.227736-08:00","close_reason":"Fixed: track bytes_converted and skip note if not all 32 bytes converted"}
{"id":"nostrc-5z0","title":"Package: Windows MSIX (Microsoft Store)","description":"## Goal\n\nCreate MSIX package for distribution via Microsoft Store.\n\n## Tasks\n\n1. Create MSIX package\n   - AppxManifest.xml\n   - Package assets (icons, tiles)\n   - Capabilities declaration\n\n2. Microsoft Store submission\n   - Partner Center account\n   - Store listing\n   - Screenshots, descriptions\n\n3. CI workflow\n   - Build MSIX\n   - Sign with store certificate\n   - Upload for store submission\n\n## Benefits\n- Auto-updates via Store\n- Sandboxed installation\n- Easy discovery for Windows users\n\n## Requirements\n- Microsoft Partner Center account\n- Store signing certificate","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T11:00:18.563367-08:00","created_by":"mayor","updated_at":"2026-01-30T12:25:10.882473-08:00","closed_at":"2026-01-30T12:25:10.882473-08:00","close_reason":"Deferring MSIX/Store packaging - NSIS installer available for direct download. MSIX requires Microsoft Store account and additional tooling.","labels":["deployment","windows"],"dependencies":[{"issue_id":"nostrc-5z0","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.596458-08:00","created_by":"mayor"}]}
{"id":"nostrc-5zi","title":"Design plugin API/ABI for libpeas integration","description":"## Goal\n\nDesign a stable plugin API that won't break across updates.\n\n## Requirements\n\n### Plugin Capabilities\nPlugins should be able to:\n1. **Event Handling** - Register handlers for specific event kinds\n2. **UI Extensions** - Add menu items, toolbar buttons, settings pages\n3. **Network Access** - Subscribe to relays, publish events\n4. **Storage** - Store/retrieve plugin-specific data\n5. **Settings** - Expose configurable options via GSettings\n\n### API Stability Considerations\n- Use opaque struct pointers with accessor functions\n- Version the API (major.minor) \n- Document which functions are stable vs experimental\n- Consider using GObject interfaces for extension points\n\n### Key Interfaces\n\n```c\n// Plugin info/lifecycle\ntypedef struct _GnostrPluginInfo GnostrPluginInfo;\nGnostrPluginInfo* gnostr_plugin_get_info(GnostrPlugin *plugin);\nvoid gnostr_plugin_activate(GnostrPlugin *plugin);\nvoid gnostr_plugin_deactivate(GnostrPlugin *plugin);\n\n// Event handling\nvoid gnostr_plugin_register_event_handler(GnostrPlugin *plugin, int kind, GnostrEventCallback callback);\n\n// UI extension\nvoid gnostr_plugin_add_menu_item(GnostrPlugin *plugin, const char *menu_id, GMenuItem *item);\nvoid gnostr_plugin_add_settings_page(GnostrPlugin *plugin, GtkWidget *page);\n\n// Network\nGnostrSimplePool* gnostr_plugin_get_pool(GnostrPlugin *plugin);\n\n// Storage\nvoid gnostr_plugin_store_data(GnostrPlugin *plugin, const char *key, GBytes *data);\nGBytes* gnostr_plugin_load_data(GnostrPlugin *plugin, const char *key);\n```\n\n## Deliverables\n- Header file: `gnostr-plugin-api.h`\n- GObject interface definitions\n- Documentation for plugin developers","status":"closed","priority":2,"issue_type":"task","assignee":"brett","created_at":"2026-01-30T09:26:13.052559-08:00","created_by":"mayor","updated_at":"2026-01-30T12:57:29.879236-08:00","closed_at":"2026-01-30T12:57:29.879236-08:00","close_reason":"Designed plugin API header (gnostr-plugin-api.h) and developer documentation (PLUGIN_DEVELOPMENT.md)","labels":["architecture","design"],"dependencies":[{"issue_id":"nostrc-5zi","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T09:26:20.077326-08:00","created_by":"mayor"}]}
{"id":"nostrc-6","title":"[DONE] Add reply threading support to composer","description":"IMPLEMENTED: Added reply threading support with proper NIP-10 tags.\n\n## Implementation Summary\n\n### Files Modified\n- apps/gnostr/src/ui/gnostr-composer.c - Added reply context state (reply_to_id, root_id, reply_to_pubkey)\n- apps/gnostr/src/ui/gnostr-composer.h - Added reply context API\n- apps/gnostr/src/ui/note_card_row.c - Added reply-requested signal\n- apps/gnostr/src/ui/gnostr-main-window.c - Handle reply-requested, build NIP-10 tags\n- apps/gnostr/src/ui/gnostr-timeline-view.c - Relay reply-requested signal to main window\n- apps/gnostr/data/ui/widgets/gnostr-composer.ui - Added reply indicator UI\n- apps/gnostr/data/ui/widgets/note-card-row.ui - Reply button already existed\n\n### Features\n- Reply button on note cards emits reply-requested signal\n- Composer shows \"Replying to @user\" indicator with cancel button\n- Post button changes to \"Reply\" in reply mode\n- NIP-10 e-tags with \"root\" and \"reply\" markers\n- p-tag for the author being replied to\n- Automatic reply context clear after publish","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-17T00:00:00Z","closed_at":"2026-01-17T00:00:01Z","labels":["nip-01","nip-10","ui"]}
{"id":"nostrc-6a3","title":"NIP-34 Git Repository Plugin","description":"Implement a NIP-34 plugin for Nostr git repository integration.\n\n## Features\n\n### 1. Repository Browser View\n- List all published git repositories from followed users and relays\n- Show repo metadata: name, description, maintainers, clone URLs\n- Filter/search repositories\n- Display repo activity (recent patches, issues)\n\n### 2. Graphical Git Client View\n- Visual commit history (DAG view)\n- Branch visualization\n- Diff viewer for commits and patches\n- Stage/unstage changes\n- Commit interface\n- Push/pull to Nostr relays\n\n## NIP-34 Event Types\n- kind 30617: Repository announcement\n- kind 1617: Patches\n- kind 1621: Issues\n- kind 1622: Issue replies\n\n## Implementation Notes\n- Integrate with existing gnostr GTK4 UI patterns\n- Use libgit2 for git operations\n- May leverage existing flotilla_budabit/packages/nostr-git-ui components as reference\n- Consider lazy loading for large repo lists\n\n## Files to create/modify\n- apps/gnostr/src/plugins/nip34/ (new plugin directory)\n- apps/gnostr/src/ui/gnostr-repo-browser.c\n- apps/gnostr/src/ui/gnostr-git-client.c\n- nips/nip34/ (protocol implementation)","status":"closed","priority":1,"issue_type":"feature","assignee":"brett","created_at":"2026-01-31T20:26:41.499982-08:00","created_by":"mayor","updated_at":"2026-01-31T20:33:24.021105-08:00","closed_at":"2026-01-31T20:33:24.021105-08:00","close_reason":"Plugin scaffolding complete - builds successfully"}
{"id":"nostrc-6xj","title":"Extract shared JSON utility functions from duplicated compact parsers","description":"String escape/unescape logic is duplicated in event.c (lines 189-290) and envelope.c (lines 568-631). UTF-16 surrogate pair handling also duplicated. Extract to shared nostr_json_utils.c with: nostr_json_escape_string(), nostr_json_unescape_string(), nostr_utf16_to_utf8(). Both compact parsers should call the shared functions. Maintain fast-path performance.","status":"closed","priority":1,"issue_type":"task","assignee":"nostrc/boris","created_at":"2026-02-07T17:44:37.142122-08:00","created_by":"mayor","updated_at":"2026-02-08T02:05:28.613831-08:00","closed_at":"2026-02-08T02:05:28.613831-08:00","close_reason":"Closed"}
{"id":"nostrc-7","title":"Implement @mention detection and p-tag generation","description":"Detect @mentions in composed notes and generate proper p-tags.\n\n## Technical Requirements\n\n### Mention Formats to Detect\n1. @npub1... (NIP-19 bech32 pubkey)\n2. @nprofile1... (NIP-19 profile with relay hints)\n3. @name (if name resolves to known pubkey)\n\n### Detection Logic\n1. Parse content for @ followed by nostr identifiers\n2. Decode bech32 to get pubkey\n3. For nprofile, also extract relay hints\n4. Generate p-tags for each unique pubkey\n\n### Tag Generation (using libnostr)\n```c\nunsigned char pk_bytes[32];\nhex_to_bytes(pubkey_hex, pk_bytes);\nnostr_nip01_add_p_tag(event, pk_bytes, relay_hint);\n```\n\n### UI Enhancements\n- Autocomplete dropdown when typing @\n- Show profile name/avatar in dropdown\n- Search local profile cache first\n- Highlight mentions in composer\n\n## Files to Modify\n- apps/gnostr/src/ui/gnostr-composer.c\n- May need new mention detection module\n- Integrate with GnNostrProfile cache\n\n## Edge Cases\n- Invalid bech32 strings\n- Unknown pubkeys (still generate p-tag)\n- Duplicate mentions (deduplicate)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:17:07.853664-08:00","closed_at":"2026-01-19T13:17:07.853664-08:00","close_reason":"Already implemented in libnostr","labels":["nip-01","nip-19","ui"]}
{"id":"nostrc-70k","title":"Implement gnostr_plugin_context_* API functions","description":"The plugin API header (gnostr-plugin-api.h) declares several context functions that are not implemented:\n\n- gnostr_plugin_context_publish_event()\n- gnostr_plugin_context_subscribe_events()\n- gnostr_plugin_context_unsubscribe_events()\n- gnostr_plugin_context_store_data()\n- gnostr_plugin_context_load_data()\n- gnostr_plugin_context_delete_data()\n- gnostr_plugin_context_query_events()\n- gnostr_plugin_context_get_event_by_id()\n\nThese are needed for the NIP-47 NWC plugin (and future plugins) to work.\n\nThe nip47-nwc plugin is currently disabled in CMakeLists.txt until this is implemented.\n\nBlocked: nip47-nwc plugin (Boris's commit 11a6407)","status":"closed","priority":2,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-31T19:00:14.19587-08:00","created_by":"mayor","updated_at":"2026-01-31T19:08:29.488281-08:00","closed_at":"2026-01-31T19:08:29.488281-08:00","close_reason":"Closed"}
{"id":"nostrc-71t","title":"Fix threads implementation for NIP-7D and NIP-10 compliance","description":"## Problem\n\nThe current threads implementation has several issues:\n\n1. **Events with \"e\" tags not treated as threads** - NIP-10 specifies how \"e\" tags indicate reply relationships, but these are not being recognized as thread participants\n2. **Profile display issues** - The threads panel has problems displaying user profiles correctly\n3. **Missing referenced events** - Only shows events in local nostrdb cache, not events referenced by existing events\n\n## Requirements\n\n### NIP-10 Compliance (Reply Threading)\nReference: https://github.com/nostr-protocol/nips/blob/master/10.md\n\n- Parse \"e\" tags correctly to determine thread structure:\n  - First \"e\" tag = root event (the original post)\n  - Last \"e\" tag = reply-to event (direct parent)\n  - Middle \"e\" tags = mentions\n- Support both deprecated positional and preferred marker styles:\n  - Markers: `[\"e\", \"\u003cid\u003e\", \"\u003crelay\u003e\", \"root\"]` and `[\"e\", \"\u003cid\u003e\", \"\u003crelay\u003e\", \"reply\"]`\n  - Positional: first = root, last = reply (when no markers)\n- Build proper thread tree from reply relationships\n\n### NIP-7D Compliance (Threads)\nReference: https://github.com/nostr-protocol/nips/blob/master/7D.md\n\n- Implement proper thread identification\n- Handle thread roots and replies correctly\n- Support thread subscription patterns\n\n### Fetch Missing Events\n- When displaying a thread, identify all referenced event IDs from \"e\" tags\n- Check which are missing from local nostrdb cache\n- Fetch missing events from relays\n- Update thread view as events arrive\n- Handle circular references gracefully\n\n### Profile Display Fixes\n- Audit profile loading in threads panel\n- Ensure proper async loading with placeholders\n- Handle missing/failed profile fetches gracefully\n- Use consistent profile display component\n\n## Implementation Notes\n\n- Review existing threads panel code for current \"e\" tag handling\n- Consider subscription strategy for fetching missing events (batch requests)\n- Rate limit fetches to avoid relay spam\n- Cache fetched events in nostrdb for future use\n- Test with deeply nested threads and wide threads\n\n## Acceptance Criteria\n\n- [ ] Events with \"e\" tags display in thread view\n- [ ] Root, reply-to, and mentions correctly identified per NIP-10\n- [ ] NIP-7D thread structure properly rendered\n- [ ] Missing referenced events fetched from relays\n- [ ] Profiles display correctly in threads panel\n- [ ] Thread view updates smoothly as events arrive","status":"closed","priority":1,"issue_type":"feature","assignee":"boris","created_at":"2026-01-29T10:43:04.041282-08:00","created_by":"mayor","updated_at":"2026-01-29T10:55:30.175706-08:00","closed_at":"2026-01-29T10:55:30.175706-08:00","close_reason":"Fixed NIP-10/NIP-7D threading: (1) Fixed e-tag parsing with proper positional fallback, (2) Added NIP-10 parsing to real-time subscription callbacks, (3) Implemented recursive fetch of missing ancestor events"}
{"id":"nostrc-737","title":"Improve error reporting in compact JSON parsers","description":"Compact parsers in event.c, envelope.c, filter.c have silent failures and minimal error messages. Add error codes and descriptive messages for parse failures. Return structured error info so callers can log what went wrong. Helps debug relay communication issues.","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/brett","created_at":"2026-02-07T17:44:52.636766-08:00","created_by":"mayor","updated_at":"2026-02-08T12:35:46.448616-08:00","closed_at":"2026-02-08T12:35:46.448616-08:00","close_reason":"Closed"}
{"id":"nostrc-747","title":"Digest: mol-witness-patrol","description":"Patrol 1: No polecats, refinery running, deacon responsive, inbox clean","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T18:46:29.646105-08:00","updated_at":"2026-01-24T18:46:29.646105-08:00","closed_at":"2026-01-24T18:46:29.646062-08:00","close_reason":"Squashed from 10 wisps"}
{"id":"nostrc-75o3","title":"Phase 3: Startup Optimization","description":"Reduce time from launch to responsive UI. Targets: 30-60 second post-launch sluggishness.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-02-10T22:39:18.415374-08:00","created_by":"mayor","updated_at":"2026-02-10T22:57:22.268146-08:00","closed_at":"2026-02-10T22:57:22.268146-08:00","close_reason":"Phase 3 complete: deferred heavy init (3A), bounded event queue with adaptive drain (3B)"}
{"id":"nostrc-75o3.1","title":"3A: Defer heavy init to after first frame","description":"Currently on_activate (main_app.c:42) does plugin discovery, then gnostr_main_window_new() triggers start_pool_live() + relay connections + event model init ALL before the window paints. The window doesn't appear for several seconds.\n\n**Fix**: In gnostr_main_window_init, show the window in loading state immediately (GNOSTR_MAIN_WINDOW_PAGE_LOADING). Use g_idle_add_full(G_PRIORITY_LOW, ...) to defer: plugin discovery, event model setup, start_pool_live(), and gift wrap subscription startup. This lets GTK paint the skeleton UI before heavy work begins.\n\n**Files**:\n- apps/gnostr/src/main_app.c ‚Äî move plugin discovery to idle callback\n- apps/gnostr/src/ui/gnostr-main-window.c ‚Äî defer start_pool_live and heavy init to G_PRIORITY_LOW idle\n\n**Validation**: Measure time from process start to window visible. Window should appear within 500ms. Heavy init runs after first frame paint.","status":"closed","priority":1,"issue_type":"task","assignee":"brett","created_at":"2026-02-10T22:40:38.02763-08:00","created_by":"mayor","updated_at":"2026-02-10T22:51:54.059116-08:00","closed_at":"2026-02-10T22:51:54.059116-08:00","close_reason":"Split window init into Phase 1 (sync: template, signals, fields, LOADING page) and Phase 2 (G_PRIORITY_LOW idle: event model, NDB thread, pool, relays, subscriptions, session restore). Plugin discovery also deferred to idle. Window visible before heavy work begins.","dependencies":[{"issue_id":"nostrc-75o3.1","depends_on_id":"nostrc-75o3","type":"parent-child","created_at":"2026-02-10T22:40:38.028765-08:00","created_by":"mayor"}]}
{"id":"nostrc-75o3.2","title":"3B: Bound event queue + adaptive drain rate","description":"Monitor thread event_queue in nostr_subscription.c is unbounded. At startup, 10 relays x 100 events = 1000 events backlog, draining at MAX_EVENTS_PER_TICK=20 = 50 ticks of heavy main-thread work.\n\n**Fix**: Cap event_queue at 200 entries. When over capacity, drop oldest (NDB persistence already stores all events via ingest, so UI-level drops are safe). Increase MAX_EVENTS_PER_TICK to 50 with a frame-time guard: after each batch of 10, check elapsed time via g_get_monotonic_time(); stop if over 8ms. This drains faster while respecting GTK's 16.6ms frame budget.\n\n**Files**:\n- gobject/src/nostr_subscription.c ‚Äî add queue capacity check in monitor thread, adaptive drain in drain_event_queue_on_main\n\n**IMPORTANT**: This file is in gobject/ (libnostr GObject layer), NOT in apps/gnostr/. The drain function and monitor thread are the targets.\n\n**Validation**: Connect to 5+ relays. Observe event queue depth during startup flood. Queue should never exceed 200 and drain within 5 seconds instead of 50 ticks.","status":"closed","priority":1,"issue_type":"task","assignee":"bruce","created_at":"2026-02-10T22:40:55.563956-08:00","created_by":"mayor","updated_at":"2026-02-10T22:48:32.330839-08:00","closed_at":"2026-02-10T22:48:32.330839-08:00","close_reason":"Bounded event queue at 200 entries (drop oldest when full). Adaptive drain: MAX_EVENTS_PER_TICK=50 with 8ms frame-time guard checking every 10 events. Un-emitted events prepended back to queue for next iteration.","dependencies":[{"issue_id":"nostrc-75o3.2","depends_on_id":"nostrc-75o3","type":"parent-child","created_at":"2026-02-10T22:40:55.565012-08:00","created_by":"mayor"}]}
{"id":"nostrc-75x","title":"Profile fetch batches never completing - stale batch warnings","description":"Console flooded with stale batch warnings:\n\n```\n[PROFILE] ‚ö†Ô∏è STALE BATCH DETECTED - profile_batches is non-NULL but no fetch running!\n[PROFILE] This indicates a previous fetch never completed. Clearing stale state.\n```\n\n**Problem:**\nProfile fetch operations are starting but not completing, leaving stale batch state.\n\n**Impact:**\n- Profile data may not load\n- Wasted resources on incomplete fetches\n- State management issues\n\n**Possible causes:**\n1. Subscription closes before profile response arrives\n2. Callback not firing on completion\n3. Error path not cleaning up batch state\n4. Related to nostrc-d6j EOSE handling issues (now fixed - verify)\n\n**Investigation:**\n- Trace profile fetch lifecycle: start ‚Üí subscription ‚Üí events ‚Üí EOSE ‚Üí cleanup\n- Check if subscription is being closed prematurely\n- Verify completion callback is wired correctly\n\n**File:** apps/gnostr/src/ui/gnostr-main-window.c (profile batch handling)","status":"closed","priority":2,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-31T16:13:36.528045-08:00","created_by":"mayor","updated_at":"2026-01-31T16:23:32.002726-08:00","closed_at":"2026-01-31T16:23:32.002726-08:00","close_reason":"Fixed: stale batch detection now checks profile_fetch_active. Re-queues authors when fetch in progress."}
{"id":"nostrc-7lv","title":"ASAN crash in note_card_row dispose during items_changed","description":"## Crash Report\n\nASAN crash when clicking \"new notes\" button. Use-after-free or memory corruption during widget disposal.\n\n## Stack Trace Summary\n\n```\nEXC_BAD_ACCESS (code=1, address=0x7065722d6c69616d)\n                                 ^^^^^^^^^^^^^^^^\n                                 ASCII: \"mail-rep\" (corrupted string data)\n\nKey frames:\n#13: gnostr_note_card_row_dispose at note_card_row.c:415\n#15: gtk_list_item_set_child\n#24: gtk_list_item_manager_model_items_changed_cb\n#38: flush_deferred_notes_cb at gn-nostr-event-model.c:631\n#40: on_new_notes_clicked at gnostr-main-window.c:4639\n```\n\n## Call Chain\n\n1. User clicks \"new notes\" button\n2. `on_new_notes_clicked` ‚Üí `gn_nostr_event_model_set_user_at_top`\n3. `flush_deferred_notes_cb` flushes pending notes\n4. `g_list_model_items_changed` signal emitted\n5. GTK list item manager responds, tears down old widgets\n6. `gnostr_note_card_row_dispose` called at note_card_row.c:415\n7. Template disposal triggers image finalization\n8. Crash in `g_object_unref` - object already freed or corrupted\n\n## Analysis\n\nThe address `0x7065722d6c69616d` decodes to ASCII \"mail-rep\" (reversed \"per-liam\"), suggesting the GObject instance pointer has been overwritten with string data. This indicates:\n\n- Use-after-free: object freed but pointer still held\n- Or double-free: object being disposed twice\n- Or memory corruption: string data overwrote object memory\n\n## Investigation Points\n\n1. **note_card_row.c:415** - What is being disposed here? Check if template children are being double-unref'd\n2. **Check ref counting** - Is the note card row being properly ref'd when added to list?\n3. **Check async callbacks** - Are there callbacks holding stale pointers to disposed rows?\n4. **Check image handling** - The crash is in gtk_image finalization - check how images are managed in note cards\n5. **Race condition?** - Is flush_deferred_notes_cb racing with widget disposal?\n\n## Full Backtrace\n\n```\nframe #0: g_type_check_instance_is_fundamentally_a + 12\nframe #1: g_object_unref + 52\nframe #2: gtk_image_definition_unref + 60\nframe #3: gtk_icon_helper_finalize + 64\nframe #4: g_object_unref + 564\nframe #5: gtk_image_finalize + 40\nframe #6: g_object_unref + 564\nframe #7: gtk_box_dispose + 28\n...\nframe #13: gnostr_note_card_row_dispose at note_card_row.c:415\nframe #14: g_object_unref + 288\nframe #15: gtk_list_item_set_child + 200\n...\nframe #38: flush_deferred_notes_cb at gn-nostr-event-model.c:631\nframe #40: on_new_notes_clicked at gnostr-main-window.c:4639\n```\n\n## Reproduce\n\n1. Run gnostr under ASAN\n2. Load timeline with events\n3. Wait for new notes to arrive\n4. Click \"new notes\" button\n5. Crash occurs during widget teardown","status":"closed","priority":0,"issue_type":"bug","assignee":"billy","created_at":"2026-01-29T12:06:54.217518-08:00","created_by":"mayor","updated_at":"2026-01-29T14:01:27.389144-08:00","closed_at":"2026-01-29T14:01:27.389144-08:00","close_reason":"Verified fix bc61071: Video players stopped in prepare_for_unbind() before disposal, preventing GStreamer memory corruption during widget recycling."}
{"id":"nostrc-7og","title":"Implement NIP-42 relay authentication","description":"Implement NIP-42 authentication challenge/response flow. When a relay sends AUTH challenge, present signing dialog, create kind 22242 auth event, send back. Brett's relay limitation code (nostrc-23) already detects auth_required from NIP-11. Now implement the actual auth handshake.\n\n- Handle AUTH challenge from relay (parse challenge string)\n- Create kind 22242 signed auth event\n- Send auth response\n- Track auth state per relay\n- Retry failed operations after successful auth","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-02-08T04:12:52.661387-08:00","created_by":"mayor","updated_at":"2026-02-08T04:42:28.456995-08:00","closed_at":"2026-02-08T04:42:28.456995-08:00","close_reason":"Closed"}
{"id":"nostrc-7r5","title":"Threaded notes ignore relay hints in e-tags - rootless threads","description":"Many threaded notes have 'e' tags with relay hints, but the app:\n1. Doesn't fetch the referenced events from the hinted relays\n2. Doesn't appear to even attempt lookups\n3. Results in 'rootless' threads where parent/root events are missing\n\n**Example e-tag with relay hint:**\n```\n[\"e\", \"\u003cevent_id\u003e\", \"wss://relay.example.com/\", \"root\"]\n```\n\nThe relay hint (index 2) should be used to fetch the event if not already in cache.\n\n**Expected behavior:**\n- If event not in local cache, query the hinted relay\n- Fall back to connected relays if hint fails\n- Display thread structure once events are fetched\n\n**Possibly related to:**\n- hq-lo184 (NIP-10 5-element e-tag parsing)\n- nostrc-d6j (subscription/EOSE handling)\n\n**Files to investigate:**\n- NIP-10 threading/reply parsing\n- Event fetching/relay hint handling\n- Thread view construction","status":"closed","priority":1,"issue_type":"bug","assignee":"brett","created_at":"2026-01-31T13:57:55.041817-08:00","created_by":"mayor","updated_at":"2026-01-31T15:28:56.400954-08:00","closed_at":"2026-01-31T15:28:56.400954-08:00","close_reason":"Resolved merge conflicts and pushed fix for NIP-10 relay hints in thread view"}
{"id":"nostrc-7tx","title":"Can't scroll to top of timeline when new notes toast is showing","description":"## Bug\n\nWhen the \"new notes\" toast/indicator is visible at the top of the timeline, users cannot scroll all the way to the top of the existing content.\n\n## Expected Behavior\n\n- Should be able to scroll to see all existing timeline content\n- New notes toast should not block access to content\n- Scrolling past toast should either dismiss it or scroll under it\n\n## Current Behavior\n\n- Scrolling is blocked or limited when toast is visible\n- Cannot reach the top of the timeline content\n- Content is hidden behind/under the toast\n\n## Possible Causes\n\n- Toast overlay consuming scroll events\n- Scroll bounds not accounting for toast height\n- Toast positioned in a way that clips scrollable area\n- GtkScrolledWindow adjustment not updated when toast appears\n\n## Investigation\n\n1. Check how new notes toast is positioned (overlay vs inline)\n2. Check if scroll adjustment bounds are correct\n3. Verify scroll events are reaching the list view\n4. Test if dismissing toast fixes scrolling","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-29T13:14:04.621213-08:00","created_by":"mayor","updated_at":"2026-01-29T21:54:57.644955-08:00","closed_at":"2026-01-29T21:54:57.644955-08:00","close_reason":"Fixed: Set can-target=FALSE on new notes revealer to allow scroll events through, while keeping button clickable"}
{"id":"nostrc-7u2","title":"Iteration 3: Producer-side rate limiting","description":"## Goal\n\nThird iteration: if consumer can't keep up, slow down producers.\n\n## Approach\n\n### 1. Backpressure signal to relay threads\n```c\n// In relay message loop\nif (queue_utilization() \u003e 0.9) {\n  // Pause processing for a bit\n  g_usleep(10000);  // 10ms\n}\n```\n\n### 2. Subscription windowing\n```c\n// Instead of fetching all history at once\nfilter.since = now - 3600;  // Last hour only\nfilter.limit = 500;         // Cap per request\n\n// Paginate backwards as user scrolls\n```\n\n### 3. Priority queues\n```c\ntypedef enum {\n  PRIORITY_CRITICAL,  // DMs, zaps, mentions\n  PRIORITY_HIGH,      // Replies to own posts\n  PRIORITY_NORMAL,    // Timeline events\n  PRIORITY_LOW,       // Reactions, reposts\n} EventPriority;\n\n// Critical events never dropped\n// Low priority dropped first under pressure\n```\n\n### 4. Relay-level rate limiting\n```c\n// Track events/sec per relay\n// If relay floods us, temporarily CLOSE subscription\n// Resubscribe with smaller window after cooldown\n```\n\n## Success Criteria\n\n- Graceful degradation under extreme load\n- Critical events (DMs, zaps) never dropped\n- Relay connections remain stable","notes":"Implemented producer-side rate limiting with event priority classification, queue utilization monitoring, and graduated throttle delays. Critical events (DMs, zaps, mentions) never dropped. Tests pass.","status":"closed","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-01-30T11:28:35.315186-08:00","created_by":"mayor","updated_at":"2026-01-31T13:41:18.86627-08:00","closed_at":"2026-01-31T13:41:18.86627-08:00","close_reason":"Committed by bruce: b388fbf","labels":["performance","reliability"],"dependencies":[{"issue_id":"nostrc-7u2","depends_on_id":"nostrc-pvy","type":"parent-child","created_at":"2026-01-30T11:28:42.109298-08:00","created_by":"mayor"},{"issue_id":"nostrc-7u2","depends_on_id":"nostrc-bhm","type":"blocks","created_at":"2026-01-30T11:28:42.295825-08:00","created_by":"mayor"}]}
{"id":"nostrc-7ur","title":"timeline load_older doesn't check mute list","description":"In load_older() (lines 517-570), notes are added without checking the mute list. The subscription callback (on_sub_timeline_batch) properly checks mute list at lines 366-374, but pagination results bypass this. Muted users' notes can appear when scrolling down. File: apps/gnostr/src/model/gn-timeline-model.c","status":"closed","priority":2,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T09:43:23.053468-08:00","created_by":"flotilla_budabit/crew/gus","updated_at":"2026-01-29T10:33:42.192666-08:00","closed_at":"2026-01-29T10:33:42.192666-08:00","close_reason":"Fixed: added mute list check using pubkey from JSON event in load_older"}
{"id":"nostrc-7vm","title":"Hashtag feed tabs broken: no content and close button doesn't work","description":"## Problem\n\nWhen clicking on a hashtag in a note:\n1. A new feed tab opens for that hashtag\n2. The tab shows nothing (no posts with that hashtag)\n3. Clicking the close (x) button on the hashtag tab does nothing - tab stays open\n\n## Expected Behavior\n\n1. Hashtag feed tab should query and display posts containing that hashtag\n2. Close button should close the tab and return to previous view\n\n## Investigation Areas\n\n- Check hashtag click handler (what subscription/query is created?)\n- Check tab close button signal connection\n- Look at feed tab lifecycle management","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T02:00:52.361696-08:00","created_by":"mayor","updated_at":"2026-01-30T02:08:25.24348-08:00","closed_at":"2026-01-30T02:08:25.243482-08:00"}
{"id":"nostrc-8","title":"NIP-17: Private Direct Messages","description":"Implement encrypted private direct messages following NIP-17 specification with gift-wrap encryption.\n\n## Overview\nNIP-17 provides true private messaging with:\n- Layered encryption (seal + gift wrap)\n- Sender anonymity via random keys\n- Deniability (unsigned inner messages)\n- Group chat support\n\n## Event Kinds\n- Kind 14: Chat message (inner, unsigned)\n- Kind 15: File message (inner, unsigned)\n- Kind 13: Seal (encrypted kind 14/15, signed by sender)\n- Kind 1059: Gift wrap (encrypted seal, signed by random key)\n- Kind 10050: DM relay preferences\n\n## Key Features Needed\n1. NIP-44 encryption implementation\n2. Gift wrap creation for each recipient\n3. Gift wrap decryption and verification\n4. DM inbox UI with conversation threading\n5. DM relay preference management\n6. File attachment support (kind 15)\n\n## Security Considerations\n- Verify kind 13 pubkey matches kind 14 pubkey\n- Randomize created_at timestamps (up to 2 days)\n- Store sender's gift wrap for backup/recovery\n- Support disappearing messages (optional)","status":"closed","priority":1,"issue_type":"task","assignee":"nostrc/bruce","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-02-08T03:24:51.958676-08:00","closed_at":"2026-02-08T03:24:51.958676-08:00","close_reason":"Closed","labels":["encryption","messaging","nip-17"]}
{"id":"nostrc-84z","title":"Package: macOS DMG installer","description":"## Goal\n\nCreate macOS .dmg disk image with drag-and-drop installation.\n\n## Tasks\n\n1. Create app bundle\n   - Gnostr.app structure\n   - Info.plist with metadata\n   - Bundle all dylibs/frameworks\n   - Code signing\n\n2. Create DMG\n   - Background image with instructions\n   - Symlink to /Applications\n   - DMG styling/layout\n\n3. Notarization\n   - Apple Developer account\n   - Notarize with `xcrun notarytool`\n   - Staple notarization ticket\n\n4. CI workflow (macos-latest)\n   - Build app bundle\n   - Create DMG with create-dmg\n   - Sign and notarize\n   - Upload as release artifact\n\n## Requirements\n- Apple Developer account for signing\n- Stored credentials in GitHub secrets","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T11:00:04.081645-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:00.216224-08:00","closed_at":"2026-01-30T12:22:00.216224-08:00","close_reason":"CI job added: build-macos-signer-dmg creates DMG using existing packaging scripts","labels":["deployment","macos"],"dependencies":[{"issue_id":"nostrc-84z","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.397605-08:00","created_by":"mayor"}]}
{"id":"nostrc-89c","title":"Build break: libpeas.h not found - dependency not added to CMake","description":"## Error\n\nWrong API - using libpeas-1.x functions with libpeas-2.\n\n```\nerror: implicit declaration of function 'peas_engine_get_plugin_list'\n```\n\n## Root Cause\n\nCode uses libpeas-1.x API but we link against libpeas-2. Key changes:\n- `peas_engine_get_plugin_list()` is GONE\n- libpeas-2 uses GListModel, not GList\n- PeasPluginInfo is now a GObject\n\n## Fix\n\nSee migration guide: https://gnome.pages.gitlab.gnome.org/libpeas/libpeas-2/migrating-1to2.html\n\nReplace:\n```c\n// OLD (libpeas-1.x) - WRONG\nconst GList *plugins = peas_engine_get_plugin_list(engine);\n\n// NEW (libpeas-2) - CORRECT\nGListModel *plugins = peas_engine_get_plugin_list(engine); // or use property\nguint n = g_list_model_get_n_items(plugins);\nfor (guint i = 0; i \u003c n; i++) {\n  PeasPluginInfo *info = g_list_model_get_item(plugins, i);\n  // ...\n  g_object_unref(info);\n}\n```\n\nFiles to fix: gnostr-plugin-manager.c lines 171, 370, 422","status":"closed","priority":0,"issue_type":"bug","assignee":"boris","created_at":"2026-01-30T15:03:22.124246-08:00","created_by":"mayor","updated_at":"2026-01-30T16:10:38.819924-08:00","closed_at":"2026-01-30T16:08:00.820712-08:00","close_reason":"Closed"}
{"id":"nostrc-8cj","title":"Video player controls should only appear on mouseover","description":"Video player controls are always visible. Should only appear on hover for cleaner UX.\n\n**Current:** Controls always displayed on video\n**Expected:** Controls hidden by default, appear on mouseover, fade out after timeout\n\n**Implementation:**\n- Add hover event handlers to video widget\n- Show controls overlay on mouse enter\n- Hide controls on mouse leave (with short delay)\n- Consider touch: tap to show, auto-hide after timeout\n\n**Reference:** Standard video player UX (YouTube, Vimeo, etc.)","status":"closed","priority":3,"issue_type":"bug","assignee":"barry","created_at":"2026-01-31T17:07:09.18696-08:00","created_by":"mayor","updated_at":"2026-01-31T17:55:40.420149-08:00","closed_at":"2026-01-31T17:55:40.420149-08:00","close_reason":"Completed by barry"}
{"id":"nostrc-8zpc","title":"Console spam: envelope compact parse failed: truncated input","description":"STILL BROKEN. Boris fixed the deadlock (go_channel_try_send) but the truncated input parse failure itself persists. Offset 13 suggests messages are being split mid-frame or the compact parser is receiving incomplete WebSocket messages. This is likely breaking NIP-66 relay discovery (nostrc-ns2k) because relay responses are silently dropped after parse failure. Need to fix the actual parsing, not just prevent the deadlock. Investigate: (1) Are WebSocket frames being fragmented and the reassembly is broken? (2) Is go_channel_try_send now DROPPING messages that should be queued? (3) Is the compact parser not handling multi-frame messages?","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/boris","created_at":"2026-02-08T13:57:27.010325-08:00","created_by":"mayor","updated_at":"2026-02-08T15:27:51.873621-08:00","closed_at":"2026-02-08T15:27:51.873621-08:00","close_reason":"Root cause: rx_buffer_size was 1024 bytes, fragmenting messages \u003e1KB. Boris fixed: 128KB rx buffer + per-connection reassembly buffer + retry on channel-full. Commit 66e9a6e","dependencies":[{"issue_id":"nostrc-8zpc","depends_on_id":"nostrc-j6h1","type":"blocks","created_at":"2026-02-08T14:02:05.258659-08:00","created_by":"mayor"}]}
{"id":"nostrc-9","title":"Implement NIP-44 encryption/decryption","description":"Implement NIP-44 encryption algorithm for private message content.\n\n## Technical Requirements\n\n### NIP-44 Overview\nNIP-44 is the current encryption standard using:\n- XChaCha20-Poly1305 for encryption\n- HKDF for key derivation\n- Proper padding to hide message length\n\n### Key Derivation\n1. Perform ECDH: shared_point = private_key * public_key\n2. Use HKDF to derive conversation key\n3. Generate random nonce for each message\n\n### Encryption Process\n1. Pad plaintext to hide length\n2. Derive encryption key from conversation key + nonce\n3. Encrypt with XChaCha20-Poly1305\n4. Format: version || nonce || ciphertext || mac\n5. Base64 encode result\n\n### Decryption Process\n1. Base64 decode\n2. Extract version, nonce, ciphertext, mac\n3. Derive decryption key\n4. Verify MAC and decrypt\n5. Remove padding\n\n## Implementation\n```c\n// API\nchar* nip44_encrypt(const char *plaintext, \n                    const uint8_t *sender_privkey,\n                    const uint8_t *receiver_pubkey);\n\nchar* nip44_decrypt(const char *ciphertext,\n                    const uint8_t *receiver_privkey, \n                    const uint8_t *sender_pubkey);\n```\n\n## Files to Create\n- apps/gnostr/src/crypto/nip44.c\n- apps/gnostr/src/crypto/nip44.h\n\n## Dependencies\n- libsodium or similar for XChaCha20-Poly1305\n- HKDF implementation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T00:00:00Z","updated_at":"2026-01-19T13:17:07.85156-08:00","closed_at":"2026-01-19T13:17:07.85156-08:00","close_reason":"Already implemented in libnostr","labels":["crypto","nip-44","security"]}
{"id":"nostrc-95c","title":"Surface relay OK/CLOSED/NOTICE message details in logging","description":"Per NIP-01, relays can provide additional information in their responses:\n\n- **OK**: `[\"OK\", \u003cevent_id\u003e, \u003ctrue|false\u003e, \u003cmessage\u003e]` - success/failure reason\n- **CLOSED**: `[\"CLOSED\", \u003csubscription_id\u003e, \u003cmessage\u003e]` - why subscription was closed\n- **NOTICE**: `[\"NOTICE\", \u003cmessage\u003e]` - human-readable messages\n\n**Current behavior:** These messages may be parsed but the detail strings aren't logged.\n\n**Requested behavior:** Log the message/reason field at appropriate log levels:\n- OK with false: WARN level with reason\n- CLOSED: INFO or WARN with reason\n- NOTICE: INFO level with message\n\n**Benefits:**\n- Aids debugging relay issues\n- Surfaces rate limiting, auth required, etc.\n- Helps diagnose why events fail to publish\n\n**Files likely involved:**\n- Relay message parsing/handling code\n- nostr_simple_pool.c or equivalent","status":"closed","priority":3,"issue_type":"feature","assignee":"bruce","created_at":"2026-01-31T15:28:54.153597-08:00","created_by":"mayor","updated_at":"2026-01-31T16:25:22.509597-08:00","closed_at":"2026-01-31T16:25:22.509597-08:00","close_reason":"Added logging for relay NOTICE, CLOSED, and OK failure messages at appropriate levels."}
{"id":"nostrc-9bn","title":"GSettings schema crash: org.gnostr.Client not installed","description":"App aborts on startup with 'Settings schema org.gnostr.Client is not installed' unless GSETTINGS_SCHEMA_DIR is manually set. Need to compile and install the schema during build, or add runtime schema discovery fallback.","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T12:34:14.702005-08:00","created_by":"mayor","updated_at":"2026-02-08T12:43:56.523021-08:00","closed_at":"2026-02-08T12:43:56.523021-08:00","close_reason":"Closed"}
{"id":"nostrc-9pj1","title":"Profile viewer Follows tab doesn't work","description":"The Follows tab in the profile viewer is non-functional. Likely fails to fetch or render the list of followed users.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/brett","created_at":"2026-02-08T13:56:09.151453-08:00","created_by":"mayor","updated_at":"2026-02-08T17:28:35.033852-08:00","closed_at":"2026-02-08T17:28:35.033852-08:00","close_reason":"Closed"}
{"id":"nostrc-9z3","title":"Migrate NIP-57 zaps to plugin","description":"## Goal\n\nMigrate NIP-57 (Lightning Zaps) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip57/` - library code for zap requests/receipts\n- `apps/gnostr/src/ui/gnostr-zap-dialog.c` - zap dialog UI\n- Zap button in note cards\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip57-zaps/`\n2. Move zap request/receipt parsing\n3. Move LNURL fetch logic\n4. Register event handlers:\n   - Kind 9734 (zap request)\n   - Kind 9735 (zap receipt)\n5. Add UI hooks for:\n   - Zap button on notes\n   - Zap dialog\n   - Zap receipt display\n   - Zap statistics\n6. Settings:\n   - Default zap amount\n   - Custom amounts presets\n   - Show zap button toggle\n\n## Complexity Notes\n- Requires NWC integration (NIP-47) for sending\n- LNURL callback handling\n- Real-time zap receipt subscription\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete\n- Consider after NIP-25 as learning experience","status":"closed","priority":3,"issue_type":"task","assignee":"barry","created_at":"2026-01-30T09:26:48.735638-08:00","created_by":"mayor","updated_at":"2026-01-31T19:07:33.351129-08:00","closed_at":"2026-01-31T19:07:33.351129-08:00","close_reason":"NIP-57 zaps plugin scaffolding complete - commit b15f5da. TODOs tracked in issue description.","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-9z3","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T09:27:00.965351-08:00","created_by":"mayor"},{"issue_id":"nostrc-9z3","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T09:27:01.03271-08:00","created_by":"mayor"},{"issue_id":"nostrc-9z3","depends_on_id":"nostrc-y9f","type":"blocks","created_at":"2026-01-30T09:27:01.27696-08:00","created_by":"mayor"}]}
{"id":"nostrc-a7h","title":"Package: Fedora/RHEL .rpm","description":"## Goal\n\nCreate CI workflow to build .rpm packages for Fedora and RHEL-based distros.\n\n## Tasks\n\n1. Create RPM spec file\n   - BuildRequires for dependencies\n   - Proper macros for GTK4 app\n\n2. GitHub Actions workflow\n   - Build on Fedora container\n   - Test installation\n   - Upload as release artifact\n\n3. Target distributions\n   - Fedora 39, 40\n   - RHEL 9 / Rocky Linux 9 / AlmaLinux 9\n\n## Optional\n- Submit to Fedora COPR for easier user installation","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:31.055785-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:09.314394-08:00","closed_at":"2026-01-30T12:22:09.314394-08:00","close_reason":"CI job already exists: build-rpm creates .rpm packages using fpm","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-a7h","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:24.913222-08:00","created_by":"mayor"}]}
{"id":"nostrc-aak","title":"Memory leak: connection_context not freed in relay.c","description":"\n## Location\nlibnostr/src/relay.c:256-265\n\n## Description\nThe code explicitly acknowledges a memory leak where `relay-\u003epriv-\u003econnection_context` is intentionally never freed:\n\n```c\n// IMPORTANT: Do NOT free connection_context here!\n// The done channel inside it may still be referenced by go_select in message_loop\n// even after go_wait_group_wait returns (due to the 1ms polling sleep in go_select).\n// Instead, we leave it allocated - it will be cleaned up when the process exits.\n// This is a small, bounded leak that prevents use-after-free crashes.\n// TODO: Implement proper reference counting for contexts to fix this properly.\n```\n\n## Impact\nEach relay connection leaks a GoContext structure. For long-running clients connecting to many relays, this can accumulate.\n\n## Fix Suggestion\nImplement proper reference counting for GoContext to track outstanding references from go_select operations. Only free when refcount reaches zero.\n","status":"closed","priority":1,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T10:29:48.318055-08:00","created_by":"nostrc/crew/billy","updated_at":"2026-01-29T11:06:01.495295-08:00","closed_at":"2026-01-29T11:06:01.495295-08:00","close_reason":"Implemented reference counting for GoContext to safely free connection_context","labels":["memory-leak"]}
{"id":"nostrc-ajk","title":"timeline load_older emits incorrect items_changed after sorting","description":"After sorting in load_older() (line 581), emits items_changed(len-added, 0, added). Wrong because sorted items may have moved. Should emit full replace (0, old_count, new_count) like debounced updates do. File: apps/gnostr/src/model/gn-timeline-model.c:579-583","status":"closed","priority":1,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T09:43:17.463542-08:00","created_by":"flotilla_budabit/crew/gus","updated_at":"2026-01-29T10:33:42.155805-08:00","closed_at":"2026-01-29T10:33:42.155805-08:00","close_reason":"Fixed: emit full replace (0, old_count, new_count) after sorting instead of incorrect position-based signal"}
{"id":"nostrc-akyz","title":"Add defensive npub/nprofile-to-hex conversion at all pubkey entry points","description":"Scan the entire codebase for functions that take a hex pubkey as a parameter or use pubkeys internally. Add a defensive check at the top of each function: if the value starts with 'npub1' or 'nprofile1', decode it to hex using gnostr_nip19_decode before proceeding. This makes these functions robust against being passed the wrong format. Key areas to scan: (1) gobject/ layer - all GObject methods taking pubkey_hex params (2) apps/gnostr/src/ - UI handlers, profile pane, timeline, DM service (3) storage/NDB lookup functions (4) relay subscription/filter builders. Consider creating a utility function like nostr_ensure_hex_pubkey(const char *input) that returns hex whether given hex, npub, or nprofile. Use this at all entry points.","status":"closed","priority":2,"issue_type":"feature","assignee":"nostrc/billy","created_at":"2026-02-08T15:12:26.32269-08:00","created_by":"mayor","updated_at":"2026-02-08T17:28:29.886784-08:00","closed_at":"2026-02-08T17:28:29.886784-08:00","close_reason":"Closed","dependencies":[{"issue_id":"nostrc-akyz","depends_on_id":"nostrc-daj1","type":"blocks","created_at":"2026-02-08T15:12:35.182778-08:00","created_by":"mayor"}]}
{"id":"nostrc-ama","title":"Eliminate startup timeout in gn-timeline-model.c","description":"## Problem\nThe gn-timeline-model.c had a 500ms INITIAL_LOAD_TIMEOUT_MS timeout that was a hacky workaround for batch mode management during initial load. This caused:\n1. Artificial 500ms delay on every startup regardless of actual data arrival time\n2. Unreliable behavior on slow networks where timeout could fire before data arrived\n3. Poor UX - users see empty screen for 500ms even when data is available immediately\n\n## Root Cause\nBatch mode (which suppresses items_changed signals to prevent widget recycling storms) was ended via a fixed timeout rather than reactively when data actually arrives.\n\n## Solution\nReplaced the timeout with a reactive idle callback approach:\n1. When first notes arrive in on_sub_timeline_batch(), schedule an idle callback\n2. The idle callback (G_PRIORITY_LOW) ends batch mode after GTK processes pending events\n3. No artificial delays - batch mode ends as soon as data is ready\n\n## Changes Made\n- Removed INITIAL_LOAD_TIMEOUT_MS define (was 500ms)\n- Removed on_initial_load_timeout() function\n- Added on_end_batch_mode_idle() function\n- Added logic in on_sub_timeline_batch() to schedule idle callback when first notes arrive\n\n## Principle\nTimeouts are almost never correct in reactive UI. Use signals, idle callbacks, or proper async patterns instead. A timeout is just \"give up trying to understand the event flow and wait arbitrarily.\"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T23:46:32.900176-08:00","created_by":"mayor","updated_at":"2026-01-29T23:46:36.778247-08:00","closed_at":"2026-01-29T23:46:36.778247-08:00","close_reason":"Fixed: Replaced 500ms INITIAL_LOAD_TIMEOUT_MS with reactive g_idle_add callback. Batch mode now ends immediately when first notes arrive, not after arbitrary delay."}
{"id":"nostrc-b0h","title":"Audit and eliminate hacky g_timeout_add calls across codebase","description":"Timeouts are almost never the right solution in reactive UI development. They indicate a failure to properly understand the event/signal flow. Audit the entire codebase for g_timeout_add usage and eliminate them by:\n\n1. Using g_idle_add for 'wait for next iteration' cases\n2. Connecting to proper signals/callbacks instead of arbitrary delays\n3. Using GtkAdjustment::value-changed, GListModel::items-changed, etc.\n4. For animations, use proper GTK animation APIs\n\nKnown bad patterns to find:\n- g_timeout_add with small values (50-500ms) as 'safety delays'\n- Timeouts waiting for 'GTK to finish processing'\n- Polling loops disguised as timeouts\n- Retry logic that should use proper error handling\n\nReplace with reactive patterns - signals, idle callbacks, or proper async/await style with GTask.","status":"closed","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-01-29T16:48:31.938425-08:00","created_by":"mayor","updated_at":"2026-01-29T19:57:30.865127-08:00","closed_at":"2026-01-29T19:57:30.865127-08:00","close_reason":"Audit complete. Fixed critical bug in gnostr-nip7d-thread-view.c (wrong function signature passed to timeout). Replaced g_timeout_add(0) with g_idle_add in main-window.c. Documented legitimate timeout usages. See commit a3365c6 in refinery/rig."}
{"id":"nostrc-b27","title":"Package: AppImage","description":"## Goal\n\nCreate portable AppImage for Linux that runs on any distro without installation.\n\n## Tasks\n\n1. Create AppDir structure\n   - Bundle all dependencies\n   - AppRun script\n   - .desktop file\n   - Icon\n\n2. Use linuxdeploy or appimagetool\n   - GTK4 plugin for proper theming\n   - GStreamer plugins bundled\n\n3. GitHub Actions workflow\n   - Build on oldest supported Ubuntu\n   - Create AppImage\n   - Upload as release artifact\n\n## Benefits\n- No installation required\n- Single file distribution\n- Works on any Linux","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:37.972044-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:11.149135-08:00","closed_at":"2026-01-30T12:22:11.149135-08:00","close_reason":"CI jobs already exist: build-appimage, build-appimage-gnostr, build-appimage-daemon-tcp","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-b27","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.064762-08:00","created_by":"mayor"}]}
{"id":"nostrc-b3b0","title":"Systematic fix: Pango SEGV prevention in NoteCardRow lifecycle","description":"Audit found 4 HIGH-severity sites that will SEGV under the same pattern as nostrc-5g2n.\nRoot cause: NoteCardRow disposal without prepare_for_unbind ‚Üí PangoLayout references freed PangoContext ‚Üí SEGV.\n\nSystematic fix: \n1. Add defensive label clearing at TOP of NoteCardRow dispose (before gtk_widget_dispose_template)\n2. Fix all 4 missing prepare_for_unbind sites\n3. Fix signal handler leak in notification-row","status":"open","priority":0,"issue_type":"epic","created_at":"2026-02-11T00:13:17.456298-08:00","created_by":"mayor","updated_at":"2026-02-11T00:13:17.456298-08:00"}
{"id":"nostrc-b6x","title":"Migrate NIP-98 HTTP Auth to plugin","description":"## Goal\n\nMigrate NIP-98 (HTTP Auth) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip98/` - HTTP auth event creation/verification\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip98-httpauth/`\n2. Move HTTP auth implementation\n3. Register kind 27235 handler\n4. Plugin API:\n   ```c\n   char* gnostr_nip98_create_auth_header(plugin, url, method);\n   gboolean gnostr_nip98_verify_auth(plugin, auth_header, url, method);\n   ```\n5. Integration points:\n   - Hook into HTTP requests for Blossom uploads\n   - Hook into media server auth\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"closed","priority":3,"issue_type":"task","assignee":"brett","created_at":"2026-01-30T10:20:37.530521-08:00","created_by":"mayor","updated_at":"2026-01-31T13:41:18.935298-08:00","closed_at":"2026-01-31T13:41:18.935298-08:00","close_reason":"Committed by brett: 02d4a50","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-b6x","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T10:20:42.448929-08:00","created_by":"mayor"},{"issue_id":"nostrc-b6x","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T10:20:42.518932-08:00","created_by":"mayor"}]}
{"id":"nostrc-bhm","title":"Iteration 2: Batch event processing on main thread","description":"## Goal\n\nSecond iteration: reduce per-event overhead by batch processing.\n\n## Current Flow\n```\nFor each event:\n  1. Dequeue single event\n  2. Emit signal\n  3. GTK processes signal\n  4. Return to main loop\n  5. Repeat\n```\n\n## Proposed Flow\n```\n1. Dequeue up to N events (batch)\n2. Process batch:\n   - Filter duplicates within batch\n   - Sort by created_at\n   - Emit batch signal OR emit individual signals in tight loop\n3. Return to main loop\n```\n\n## Implementation\n\n### Option A: Batch signal\n```c\n// New signal\ng_signal_emit(pool, signals[SIGNAL_EVENTS_BATCH], 0, events_array, count);\n\n// Handler processes array\nstatic void on_events_batch(GnostrSimplePool *pool, GPtrArray *events, gpointer data) {\n  for (guint i = 0; i \u003c events-\u003elen; i++) {\n    process_event(g_ptr_array_index(events, i));\n  }\n}\n```\n\n### Option B: Tight loop emission\n```c\n// Dequeue batch, emit in loop without returning to main loop\nGPtrArray *batch = dequeue_batch(queue, 100);\nfor (guint i = 0; i \u003c batch-\u003elen; i++) {\n  g_signal_emit(pool, signals[SIGNAL_EVENT], 0, g_ptr_array_index(batch, i));\n}\ng_ptr_array_unref(batch);\n```\n\n## Batch Size Tuning\n\n- Start with batch_size = 50\n- Tune based on metrics:\n  - If latency low, increase batch size\n  - If UI stutters, decrease batch size\n\n## Success Criteria\n\n- 2-5x improvement in throughput (events/sec)\n- No UI responsiveness regression\n- Drop rate stays \u003c 0.1%","notes":"Implemented batch event processing (Iteration 2):\n\n## Changes\n- Added configurable batch size (default=50, env var NOSTR_BATCH_SIZE)\n- Added emit_batch_sorted() that sorts events by created_at before emission\n- Updated subscribe_many_thread to respect batch size limit\n- Updated paginate_with_interval_thread to use sorted emission\n- Added batch metrics: batch_emitted, batch_events_total\n\n## Behavior\n- Events collected up to max_batch_size before emission\n- Batches sorted by created_at (oldest first) for chronological processing\n- Prevents huge batches that could cause UI stuttering\n- Batch size tunable via NOSTR_BATCH_SIZE env var (10-500)\n\n## Limitations\n- No dynamic batch size tuning based on latency (future work)\n- UI responsiveness testing needed to validate default size\n\nAll subscription tests pass.","status":"closed","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-01-30T11:28:28.354229-08:00","created_by":"mayor","updated_at":"2026-01-30T17:06:36.423099-08:00","closed_at":"2026-01-30T17:06:36.423099-08:00","close_reason":"Closed","labels":["performance"],"dependencies":[{"issue_id":"nostrc-bhm","depends_on_id":"nostrc-pvy","type":"parent-child","created_at":"2026-01-30T11:28:42.046488-08:00","created_by":"mayor"},{"issue_id":"nostrc-bhm","depends_on_id":"nostrc-3g8","type":"blocks","created_at":"2026-01-30T11:28:42.23033-08:00","created_by":"mayor"}]}
{"id":"nostrc-bkor","title":"Login button does not navigate to user's own profile","description":"CRITICAL REGRESSION: Clicking the login/profile button does not display the user's own profile. This is a core UX flow - the user clicks their avatar/login button and expects to see their profile. This has been reported multiple times and is still broken. Investigate the click handler, profile view navigation, and ensure the logged-in user's pubkey is correctly passed to the profile viewer.","status":"closed","priority":0,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T14:00:04.209586-08:00","created_by":"mayor","updated_at":"2026-02-08T14:53:49.435789-08:00","closed_at":"2026-02-08T14:53:49.435789-08:00","close_reason":"ROOT CAUSE: init ordering in gnostr_main_window_init - start_gift_wrap_subscription set user_pubkey_hex, then subsequent init block wiped it to NULL. Fixed by barry, reordered init. Commit f27bd46"}
{"id":"nostrc-bn3","title":"Deployment: CI-built packages for all platforms","description":"## Overview\n\nSet up CI pipelines to automatically build and publish packages for all major platforms and package formats.\n\n## Goals\n\n- Automated builds on every release tag\n- Reproducible builds\n- Signed packages where applicable\n- Published to appropriate repositories/stores\n\n## Target Platforms\n\n### Linux\n- deb (Debian/Ubuntu)\n- rpm (Fedora/RHEL)\n- Flatpak (Flathub)\n- AppImage (portable)\n- Arch Linux (AUR)\n- tarball (generic)\n- Snap (Ubuntu Store)\n\n### macOS\n- Homebrew formula\n- DMG installer\n- tarball\n\n### Windows\n- MSI installer\n- MSIX (Windows Store)\n\n## CI Infrastructure\n\n- GitHub Actions workflows\n- Build matrix for multiple distros/versions\n- Artifact signing\n- Release automation\n\n## Success Criteria\n\n- All package formats build successfully in CI\n- Packages install and run correctly on target platforms\n- Automated publishing to package repositories\n- Documentation for manual installation","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-30T10:59:17.968765-08:00","created_by":"mayor","updated_at":"2026-01-30T12:25:17.711545-08:00","closed_at":"2026-01-30T12:25:17.711545-08:00","close_reason":"All child tasks complete. CI now builds packages for: Linux (deb, rpm, flatpak, appimage, snap, tarball, AUR), macOS (DMG, Homebrew, tarball), Windows (NSIS installer). Release workflow updated to include all artifacts.","labels":["ci","deployment","epic"]}
{"id":"nostrc-bv7","title":"Migrate non-core NIPs to libpeas plugin architecture","description":"## Overview\n\nMigrate non-core NIPs from built-in implementations to a libpeas-based plugin system. This enables:\n- Modular NIP support that can be enabled/disabled\n- Third-party NIP implementations\n- Smaller core binary\n- Easier NIP development and testing\n\n## Phases\n\n### Phase 1: Plugin Infrastructure\n- Add libpeas dependency (greenfield integration)\n- Design plugin API/ABI for stability\n- Create plugin loader/manager\n- Plugin settings integration\n- Plugin discovery and loading\n\n### Phase 2: Core vs Plugin Classification  \n- Agents should reference docs/nips for NIP descriptions when deciding\n- Core = required for basic social/messaging functionality\n- Plugin = optional features, wallet integrations, specialized protocols\n\n### Phase 3: Iterative Migration\n- Migrate each plugin-candidate NIP one at a time\n- Start with simpler NIPs\n- Progress to complex NIPs (NIP-57 zaps, NIP-47 NWC)\n\n## Core NIPs (stay built-in)\nBasic protocol:\n- NIP-01: Basic protocol, events, tags\n- NIP-02: Contact list (follows)\n- NIP-10: Text note references\n- NIP-11: Relay information document\n- NIP-19: bech32-encoded entities\n- NIP-21: nostr: URI scheme\n- NIP-42: Authentication of clients to relays\n- NIP-44: Versioned encryption\n- NIP-65: Relay list metadata\n\nIdentity \u0026 verification:\n- NIP-05: DNS-based verification\n- NIP-39: External identities\n\nContent types:\n- NIP-09: Event deletion\n- NIP-12: Generic tag queries\n- NIP-14: Subject tag\n- NIP-18: Reposts\n- NIP-22: Event created_at limits\n- NIP-23: Long-form content\n- NIP-24: Extra metadata fields\n- NIP-25: Reactions\n- NIP-27: Text note references\n- NIP-31: Alt tag for unknown events\n- NIP-32: Labeling\n- NIP-36: Sensitive content\n- NIP-37: Draft events\n- NIP-38: User statuses\n- NIP-58: Badges\n\nSocial features:\n- NIP-28: Public chat\n- NIP-51: Lists\n- NIP-53: Live activities\n- NIP-59: Gift wrap\n\nDiscovery:\n- NIP-45: Event counts\n- NIP-66: Relay discovery\n- NIP-78: Application-specific data\n\nNote: This is a starter list. Agents should use docs/nips descriptions to make judgement calls on edge cases.\n\n## Plugin Candidates\nWallet \u0026 payments:\n- NIP-47: Nostr Wallet Connect\n- NIP-57: Lightning Zaps\n\nSigning \u0026 security:\n- NIP-46: Nostr Connect (remote signing)\n- NIP-49: Private key encryption\n- NIP-55: Android Signer Application\n\nMessaging:\n- NIP-17: Private Direct Messages (gift-wrapped DMs)\n\nSync:\n- NIP-77: Negentropy sync\n\nHTTP integration:\n- NIP-98: HTTP Auth\n\n## Plugin Capabilities\nPlugins can:\n1. **Event Handling** - Register handlers for specific event kinds\n2. **UI Extensions** - Add menu items, toolbar buttons, settings pages\n3. **Network Access** - Subscribe to relays, publish events\n4. **Storage** - Store/retrieve plugin-specific data\n5. **Settings** - Expose configurable options via GSettings\n\n## Success Criteria\n- Stable plugin API/ABI that won't break plugins on updates\n- All plugin candidates migrated\n- Bundled plugins work out of the box\n- Documentation for plugin developers","status":"in_progress","priority":2,"issue_type":"epic","assignee":"brett","created_at":"2026-01-30T09:26:01.15885-08:00","created_by":"mayor","updated_at":"2026-01-31T12:27:24.749028-08:00","labels":["architecture","epic"]}
{"id":"nostrc-bxh","title":"Integrate ndb_note_meta for per-note statistics","description":"ndb_note_meta supports per-note reaction counts, quote counts, reply counts, emoji breakdown as O(1) lookups. Currently 0% used - app does full filter scans instead. Implement: write metadata on reaction/zap/reply ingest, read via ndb_get_note_meta() instead of per-event filter queries. This is the single biggest optimization opportunity in the codebase.","status":"closed","priority":0,"issue_type":"task","assignee":"nostrc/bruce","created_at":"2026-02-07T17:20:17.147859-08:00","created_by":"mayor","updated_at":"2026-02-08T01:43:48.769509-08:00","closed_at":"2026-02-08T01:43:48.769509-08:00","close_reason":"Closed"}
{"id":"nostrc-bzlz","title":"harden-1: Fix show_toast unsafe timer in 6 dialogs","status":"open","priority":0,"issue_type":"bug","assignee":"barry","created_at":"2026-02-10T16:44:40.269975-08:00","created_by":"mayor","updated_at":"2026-02-10T16:44:40.269975-08:00"}
{"id":"nostrc-c7pa","title":"Invalid UTF-8 in hashtag breaks Pango markup","description":"Malformed nostr event hashtag with invalid UTF-8 (#\\xc2cB) passes through unsanitized to Pango markup parser. Sanitize UTF-8 in content renderer before passing to Pango.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-08T12:34:38.370251-08:00","created_by":"mayor","updated_at":"2026-02-08T12:50:53.567715-08:00","closed_at":"2026-02-08T12:50:53.567715-08:00","close_reason":"Closed"}
{"id":"nostrc-cbd","title":"Use-after-free in subscribe_many_thread accessing freed event","description":"## Crash\n\nheap-use-after-free in nostr_event_serialize_nip01_array (event.c:35)\n\n## Stack Trace\n\n```\nThread T19 (subscribe_many_thread) READ:\n#0 nostr_event_serialize_nip01_array event.c:35\n#1 nostr_event_get_id event.c:503\n#2 subscribe_many_thread nostr_simple_pool.c:480\n\nFreed by Thread T0 (main):\n#0 free\n#1 ptr_array_free\n#2 emit_events_on_main nostr_simple_pool.c:127\n\nAllocated by Thread T18:\n#0 malloc\n#1 nostr_event_new event.c:131\n#2 jansson_envelope_deserialize json.c:295\n#3 nostr_envelope_parse envelope.c:703\n#4 message_loop relay.c:734\n```\n\n## Root Cause\n\nClassic race condition:\n1. T18 (relay message loop) creates event, adds to queue\n2. T0 (main) processes queue in emit_events_on_main, FREES events\n3. T19 (subscribe thread) still accessing event to get ID for filtering\n\n## Additional Symptom\n\nMassive `[WARN][sub] event drop: queue full sid=4` spam - events produced faster than consumed, backpressure not handled properly.\n\n## Files Involved\n\n- libnostr/src/nostr_simple_pool.c:480 (subscribe_many_thread)\n- libnostr/src/nostr_simple_pool.c:127 (emit_events_on_main)\n- libnostr/src/event.c:35 (nostr_event_serialize_nip01_array)\n\n## Fix Needed\n\nEvent ownership model must be clarified:\n1. Who owns the event? The queue? The subscriber thread?\n2. Events should be ref-counted or copied before cross-thread access\n3. Don't free events while other threads may still reference them","status":"closed","priority":0,"issue_type":"bug","assignee":"billy","created_at":"2026-01-30T11:13:53.869738-08:00","created_by":"mayor","updated_at":"2026-01-31T14:00:57.978091-08:00","closed_at":"2026-01-31T14:00:57.978091-08:00","close_reason":"Fixed by event ID caching (commit 6533cd1) - nostr_event_get_id() now returns cached ID without serializing, eliminating the race condition","labels":["asan","crash","p0","threading"],"dependencies":[{"issue_id":"nostrc-cbd","depends_on_id":"nostrc-o56","type":"parent-child","created_at":"2026-01-30T11:13:58.684783-08:00","created_by":"mayor"}]}
{"id":"nostrc-cgbl","title":"Event content not rendered for some kind:1 notes","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/bruce","created_at":"2026-02-08T18:32:54.111719-08:00","created_by":"mayor","updated_at":"2026-02-08T19:24:54.264195-08:00","closed_at":"2026-02-08T19:24:54.264195-08:00","close_reason":"Same root cause as nostrc-bi8x, fixed in d297828 with NDB query retry"}
{"id":"nostrc-ch2v","title":"Implement NIP-51 user lists (mute, pin, bookmarks)","description":"NIP-51 defines parameterized replaceable lists for user curation:\n- Mute list (kind 10000): muted pubkeys, event IDs, words, hashtags\n- Pin list (kind 10001): pinned notes\n- Bookmarks (kind 10003): saved notes for later\n- Categorized bookmarks (kind 30003): named collections\n\nImplement:\n- Storage/query for list events\n- Mute filtering in timeline (hide muted authors/words/hashtags)\n- Bookmark action on notes (add/remove from kind 10003)\n- Bookmarks view to browse saved notes\n- Pin action for own profile\n- Mute action on profiles and notes","status":"in_progress","priority":2,"issue_type":"task","assignee":"nostrc/brett","created_at":"2026-02-08T12:55:27.453122-08:00","created_by":"mayor","updated_at":"2026-02-08T12:55:41.807667-08:00"}
{"id":"nostrc-csj","title":"P0 ASAN: note_embed use-after-free in prepare_for_unbind - need weak reference","description":"The prepare_for_unbind function at note_card_row.c:5520 calls GNOSTR_IS_NOTE_EMBED(self-\u003enote_embed) but the note_embed widget may have been freed by a GStreamer thread. The fix needs to either: (1) use g_object_add_weak_pointer for note_embed so it becomes NULL when freed, or (2) add a destroyed flag checked before accessing, or (3) clear the pointer in a destroy notify callback. Stack shows scroll_to_top_idle -\u003e trim_older -\u003e unbind -\u003e prepare_for_unbind trying to check note_embed after GStreamer freed it.","status":"closed","priority":0,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T15:53:15.767504-08:00","created_by":"mayor","updated_at":"2026-01-29T16:28:54.759116-08:00","closed_at":"2026-01-29T16:28:54.759116-08:00","close_reason":"Fixed: Removed unsafe type-checking macros from prepare_for_unbind. Initialize pointers to NULL in init(). Commit 5fedfe1."}
{"id":"nostrc-cz0","title":"Pango crash during label snapshot - NULL attribute in attr list","description":"Crash during rendering when Pango encounters NULL attribute.\n\n**Error:**\n```\nPango-CRITICAL: pango_attribute_copy: assertion 'attr != NULL' failed\nEXC_BAD_ACCESS (code=1, address=0x0)\n```\n\n**Stack:**\n```\n#0 affects_break_or_shape (libpango)\n#1 pango_attr_list_filter\n#2 pango_layout_check_lines\n#3 pango_layout_get_extents_internal\n#4 pango_layout_get_pixel_extents\n#5 gtk_label_get_layout_location\n#6 gtk_label_snapshot\n... (deep GTK widget snapshot chain)\n```\n\n**Root cause hypotheses:**\n1. Label text/attributes modified while rendering (race condition)\n2. Corrupted PangoAttrList with NULL entry\n3. Label created with invalid markup that produces NULL attr\n\n**Different from previous Pango bugs:**\n- nostrc-ipp: crash during dispose\n- nostrc-oa9: crash during dispose (og-preview)\n- THIS: crash during render/snapshot\n\n**Investigation:**\n- Find which label is being rendered\n- Check if label text is being updated from another thread\n- Verify PangoAttrList construction","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-31T16:01:04.082444-08:00","created_by":"mayor","updated_at":"2026-01-31T16:28:25.481499-08:00","closed_at":"2026-01-31T16:28:25.481499-08:00","close_reason":"Added disposed checks before label markup updates to prevent Pango crash"}
{"id":"nostrc-d6j","title":"Subscription/EOSE handling fundamentally broken - excessive hard timeouts","description":"Connected relays almost always send EOSE before the hard timeout, yet logs are flooded with warnings like:\n\n```\n[GOROUTINE] Hard timeout after 120003ms - some relays may not have sent EOSE (eosed=2/4)\n```\n\n**This is NOT a relay problem.** The frequency of these messages indicates a deep architectural issue with how the app handles events and subscriptions.\n\n**Possible causes to investigate:**\n1. EOSE responses being lost/dropped before reaching subscription tracker\n2. Race conditions in subscription state management\n3. Mismatch between subscription IDs sent vs tracked\n4. Events arriving but not being counted/acknowledged\n5. Thread synchronization issues in the pool (related to nostrc-sln?)\n\n**Impact:**\n- App thinks relays are unresponsive when they're not\n- 120+ second waits degrade UX\n- May cause cascading issues with event processing\n\n**Files to investigate:**\n- gobject/src/nostr_simple_pool.c (subscription handling)\n- Anywhere EOSE is parsed/handled\n- Subscription ID generation and tracking\n\n**Required:** Thorough audit of the subscription lifecycle from REQ to EOSE to CLOSE","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-31T13:34:36.477457-08:00","created_by":"mayor","updated_at":"2026-01-31T13:59:34.961538-08:00","closed_at":"2026-01-31T13:59:34.961538-08:00","close_reason":"Fixed by billy: 131970d - cleanup failed subscription fires"}
{"id":"nostrc-d6t","title":"Profile provider not thread-safe","description":"\n## Location\napps/gnostr/src/ui/gnostr-profile-provider.c\n\n## Description\nThe profile provider uses static global variables without mutex protection:\n\n```c\nstatic GHashTable *s_cache = NULL;\nstatic GQueue *s_lru = NULL;\nstatic GHashTable *s_lru_nodes = NULL;\nstatic guint s_cap = 0;\nstatic gboolean s_init = FALSE;\nstatic GnostrProfileProviderStats s_stats = {0};\n```\n\nFunctions like `gnostr_profile_provider_get()`, `lru_touch()`, `lru_evict()` all access these shared data structures without any locking.\n\n## Impact\nIf profile lookups happen from multiple threads (common in GTK applications with async operations), this can cause:\n- Hash table corruption\n- Double frees\n- Use-after-free crashes\n- Stats corruption\n\n## Fix Suggestion\nAdd a static GMutex and protect all cache operations with it. The cache-manager.c shows a good pattern with `g_mutex_lock/unlock`.\n","status":"closed","priority":1,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T10:30:07.142732-08:00","created_by":"nostrc/crew/billy","updated_at":"2026-01-29T11:06:02.952417-08:00","closed_at":"2026-01-29T11:06:02.952417-08:00","close_reason":"Added G_LOCK mutex protection to all profile provider operations","labels":["crash-risk","thread-safety"]}
{"id":"nostrc-daj1","title":"Profile viewer receives npub instead of hex pubkey - never loads profile","description":"CONFIRMED: The profile pane is being passed an npub (bech32) instead of a 64-char hex pubkey. The user can see it says it is loading the npub. The profile never loads because all NDB lookups and relay queries use hex keys. Barry fixed the init ordering (f27bd46) which prevented user_pubkey_hex from being NULL, but the value stored may still be npub format. Check: (1) on_signer_state_changed at line 3878 - the npub-to-hex conversion via gnostr_nip19_decode may be failing silently (2) client_settings_get_current_npub returns npub but get_current_user_pubkey_hex is supposed to convert it - verify it works (3) start_gift_wrap_subscription calls get_current_user_pubkey_hex which may return the npub unconverted (4) gnostr_profile_pane_set_pubkey needs to reject or convert npub format. The user has been saying this for cycles. FIX THE CONVERSION.","status":"closed","priority":0,"issue_type":"bug","assignee":"nostrc/barry","created_at":"2026-02-08T15:02:07.273506-08:00","created_by":"mayor","updated_at":"2026-02-08T15:30:52.421897-08:00","closed_at":"2026-02-08T15:30:52.421897-08:00","close_reason":"Fixed by barry: multiple paths passing npub instead of hex. Added fallbacks in on_login_signed_in, on_view_profile_requested, get_current_user_pubkey_hex, session restore, and validation in profile pane. Commit ad537fa"}
{"id":"nostrc-dkx","title":"Log subscription message count before EOSE","description":"Add logging to track how many messages each subscription receives before the EOSE (End of Stored Events) marker. This helps with debugging and understanding relay response sizes.\n\nImplementation:\n- In the relay pool or subscription handler, maintain a counter per subscription\n- Increment counter for each EVENT message received\n- When EOSE is received, log the subscription ID and message count\n- Example log: '[RELAY_POOL] Subscription abc123 received 42 events before EOSE'\n\nFiles likely to modify:\n- libnostr/src/relay_pool.c or similar relay handling code\n- Look for where EOSE is currently logged","status":"closed","priority":2,"issue_type":"feature","assignee":"billy","created_at":"2026-01-31T20:23:20.046122-08:00","created_by":"mayor","updated_at":"2026-01-31T20:33:35.933183-08:00","closed_at":"2026-01-31T20:33:35.933183-08:00","close_reason":"Added logging in subscription.c:dispatch_eose - logs event count when EOSE received"}
{"id":"nostrc-dqwq","title":"Phase 2: Bind Path Optimization","description":"Optimize the GtkListView factory bind path. Targets: fast scroll stutter, bidirectional scroll cost. Depends on Phase 1 (80c152eb) being complete.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-02-10T22:38:59.482163-08:00","created_by":"mayor","updated_at":"2026-02-10T22:57:17.107503-08:00","closed_at":"2026-02-10T22:57:17.107503-08:00","close_reason":"Phase 2 complete: cached render result (2A), deferred media widgets (2B), direct accessors (2C)"}
{"id":"nostrc-dqwq.1","title":"2A: Cache rendered content on GnNostrEventItem","description":"Every bind call re-renders Pango markup from raw content, even when the same item was previously bound. Note content is immutable once ingested.\n\n**Fix**: Add fields to GnNostrEventItem for the unified GnContentRenderResult (from Phase 1B commit 80c152eb). On first bind, render and cache. On rebind, use cached result directly. The item struct already has cached_event_id, cached_pubkey, cached_content ‚Äî same pattern.\n\n**Files**:\n- apps/gnostr/src/model/gn-nostr-event-item.c ‚Äî add cached render result field\n- apps/gnostr/src/model/gn-nostr-event-item.h ‚Äî new field declaration\n- apps/gnostr/src/ui/note_card_row.c ‚Äî use cached result on rebind\n\n**Validation**: Bidirectional scroll over 100 items. Previously-seen items should skip gnostr_render_content() entirely.","status":"closed","priority":1,"issue_type":"task","assignee":"barry","created_at":"2026-02-10T22:39:53.638362-08:00","created_by":"mayor","updated_at":"2026-02-10T22:51:15.722867-08:00","closed_at":"2026-02-10T22:51:15.722867-08:00","close_reason":"Cached GnContentRenderResult on GnNostrEventItem. Lazy render on first access, cached on rebind. Applied to all 3 factory bind paths (timeline-view, thread-view, note-card-factory). Unblocks nostrc-dqwq.2 and nostrc-sbqe.1.","dependencies":[{"issue_id":"nostrc-dqwq.1","depends_on_id":"nostrc-dqwq","type":"parent-child","created_at":"2026-02-10T22:39:53.639853-08:00","created_by":"mayor"}]}
{"id":"nostrc-dqwq.2","title":"2B: Defer media widget creation to map signal","description":"Lines 2863-2902 of note_card_row.c create GtkPicture and GnostrVideoPlayer (heavy GStreamer init) synchronously during bind for ALL media URLs, including items in GTK's buffer zone that may never become visible.\n\n**Fix**: During bind, store media URLs from cached render result (2A) but only create lightweight placeholder widgets (e.g. a GtkBox with fixed size). On GtkWidget::map signal (widget becomes visible), create actual media widgets. Items bound in GTK's buffer zone but never scrolled into view skip media creation entirely.\n\n**Files**:\n- apps/gnostr/src/ui/note_card_row.c ‚Äî split media creation into placeholder (bind) + real (map)\n\n**Depends on**: 2A (cached render result provides media URLs without re-parsing)\n\n**Validation**: Fast scroll past media-heavy notes. GStreamer init should only happen for notes that enter the viewport.","status":"closed","priority":1,"issue_type":"task","assignee":"billy","created_at":"2026-02-10T22:40:08.529542-08:00","created_by":"mayor","updated_at":"2026-02-10T22:57:07.288731-08:00","closed_at":"2026-02-10T22:57:07.288731-08:00","close_reason":"Deferred media widget creation from bind to GtkWidget::map signal. PendingMediaItem structs store URL metadata. Media widgets only created for visible items. Cleanup in prepare_for_unbind, dispose, finalize.","dependencies":[{"issue_id":"nostrc-dqwq.2","depends_on_id":"nostrc-dqwq","type":"parent-child","created_at":"2026-02-10T22:40:08.53157-08:00","created_by":"mayor"},{"issue_id":"nostrc-dqwq.2","depends_on_id":"nostrc-dqwq.1","type":"blocks","created_at":"2026-02-10T22:41:41.351524-08:00","created_by":"mayor"}]}
{"id":"nostrc-dqwq.3","title":"2C: Direct accessors instead of g_object_get","description":"factory_bind_cb (line 142 of gn-timeline-view.c) does two g_object_get calls extracting 8 properties with GType boxing/unboxing and string allocations, followed by 10 g_free calls on unbind.\n\n**Fix**: Add const-returning inline accessors (gn_nostr_event_item_get_pubkey(), gn_nostr_event_item_get_event_id(), etc.) that return direct pointers to cached fields. Eliminates per-bind allocation/free of 10 strings.\n\n**Files**:\n- apps/gnostr/src/model/gn-nostr-event-item.c ‚Äî implement accessor functions\n- apps/gnostr/src/model/gn-nostr-event-item.h ‚Äî declare accessor functions\n- apps/gnostr/src/ui/gn-timeline-view.c ‚Äî replace g_object_get with direct accessors in factory_bind_cb\n\n**Validation**: Profile factory_bind_cb with g_get_monotonic_time(). Expected: significant reduction in per-bind allocation overhead.","status":"closed","priority":1,"issue_type":"task","assignee":"boris","created_at":"2026-02-10T22:40:22.828163-08:00","created_by":"mayor","updated_at":"2026-02-10T22:47:53.67636-08:00","closed_at":"2026-02-10T22:47:53.67636-08:00","close_reason":"Direct accessors implemented. g_object_get replaced with const-returning accessors in factory_bind_cb and on_item_profile_changed. Eliminated 5 string allocs/frees + GType boxing per bind. Clean compilation.","dependencies":[{"issue_id":"nostrc-dqwq.3","depends_on_id":"nostrc-dqwq","type":"parent-child","created_at":"2026-02-10T22:40:22.829458-08:00","created_by":"mayor"}]}
{"id":"nostrc-dw3","title":"Queue overflow on startup - depth grows unbounded past capacity","description":"On app startup, queue grows unbounded past capacity (4096) with no backpressure:\n\n```\n[WARN][queue] Queue near capacity: sid=1 depth=4467/4096 util=109%\n[DEBUG][relay] drop low-priority event: queue 109% full\n[WARN][queue] Queue near capacity: sid=1 depth=4468/4096 util=109%\n...continuously growing to 4484+\n```\n\n**Problems:**\n1. Queue depth exceeds capacity (4467 \u003e 4096) - should be impossible if bounded\n2. Depth keeps growing (4467‚Üí4484) even while dropping events\n3. Utilization stuck at 109% - consumer not draining queue\n4. Continuous stream of warnings floods logs\n\n**Root cause hypotheses:**\n1. Queue not actually bounded - allows overflow\n2. Consumer thread not started/stuck during startup\n3. Producer not respecting backpressure signals\n4. Rate limiting (nostrc-7u2) not kicking in\n\n**Related:** nostrc-pvy (backpressure) was marked complete but this suggests it's not working on startup.\n\n**Expected:** Queue should block/drop at capacity, not overflow. Consumer should drain faster than producer adds.","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-31T14:29:35.143998-08:00","created_by":"mayor","updated_at":"2026-01-31T15:19:48.125254-08:00","closed_at":"2026-01-31T15:19:48.125254-08:00","close_reason":"Fixed by billy: 18cdb32 - use actual channel depth"}
{"id":"nostrc-e0g","title":"Consolidate duplicate NIP-10 parsing into single canonical function","description":"The codebase has at least 4 separate NIP-10 e-tag parsing implementations:\n\n1. storage_ndb.c:storage_ndb_note_get_nip10_thread()\n2. gn-nostr-event-model.c:parse_nip10_tags()  \n3. gnostr-thread-view.c (inline parsing ~line 165)\n4. nip7d_threads.c:gnostr_thread_extract_root_id() and gnostr_thread_reply_extract_parent_id()\n5. gnostr-drafts.c (inline parsing ~line 268)\n\nThis caused the root-only marker bug to slip through - it was fixed in one place but not the others.\n\nACTION REQUIRED:\n1. Create a single nip10_parse.c/h module with canonical functions:\n   - nip10_parse_thread_info(tags) -\u003e {root_id, reply_id, is_reply}\n   - nip10_parse_from_json(json_t *tags) -\u003e same  \n   - nip10_parse_from_ndb(struct ndb_tags *tags) -\u003e same\n2. Replace all duplicate implementations with calls to canonical functions\n3. Add unit tests for all NIP-10 edge cases\n\nThis prevents bugs from recurring due to fixing one parser but not others.","status":"closed","priority":1,"issue_type":"task","assignee":"boris","created_at":"2026-01-29T17:04:15.483205-08:00","created_by":"mayor","updated_at":"2026-01-29T19:57:47.9437-08:00","closed_at":"2026-01-29T19:57:47.9437-08:00","close_reason":"Closed"}
{"id":"nostrc-e8b","title":"Migrate NIP-49 private key encryption to plugin","description":"## Goal\n\nMigrate NIP-49 (Private Key Encryption) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip49/` - ncryptsec key encryption/decryption\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip49-keyencrypt/`\n2. Move encryption/decryption implementation\n3. Plugin API:\n   ```c\n   char* gnostr_nip49_encrypt_key(plugin, nsec, password);\n   char* gnostr_nip49_decrypt_key(plugin, ncryptsec, password);\n   ```\n4. Integration points:\n   - Key import/export in settings\n   - Backup functionality\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"closed","priority":3,"issue_type":"task","assignee":"billy","created_at":"2026-01-30T10:20:55.203505-08:00","created_by":"mayor","updated_at":"2026-01-31T17:49:29.731067-08:00","closed_at":"2026-01-31T17:49:29.731067-08:00","close_reason":"Completed by billy","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-e8b","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T10:20:59.438654-08:00","created_by":"mayor"},{"issue_id":"nostrc-e8b","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T10:20:59.502944-08:00","created_by":"mayor"}]}
{"id":"nostrc-efl","title":"Stack overflow in event_bus_emit_event under ASAN: unnecessary JSON serialization on worker thread","description":"ASAN stack overflow in subscribe_many_thread -\u003e event_bus_emit_event -\u003e jansson_event_serialize -\u003e json_dumps. Worker thread (g_thread_new default stack) overflows because event_bus_emit_event serializes every event to JSON just to pass through the EventBus. ASAN inflates per-frame stack 3-4x. Fix: either pass NostrEvent* through bus instead of JSON, or skip bus emit since events already reach consumers via emit_batch_sorted.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T14:53:16.696112-08:00","created_by":"mayor","updated_at":"2026-02-07T18:40:12.563714-08:00","closed_at":"2026-02-07T18:40:12.563714-08:00","close_reason":"Closed"}
{"id":"nostrc-eq5","title":"Fix deprecated sprintf warnings - use snprintf","description":"## Problem\n\nBuild warnings for deprecated sprintf usage. Should use snprintf for security.\n\n## Warnings\n\n**gnostr-note-embed.c:299**\n```c\nsprintf(out + i*2, \"%02x\", bytes[i]);\n```\n\n**gnostr-timeline-view.c:337**\n```c\nfor (int i=0;i\u003c32;i++) sprintf(\u0026idhex[i*2], \"%02x\", id32[i]);\n```\n\n## Fix\n\nReplace sprintf with snprintf, providing buffer size:\n\n```c\n// Instead of:\nsprintf(out + i*2, \"%02x\", bytes[i]);\n\n// Use:\nsnprintf(out + i*2, 3, \"%02x\", bytes[i]);\n```\n\nFor the hex conversion loops, the remaining buffer size decreases with each iteration.\n\n## Files to Fix\n\n- apps/gnostr/src/ui/gnostr-note-embed.c:299\n- apps/gnostr/src/ui/gnostr-timeline-view.c:337\n\n## Notes\n\nAlso audit codebase for other sprintf usage and convert to snprintf.","status":"closed","priority":3,"issue_type":"bug","assignee":"billy","created_at":"2026-01-29T14:13:34.019064-08:00","created_by":"mayor","updated_at":"2026-01-29T15:51:19.056419-08:00","closed_at":"2026-01-29T15:51:19.056419-08:00","close_reason":"sprintf replaced with snprintf"}
{"id":"nostrc-g3jl","title":"Invalid signal 'need-profile' on GnostrTimelineView","description":"Signal 'need-profile' is emitted on GnostrTimelineView but was never registered with g_signal_new(). GLib-GObject-CRITICAL at startup. Register the signal or fix the emission site.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/brett","created_at":"2026-02-08T12:34:24.995744-08:00","created_by":"mayor","updated_at":"2026-02-08T12:50:48.391251-08:00","closed_at":"2026-02-08T12:50:48.391251-08:00","close_reason":"Closed"}
{"id":"nostrc-g4t","title":"Add input validation to compact JSON parsers","description":"Compact parsers in event.c, envelope.c, filter.c accept malformed JSON silently with no validation. Add basic structure validation - check for balanced braces/brackets, reject duplicate keys, validate required fields. Important for untrusted relay data. Keep fast-path performance - validation should be O(n) single pass.","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/brett","created_at":"2026-02-07T17:44:47.480164-08:00","created_by":"mayor","updated_at":"2026-02-08T01:28:06.96633-08:00","closed_at":"2026-02-08T01:28:06.96633-08:00","close_reason":"Closed"}
{"id":"nostrc-g92j","title":"Banner image still broken in profile view","description":"Banner image in profile viewer still not displaying despite previous fix attempts (6485327, d71cc09).","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T17:17:16.112599-08:00","created_by":"mayor","updated_at":"2026-02-08T18:39:43.739239-08:00","closed_at":"2026-02-08T18:39:43.739239-08:00","close_reason":"Fixed by billy in 39ae8f0: HTTP status check before texture creation"}
{"id":"nostrc-gl3","title":"Add NIP-25 reactions and NIP-57 zaps display to event cards","description":"## Feature\n\nDisplay NIP-25 reactions (kind 7) and NIP-57 zaps (kind 9735) on event cards.\n\n## Requirements\n\n### Subscription Management\n- **Follow the profile subscription pattern** - examine how profiles are fetched and cached\n- **Bounded subscriptions** - must NOT create unbounded subscription growth as user scrolls\n- **Sliding window approach** - subscribe to reactions for visible events, unsubscribe when scrolled away\n- **Batching** - batch multiple event IDs into single subscription filters where possible\n- **Deduplication** - reuse existing subscriptions, dont duplicate for same event\n\n### Possible Approaches\n\n1. **Viewport-based subscription**\n   - Track which events are currently visible\n   - Maintain a single subscription with filter for visible event IDs\n   - Update filter as viewport changes (debounced)\n   - Close old sub, open new sub with updated filter\n\n2. **LRU subscription pool**\n   - Fixed pool of N reaction subscriptions\n   - Evict oldest when adding new\n   - Cache results in nostrdb for replay\n\n3. **Periodic polling**\n   - Instead of persistent subs, periodically request reactions for visible events\n   - Less real-time but simpler subscription management\n\n### Data Model\n\n**NIP-25 Reactions (kind 7):**\n- Content: emoji or \"+\" for like\n- Tags: [\"e\", \u003cevent-id\u003e], [\"p\", \u003cpubkey\u003e]\n- Display: reaction counts grouped by emoji, expandable to show who reacted\n\n**NIP-57 Zaps (kind 9735):**\n- Zap receipt from lightning node\n- Tags: [\"e\", \u003cevent-id\u003e], [\"p\", \u003cpubkey\u003e], [\"bolt11\", ...], [\"description\", ...]\n- Display: total sats, zap count, top zappers\n\n### UI Requirements\n\n- Compact display on event cards (counts/icons)\n- Non-blocking - dont delay event card render waiting for reactions\n- Smooth updates when new reactions arrive (no jarring redraws)\n- Accessible - screen reader friendly counts\n\n### Implementation Notes\n\n- Store reactions in nostrdb for persistence and query\n- Consider indexing by target event ID for fast lookup\n- Reactions may arrive before or after the target event\n- Handle reaction spam gracefully (rate limit display updates)\n\n## References\n\n- NIP-25: https://github.com/nostr-protocol/nips/blob/master/25.md\n- NIP-57: https://github.com/nostr-protocol/nips/blob/master/57.md\n- Existing profile subscription code as pattern template","status":"closed","priority":1,"issue_type":"feature","assignee":"bruce","created_at":"2026-01-29T09:57:32.727915-08:00","created_by":"mayor","updated_at":"2026-01-29T13:36:10.092848-08:00","closed_at":"2026-01-29T13:36:10.092848-08:00","close_reason":"Implemented NIP-25 reactions and NIP-57 zaps display subscriptions. Added storage functions for zap stats, properties on event items, lifetime subscriptions to event model, and timeline view bindings.","dependencies":[{"issue_id":"nostrc-gl3","depends_on_id":"nostrc-ofq","type":"blocks","created_at":"2026-01-29T13:58:36.179499-08:00","created_by":"mayor"}]}
{"id":"nostrc-gpkw","title":"Remove video loading timeout (LOADING_TIMEOUT_SEC=15) in gnostr-video-player.c","status":"open","priority":1,"issue_type":"bug","assignee":"crew","created_at":"2026-02-09T17:06:29.268424-08:00","created_by":"mayor","updated_at":"2026-02-09T17:06:29.268424-08:00"}
{"id":"nostrc-h26f","title":"Video playback fails: missing GStreamer GTK media module","description":"Notes with video show error instead of content. GTK media module for GStreamer not found at runtime. Add gstreamer dependency or graceful fallback.","status":"closed","priority":3,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T12:34:43.51402-08:00","created_by":"mayor","updated_at":"2026-02-08T12:51:03.883756-08:00","closed_at":"2026-02-08T12:51:03.883756-08:00","close_reason":"Closed"}
{"id":"nostrc-hb5","title":"t-tags (hashtags) not displaying in note cards","description":"Hashtags from 't' tags should display between event content and action buttons. Either:\n1. Feature exists but box has wrong height/visibility\n2. Feature was never implemented\n\nNeed to investigate note card UI code to find where t-tags are (or should be) rendered.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-29T21:56:16.368309-08:00","created_by":"mayor","updated_at":"2026-01-29T22:37:18.689732-08:00","closed_at":"2026-01-29T22:37:18.689732-08:00","close_reason":"Fixed: hashtags_box was positioned after actions_box instead of before. Moved to correct position between content and action buttons."}
{"id":"nostrc-hes","title":"Right-click on post action buttons shows 3-dot menu","description":"## Bug\n\nRight-clicking on any of the post action buttons (like, zap, repost, reply, etc.) causes the 3-dot context menu to appear instead of expected right-click behavior.\n\n## Expected Behavior\n\n- Right-click on action buttons should either:\n  - Do nothing (ignore right-click)\n  - Show button-specific context menu if applicable\n  - Not trigger the parent note card context menu\n\n## Current Behavior\n\n- Right-click on like/zap/reply/repost buttons shows the 3-dot menu\n- The 3-dot menu is meant for the note card, not individual buttons\n- Confusing UX - menu appears in unexpected location\n\n## Cause\n\nEvent propagation likely bubbling up from buttons to parent note card, triggering the context menu handler.\n\n## Fix\n\n- Stop event propagation on right-click for action buttons\n- Or check event target in context menu handler and ignore if from action buttons\n- Use gtk_gesture_click with button=3 to handle right-clicks specifically","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-29T13:39:46.673798-08:00","created_by":"mayor","updated_at":"2026-01-29T21:54:57.769075-08:00","closed_at":"2026-01-29T21:54:57.769075-08:00","close_reason":"Fixed: Changed wrapper from Button to div, added oncontextmenu stopPropagation to prevent right-click bubbling"}
{"id":"nostrc-i0i","title":"Zap button shows amount received and visual indicator when zapped","description":"## Feature\n\nEnhance the zap button on event cards:\n\n1. **Tooltip**: Display total zap amount received (e.g., \"1,234 sats received\")\n2. **Visual indicator**: Show that the event has been zapped (e.g., different color, icon change, or count badge)\n\n## Requirements\n\n- Query zap stats for the event (kind 9735 events)\n- Update tooltip with formatted amount\n- Add visual styling when zap count \u003e 0 (could be:\n  - Tinted/highlighted button\n  - Small badge with count\n  - Different icon state)\n- Should update when new zaps arrive\n\n## Notes\n\nThere's already ZapStats caching in gn-nostr-event-model.c - leverage that.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-30T02:11:17.029276-08:00","created_by":"mayor","updated_at":"2026-01-30T02:14:24.646084-08:00","closed_at":"2026-01-30T02:14:24.646085-08:00"}
{"id":"nostrc-i5j","title":"Format warning in connection.c - %p used for char*","description":"Compiler warning in connection.c:134\n\n```\nwarning: format specifies type 'void *' but the argument has type 'char *' [-Wformat-pedantic]\nfprintf(stderr, \"Invalid message: data=%p length=%zu\\n\", msg-\u003edata, msg-\u003elength);\n                                       ~~                ^~~~~~~~~\n                                       %s\n```\n\n**Fix:** Change %p to %s if msg-\u003edata is a string, or cast to (void*) if pointer address is intended.\n\nLikely should be %s to show the actual invalid message content for debugging.","status":"closed","priority":4,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-31T15:56:23.655463-08:00","created_by":"mayor","updated_at":"2026-01-31T18:25:39.672378-08:00","closed_at":"2026-01-31T18:25:39.672378-08:00","close_reason":"Fixed by bruce: 958de01 - cast to void*"}
{"id":"nostrc-ih5","title":"Plugin build broken: gnostr-plugin-api.c includes internal headers","description":"After nostrc-70k, the plugins fail to build with:\n\n```\ngnostr-signer-service.h:17:10: fatal error: 'nostr/nip46/nip46_client.h' file not found\n```\n\nThe issue is that gnostr-plugin-api.c now includes:\n- ipc/gnostr-signer-service.h (which includes nostr/nip46/nip46_client.h)\n- nostr_simple_pool.h\n\nThese headers aren't available in the plugin include paths.\n\nSolution options:\n1. Use forward declarations in gnostr-plugin-api.c instead of including headers\n2. Create a static library for plugin API that plugins link against\n3. Split plugin-facing code from app-internal code\n\nThis blocks all plugin builds (nip47-nwc, nip98-httpauth, etc.)","status":"closed","priority":1,"issue_type":"bug","assignee":"boris","created_at":"2026-01-31T19:13:34.188609-08:00","created_by":"nostrc/crew/boris","updated_at":"2026-01-31T19:18:23.69683-08:00","closed_at":"2026-01-31T19:18:23.69683-08:00","close_reason":"Closed"}
{"id":"nostrc-ipp","title":"SEGV in pango during note_card_row dispose from idle callback","description":"## Crash\n\nNULL pointer WRITE in libpango during note_card_row disposal, triggered from model's idle callback.\n\n## Stack Trace\n\n```\nenforce_window_idle_cb (gn-nostr-event-model.c:859)\n  ‚Üí g_signal_emit\n  ‚Üí gtk_list_item_set_child\n  ‚Üí gnostr_note_card_row_dispose (note_card_row.c:433)\n  ‚Üí gtk_widget_dispose_template\n  ‚Üí g_hash_table_remove ‚Üí unref chain\n  ‚Üí libpango CRASH (NULL write at 0x0)\n```\n\n## Analysis\n\n- Idle callback in event model triggers widget disposal\n- During dispose, template widget cleanup cascades through unrefs\n- Pango text layout object has NULL internal pointer during cleanup\n- Likely a PangoLayout or PangoContext was already freed/corrupted\n\n## Possible Causes\n\n1. Label widget's PangoLayout freed before widget dispose\n2. Double-dispose of note_card_row\n3. Race between model updates and widget lifecycle\n4. Template child already disposed before gtk_widget_dispose_template\n\n## Files to Check\n\n- `apps/gnostr/src/ui/note_card_row.c:433` - dispose function\n- `apps/gnostr/src/model/gn-nostr-event-model.c:859` - enforce_window_idle_cb\n- Check if dispose is being called multiple times\n- Check if labels are being accessed after dispose started","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-30T15:00:39.461076-08:00","created_by":"mayor","updated_at":"2026-01-30T17:14:40.6834-08:00","closed_at":"2026-01-30T17:14:40.6834-08:00","close_reason":"Closed"}
{"id":"nostrc-j4m","title":"Package: Snap (Ubuntu Store)","description":"## Goal\n\nCreate Snap package for distribution via Ubuntu Snap Store.\n\n## Tasks\n\n1. Create snapcraft.yaml\n   - Core22 base\n   - GTK4 extension\n   - Proper plugs/slots for permissions\n\n2. Desktop integration\n   - .desktop file\n   - Icons\n   - Content sharing interfaces\n\n3. Snap Store submission\n   - Register snap name\n   - Set up automatic builds\n   - Configure channels (edge/beta/stable)\n\n4. CI workflow\n   - Build snap\n   - Test installation\n   - Publish to edge channel\n\n## Permissions needed\n- network (relay connections)\n- home (key storage)\n- desktop, desktop-legacy, wayland, x11","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:48.732708-08:00","created_by":"mayor","updated_at":"2026-01-30T12:22:12.290831-08:00","closed_at":"2026-01-30T12:22:12.290831-08:00","close_reason":"CI jobs already exist: build-snap-gnostr, build-snap-signer, build-snap-daemon","labels":["deployment","linux"],"dependencies":[{"issue_id":"nostrc-j4m","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.198413-08:00","created_by":"mayor"}]}
{"id":"nostrc-j6h1","title":"App freezes/stalls completely - likely deadlock in relay message handling","description":"CRITICAL: The app randomly stalls and becomes unresponsive. The only console output is the repeated [WARN][json] envelope compact parse failed: truncated input (offset 13) which also eventually stops. This suggests a deadlock or blocked main thread. The truncated JSON parse error may be a symptom of partial WebSocket reads, and the error handling path may be hitting a mutex deadlock or blocking the GLib main loop. Investigate: 1) WebSocket frame reassembly in nostr_relay.c - are partial frames being processed? 2) Lock contention between relay I/O thread and GLib main loop 3) Whether the compact JSON parser error path blocks or retries indefinitely 4) nsync mutex usage in the relay/pool code","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/boris","created_at":"2026-02-08T14:01:51.32081-08:00","created_by":"mayor","updated_at":"2026-02-08T14:18:09.382967-08:00","closed_at":"2026-02-08T14:18:09.382967-08:00","close_reason":"Deadlock fixed by boris: go_channel_send‚Üítry_send in lws callback, channel capacity 16‚Üí256. Commit 1181248"}
{"id":"nostrc-k2q","title":"NIP-19 bech32 parser too lenient - includes trailing invalid characters","description":"The nostr: URI parser incorrectly includes trailing characters that are not valid bech32.\n\nEXAMPLE:\nContent: 'nostr:npub1cm3rpgj7457yjuqnvdalxaauakqu0ndkpkyp5cldkyutpz4xszpsmk96wt?'\n\nThe '?' is:\n1. NOT a valid bech32 character (valid chars: qpzry9x8gf2tvdw0s3jn54khce6mua7l)\n2. Makes the string longer than allowed for npub (which has fixed length)\n\nREQUIRED FIXES per NIP-19:\n\n1. **Fixed-length entities must validate length:**\n   - npub: 'npub1' + 58 chars = 63 total\n   - nsec: 'nsec1' + 58 chars = 63 total  \n   - note: 'note1' + 58 chars = 63 total\n\n2. **TLV entities (nprofile, nevent, naddr, nrelay) must:**\n   - Stop parsing at first invalid bech32 character\n   - Validate TLV structure boundaries\n\n3. **Invalid bech32 characters to reject:**\n   - Any char NOT in: qpzry9x8gf2tvdw0s3jn54khce6mua7l\n   - Common trailing punctuation: ? ! . , ; : ' \" ) ] }\n\n4. **Parser should:**\n   - Extract only valid bech32 portion\n   - Verify checksum on extracted portion\n   - For fixed-length types, reject if wrong length\n\nSee NIP-19: https://github.com/nostr-protocol/nips/blob/master/19.md","status":"closed","priority":1,"issue_type":"bug","assignee":"brett","created_at":"2026-01-29T17:44:26.200962-08:00","created_by":"mayor","updated_at":"2026-01-29T19:54:39.266396-08:00","closed_at":"2026-01-29T19:54:39.266396-08:00","close_reason":"Fixed bech32 parser to properly terminate at invalid characters. Both nip21_uri.c and nostr_bech32.c now validate against the actual bech32 charset (qpzry9x8gf2tvdw0s3jn54khce6mua7l) instead of accepting all alphanumeric characters."}
{"id":"nostrc-k9m","title":"DM Conversation View: missing .ui resource in GResource bundle","description":"The DM conversation .blp template was added (nostrc-8) but never compiled/registered in the GResource bundle. Causes 20+ GTK-CRITICAL assertions on every startup (bind_template_child failures, NULL pointer instances). Fix: add gnostr-dm-conversation-view.blp to the meson.build resource list and ensure the .ui is compiled into the GResource XML.","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/boris","created_at":"2026-02-08T12:34:09.553533-08:00","created_by":"mayor","updated_at":"2026-02-08T12:45:08.960092-08:00","closed_at":"2026-02-08T12:45:08.960092-08:00","close_reason":"Closed"}
{"id":"nostrc-lul","title":"Videos not displaying controls or playing in timeline","description":"Videos in timeline not working properly:\n\n- No playback controls displayed\n- Videos not playing properly\n\n**Expected:**\n- Video controls (play/pause, progress, volume) visible\n- Videos play when interacted with\n\n**Investigation needed:**\n- Check video widget implementation\n- Verify media controls are being added\n- Check if video element is receiving proper source/dimensions\n- Test with different video formats/sources\n\n**Files likely involved:**\n- Video/media widget in timeline\n- Note card media rendering\n- GStreamer/media pipeline setup","status":"closed","priority":2,"issue_type":"bug","assignee":"barry","created_at":"2026-01-31T16:14:43.912506-08:00","created_by":"mayor","updated_at":"2026-01-31T17:55:40.418037-08:00","closed_at":"2026-01-31T17:55:40.418037-08:00","close_reason":"Completed by barry"}
{"id":"nostrc-md0","title":"Fix fragile strstr() relay message routing in relay_optimized.c","description":"relay_optimized.c:114-129 is_control_message() uses strstr('[\"EOSE\"') etc to route messages. Can false-match on content strings. Replace with proper first-token parse ‚Äî read first few bytes after '[\"' to extract the message type label without scanning the full string.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-07T17:44:42.317286-08:00","created_by":"mayor","updated_at":"2026-02-08T01:19:49.605567-08:00","closed_at":"2026-02-08T01:19:49.605567-08:00","close_reason":"Closed"}
{"id":"nostrc-mef","title":"NIP-10 marker style parsing incomplete - root-only events not treated as replies","description":"## Problem\n\nEvents with NIP-10 marker-style \"e\" tags are still not being recognized as threads/replies.\n\n## Example Event\n\n```json\n{\n  \"id\": \"c23d6817df48c23c6025fec311afd42324b94c0e0a5a9cbe893eed4c130fbda4\",\n  \"kind\": 1,\n  \"tags\": [\n    [\"e\", \"16c6e1329d08cd4d236d28a6019b5089bf02caf10f4949aded11e2e26823dd0c\", \"\", \"root\"],\n    [\"p\", \"50d94fc2d8580c682b071a542f8b1e31a200b0508bab95a33bef0855df281d63\", \"\", \"mention\"]\n  ],\n  \"content\": \"Great stuff Calle...\"\n}\n```\n\nThis event has:\n- An \"e\" tag with explicit \"root\" marker\n- No \"reply\" marker\n\n## NIP-10 Spec\n\nPer NIP-10, when an event has:\n- Only a \"root\" marker (no \"reply\" marker): This is a DIRECT REPLY to the root event\n- The root_id AND reply_id should BOTH be set to the root event ID\n\nCurrent code may be:\n1. Only looking for \"reply\" marker to set reply_id\n2. Leaving reply_id NULL when only \"root\" marker exists\n3. Not treating root-only events as replies\n\n## Expected Behavior\n\n- Event should show as a reply to 16c6e1329d...\n- Reply indicator should be visible in timeline\n- Thread view should show proper hierarchy\n\n## Investigation\n\n1. Check how marker-style parsing handles root-only case\n2. Verify reply_id is set when only root marker present\n3. Test with various marker combinations:\n   - root only (direct reply)\n   - root + reply (nested reply)\n   - reply only (legacy)\n   - no markers (positional fallback)\n\n## Related\n\n- nostrc-5b8: Previous e-tag fix (verified closed but incomplete)\n- nostrc-71t: Original NIP-10 implementation","status":"closed","priority":1,"issue_type":"bug","assignee":"boris","created_at":"2026-01-29T14:27:03.343593-08:00","created_by":"mayor","updated_at":"2026-01-29T16:45:59.123356-08:00","closed_at":"2026-01-29T16:45:59.123356-08:00","close_reason":"Fixed: When event has only root marker (no reply marker), set reply_id = root_id. Commit 1178969."}
{"id":"nostrc-mizr","title":"Profile Posts tab: images missing and action buttons non-functional","status":"in_progress","priority":2,"issue_type":"bug","assignee":"nostrc/billy","created_at":"2026-02-08T18:43:56.891741-08:00","created_by":"mayor","updated_at":"2026-02-08T18:44:08.179378-08:00"}
{"id":"nostrc-mju","title":"Embedded videos are not playable","description":"## Bug\n\nEmbedded videos in notes are not playable.\n\n## Expected Behavior\n\n- Videos embedded in notes should be playable inline\n- Play/pause controls should work\n- Video should load and stream properly\n\n## Current Behavior\n\n- Videos are not playable (details TBD - needs investigation)\n\n## Investigation Needed\n\n- Identify how videos are currently rendered (img tag? video tag? custom widget?)\n- Check if video URLs are being detected and parsed correctly\n- Verify GStreamer/media backend integration\n- Test with various video formats (mp4, webm, etc.)\n- Check for CORS or network issues with video sources\n\n## Possible Causes\n\n- Video URLs not detected in note content\n- Video element not properly initialized\n- Missing codec support\n- Autoplay restrictions not handled\n- Widget not properly sized/visible","status":"closed","priority":2,"issue_type":"bug","assignee":"billy","created_at":"2026-01-29T10:44:34.725842-08:00","created_by":"mayor","updated_at":"2026-01-29T11:34:33.562781-08:00","closed_at":"2026-01-29T11:34:33.562781-08:00","close_reason":"Added error handling and loading state to video player. Videos now show loading spinner while preparing, and display error overlay with details when playback fails. Autoplay properly waits for media preparation.","dependencies":[{"issue_id":"nostrc-mju","depends_on_id":"nostrc-vtv","type":"blocks","created_at":"2026-01-29T10:44:42.295443-08:00","created_by":"mayor"}]}
{"id":"nostrc-myp3","title":"Account menu View Profile still doesn't display user's own profile","description":"Despite multiple fix attempts (init reorder, npub-to-hex conversion, defensive sweep, View Profile button), clicking View Profile in account menu STILL does not display the user's own profile. The same profile loading pattern works everywhere else in the app. This is a persistent P0 that has survived 5+ fix attempts.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-08T17:17:01.346991-08:00","created_by":"mayor","updated_at":"2026-02-08T17:39:30.16845-08:00","closed_at":"2026-02-08T17:39:30.16845-08:00","close_reason":"Fixed in b3451b44: self-healing GSettings fallback"}
{"id":"nostrc-mzab","title":"Subscription cycle blocks main thread on large event batches (startup)","description":"Something in the subscription handling blocks the GTK main thread, especially pronounced at startup when large numbers of events are returned. Results in UI freezes/stalls.","status":"open","priority":1,"issue_type":"bug","assignee":"nostrc/bruce","created_at":"2026-02-08T17:17:06.493168-08:00","created_by":"mayor","updated_at":"2026-02-08T18:48:07.023815-08:00"}
{"id":"nostrc-nft","title":"ASAN: heap-use-after-free in nostr_connection_read_message","description":"Use-after-free in websocket message handling between threads.\n\n**Stack trace:**\n```\nREAD at connection.c:770 in nostr_connection_read_message (Thread T16)\nfreed at connection.c:800 in nostr_connection_read_message (Thread T16)  \nallocated at connection.c:63 in websocket_callback (Thread T14)\n```\n\n**Root cause:**\nRace between:\n- T14 (lws_service_loop): websocket_callback allocates message buffer\n- T16 (message_loop): nostr_connection_read_message frees at :800, then reads at :770\n\nThe same thread (T16) frees and then reads - likely a loop where message is freed but pointer not cleared, then accessed on next iteration.\n\n**Files:**\n- libnostr/src/connection.c:770, :800, :63\n- libnostr/src/relay.c:694 (message_loop)\n\n**Fix approach:**\n- Clear pointer after free at :800\n- Or restructure to not reuse freed pointer\n- Check message validity before read at :770","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-31T15:53:02.595932-08:00","created_by":"mayor","updated_at":"2026-01-31T16:25:53.540431-08:00","closed_at":"2026-01-31T16:25:53.540431-08:00","close_reason":"Fixed by clearing buffer slots after receive in all channel receive paths"}
{"id":"nostrc-ngi","title":"Migrate nip70_protected.c from direct jansson to NostrJsonInterface","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T23:55:11.873705-08:00","updated_at":"2026-01-29T23:56:42.205961-08:00","closed_at":"2026-01-29T23:56:42.205961-08:00","close_reason":"Successfully migrated nip70_protected.c from direct jansson to NostrJsonInterface facade. Build verified."}
{"id":"nostrc-ns2k","title":"NIP-66 relay discovery broken: doesn't return discovered relays","description":"NIP-66 relay discovery no longer returns the list of discovered relays. This is a regression ‚Äî it used to work. Investigate the relay discovery/monitor service and fix the relay list return path.\n\nNIP-66 defines kind 10166 relay monitor events and kind 30166 relay metadata. The discovery flow should query these events and return a list of available relays to the user. Debug why results are no longer surfacing.","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/brett","created_at":"2026-02-08T13:50:11.662365-08:00","created_by":"mayor","updated_at":"2026-02-08T18:39:48.856092-08:00","closed_at":"2026-02-08T18:39:48.856092-08:00","close_reason":"Fixed by brett in d7aae3e: removed race between timeout and query thread","dependencies":[{"issue_id":"nostrc-ns2k","depends_on_id":"nostrc-8zpc","type":"blocks","created_at":"2026-02-08T14:45:02.416503-08:00","created_by":"mayor"}]}
{"id":"nostrc-nst","title":"Use NDB content blocks instead of re-parsing JSON","description":"NDB_DB_NOTE_BLOCKS pre-parses hashtags, mentions, URLs, bolt11 invoices at ingest time. The app currently re-parses everything from JSON manually. Switch to ndb_parse_content() / block iteration API for rendering note content. Eliminates redundant parsing work.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-07T17:20:22.357152-08:00","created_by":"mayor","updated_at":"2026-02-08T01:25:08.1603-08:00","closed_at":"2026-02-08T01:25:08.1603-08:00","close_reason":"Closed"}
{"id":"nostrc-o56","title":"CRITICAL: libgo/libnostr architecture overhaul - eliminate memory corruption","description":"The libgo library implements Go-style concurrency in C but has fundamental memory safety issues. Recurring crashes show:\n\n1. Channel pointers becoming wild/garbage (not use-after-free, completely invalid addresses)\n2. Worker threads accessing freed contexts\n3. Race conditions between thread creation/destruction and resource cleanup\n\nROOT CAUSE ANALYSIS NEEDED:\n- go_channel lifecycle vs thread lifecycle\n- go_context ownership and reference counting\n- nostr_relay connect/disconnect race conditions\n- connection_context lifetime management\n\nREQUIRED CHANGES:\n1. Implement proper ownership model - who owns what, when is it freed\n2. Add reference counting with atomic ops for all shared resources\n3. Use mutex/rwlock protection for all shared state\n4. Add validation/magic numbers to detect corruption early\n5. Implement graceful shutdown - signal threads to stop BEFORE freeing resources\n6. Consider replacing custom channel impl with proven alternatives (GLib async queues)\n\nThis is blocking - app is unusable with these crashes. All three crew members should coordinate on this.","notes":"ANALYSIS OF WHY PREVIOUS FIX FAILED:\n\nBilly's fix (d2adb18) added go_context_ref() at the START of worker threads. But there's a race:\n\n1. Thread reads r-\u003epriv-\u003econnection_context (line ~589)\n2. RACE WINDOW: relay/priv can be freed here  \n3. Thread calls go_context_ref(ctx) - but ctx is already garbage\n\nThe fix assumes r-\u003epriv is valid when reading connection_context. But if the relay is freed between thread creation and the ref acquisition, we read garbage.\n\nREAL FIX NEEDED:\n- Pass the context (already ref'd) TO the thread at creation time\n- Or ref-count the relay itself, not just the context\n- Or use GLib's thread pools with proper GCancellable integration\n\nThe current architecture has threads reading from shared structs without synchronization. This is fundamentally broken.","status":"closed","priority":0,"issue_type":"epic","assignee":"billy","created_at":"2026-01-29T16:51:02.659516-08:00","created_by":"mayor","updated_at":"2026-01-30T13:22:19.286898-08:00","closed_at":"2026-01-30T13:22:19.286898-08:00","close_reason":"Closed","dependencies":[{"issue_id":"nostrc-o56","depends_on_id":"nostrc-201","type":"blocks","created_at":"2026-01-30T12:34:38.029075-08:00","created_by":"mayor"}]}
{"id":"nostrc-o6w","title":"Expose NDB statistics API for monitoring","description":"ndb_stat() provides per-DB sizes, per-kind counts, total entry counts. Currently never called. Expose in a stats/debug panel: DB size, event counts by kind, index sizes, mapsize usage. Useful for monitoring growth and capacity planning.","status":"closed","priority":2,"issue_type":"feature","assignee":"nostrc/billy","created_at":"2026-02-07T17:20:37.863321-08:00","created_by":"mayor","updated_at":"2026-02-08T02:10:42.790998-08:00","closed_at":"2026-02-08T02:10:42.790998-08:00","close_reason":"Closed"}
{"id":"nostrc-oa9","title":"SEGV in Pango during og-preview-widget dispose on image click","description":"Crash when clicking image in timeline. NULL pointer dereference in Pango during widget disposal.\n\n**Stack trace:**\n```\n#0  pango_layout_line_unref (libpango)\n#11 og_preview_widget_dispose /apps/gnostr/src/ui/og-preview-widget.c:508\n#23 gnostr_note_card_row_dispose /apps/gnostr/src/ui/note_card_row.c:433\n#44 enforce_window_idle_cb /apps/gnostr/src/model/gn-nostr-event-model.c:859\n```\n\n**Trigger:** Click on image in timeline\n\n**Root cause:** \nWidget disposal triggered from idle callback (enforce_window_idle_cb) while Pango layout still has references. Similar pattern to nostrc-ipp (Pango crash in note_card_row).\n\n**Files:**\n- apps/gnostr/src/ui/og-preview-widget.c:508\n- apps/gnostr/src/ui/note_card_row.c:433\n- apps/gnostr/src/model/gn-nostr-event-model.c:859\n\n**Fix approach:**\n- Check if widget is in dispose before accessing Pango layouts\n- Clear Pango layout refs before chaining to parent dispose\n- Guard against idle callbacks on disposed widgets","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-31T15:11:46.513352-08:00","created_by":"mayor","updated_at":"2026-01-31T15:19:48.18742-08:00","closed_at":"2026-01-31T15:19:48.18742-08:00","close_reason":"Fixed by billy: 32f17d8 - remove explicit unparent"}
{"id":"nostrc-ofq","title":"Timeline architecture overhaul: eliminate crashes and improve sliding window UX","description":"## Critical Problem\n\nThe current timeline implementation has fundamental issues that are blocking release:\n\n### 1. Random Crashes During Scrolling\n- GTK and Pango widget teardown crashes while scrolling\n- Related to previous P0 crash (nostrc-7lv) but still occurring\n- Widget lifecycle management is fundamentally broken\n- Appears to be race conditions between model updates and widget disposal\n\n### 2. \"New Notes\" Toast Delay\n- Noticeable delay when clicking New Notes before scrolling begins\n- Janky timeout causing poor UX\n- User expects immediate response, gets a pause instead\n- Makes the app feel unresponsive\n\n### 3. Sliding Window Implementation Inadequate\n- Current nostrdb-backed sliding window is not working correctly\n- Events not being efficiently loaded/unloaded as user scrolls\n- Memory management during scroll is causing crashes\n- Need fundamentally different approach\n\n## Requirements\n\n### Crash-Free Widget Management\n- Widget creation/destruction must NEVER race with model updates\n- All GTK operations must be on main thread with proper synchronization\n- Consider object pooling instead of create/destroy cycles\n- Implement defensive dispose patterns throughout\n\n### Smooth New Notes Experience\n- Clicking New Notes should scroll IMMEDIATELY\n- No visible delay or timeout\n- Pre-load content before showing toast so scroll is instant\n- Consider animating new content into view\n\n### Robust Sliding Window\n- Fixed-size window of materialized widgets (e.g., visible + 2 screens buffer)\n- nostrdb is source of truth - widgets just render what's needed\n- Scroll position maps directly to nostrdb query offset\n- Load ahead in scroll direction, release behind\n- Never block UI thread for data loading\n\n### Architecture Principles\n- Separation: data layer (nostrdb) vs view layer (GTK widgets)\n- Virtualization: only render what's visible + buffer\n- Predictability: deterministic widget lifecycle\n- Testability: can unit test model without GTK\n\n## Previous Attempts\n- hq-zcyxj: Timeline re-architecture (bruce) - improved but not sufficient\n- nostrc-7lv: P0 crash fix (boris) - patched symptom, not root cause\n\n## Acceptance Criteria\n- [ ] Zero crashes during aggressive scrolling for 10+ minutes\n- [ ] New Notes click-to-scroll latency \u003c 100ms\n- [ ] Smooth 60fps scrolling with 10k+ events in nostrdb\n- [ ] Memory usage bounded regardless of scroll history\n- [ ] Works reliably under ASAN\n\n## Notes\nThis is a P0 release blocker. The timeline is the core feature and must be rock solid.","status":"closed","priority":0,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-29T13:58:12.485674-08:00","created_by":"mayor","updated_at":"2026-01-29T15:51:18.972743-08:00","closed_at":"2026-01-29T15:51:18.972743-08:00","close_reason":"Timeline architecture overhaul complete"}
{"id":"nostrc-ovs","title":"Migrate nip39_identity.c from direct jansson to NostrJsonInterface","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T23:53:00.579608-08:00","updated_at":"2026-01-29T23:54:56.023101-08:00","closed_at":"2026-01-29T23:54:56.023101-08:00","close_reason":"Successfully migrated nip39_identity.c from direct jansson to NostrJsonInterface facade. Build verified."}
{"id":"nostrc-ox9","title":"Double nostrdb initialization attempt on startup","description":"Something is calling storage_ndb_init twice on startup:\n\n```\n[storage_ndb_init] ENTER: dbdir=/Users/bizarro/.cache/gnostr/ndb opts={...}\n[storage_ndb_init] Already initialized, returning success\n```\n\n**Current behavior:** Guard catches it and returns success (no crash).\n\n**Problem:** Indicates redundant initialization path - wasteful and could mask issues.\n\n**Investigation needed:**\n- Find all callers of storage_ndb_init\n- Determine which code path is calling twice\n- Remove redundant call or add init-once guard at caller level\n\n**Files:**\n- libnostr/src/store/nostrdb/ (storage_ndb_init)\n- Callers in app startup code","status":"closed","priority":3,"issue_type":"bug","assignee":"billy","created_at":"2026-01-31T16:00:13.406479-08:00","created_by":"mayor","updated_at":"2026-01-31T19:04:55.730198-08:00","closed_at":"2026-01-31T19:04:55.730198-08:00","close_reason":"Fixed in commit f9c339b - removed redundant ensure_ndb_initialized() from note_card_row.c"}
{"id":"nostrc-oxt","title":"Add libpeas dependency and plugin loader","description":"## Goal\n\nIntegrate libpeas into the build system and create the plugin loader/manager.\n\n## Tasks\n\n1. **Add libpeas to CMakeLists.txt**\n   - Find libpeas-2 and libpeas-gtk4-2 packages\n   - Link to gnostr executable\n\n2. **Create Plugin Manager**\n   - `gnostr-plugin-manager.c` - singleton to manage plugins\n   - Discover plugins from standard paths:\n     - `~/.local/share/gnostr/plugins/`\n     - `/usr/share/gnostr/plugins/`\n     - `${CMAKE_INSTALL_PREFIX}/share/gnostr/plugins/`\n   - Load/unload plugins\n   - Track enabled/disabled state via GSettings\n\n3. **Plugin Settings UI**\n   - Settings page to list available plugins\n   - Enable/disable toggle per plugin\n   - Plugin info display (name, description, version, author)\n\n4. **Plugin Template**\n   - Create example plugin skeleton\n   - Build instructions for plugin developers\n\n## Dependencies\n- Requires plugin API design (nostrc-5zi) to be finalized first","status":"closed","priority":2,"issue_type":"task","assignee":"boris","created_at":"2026-01-30T09:26:28.172925-08:00","created_by":"mayor","updated_at":"2026-01-30T13:44:04.602215-08:00","closed_at":"2026-01-30T13:44:04.602215-08:00","close_reason":"Closed","labels":["architecture"],"dependencies":[{"issue_id":"nostrc-oxt","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T09:26:33.167889-08:00","created_by":"mayor"},{"issue_id":"nostrc-oxt","depends_on_id":"nostrc-5zi","type":"blocks","created_at":"2026-01-30T09:26:33.233513-08:00","created_by":"mayor"}]}
{"id":"nostrc-oz5","title":"Fix profile display in threads panel","description":"## Problem\n\nProfile display in the threads panel has issues (noted during NIP-10/NIP-7D implementation).\n\n## Requirements\n\n- Audit profile loading in threads panel\n- Ensure proper async loading with placeholders\n- Handle missing/failed profile fetches gracefully\n- Use consistent profile display component across the app\n\n## Investigation Needed\n\n- Identify specific profile display bugs\n- Check if profiles are being fetched correctly\n- Verify profile cache integration\n- Test with missing profiles, slow loading, failed fetches\n\n## Related\n\nFollow-up from nostrc-71t (threads implementation) - profile fixes were in scope but not explicitly addressed.","status":"closed","priority":1,"issue_type":"bug","assignee":"boris","created_at":"2026-01-29T11:44:22.852308-08:00","created_by":"mayor","updated_at":"2026-01-29T19:55:54.896118-08:00","closed_at":"2026-01-29T19:55:54.896118-08:00","close_reason":"Fixed profile display in threads panel. The issue was that fetch_profile_for_pubkey() retrieved profiles from cache/DB but discarded them without updating UI widgets. Added helper functions to apply profile data immediately when available."}
{"id":"nostrc-ozu","title":"Migrate NIP-17 private DMs to plugin","description":"## Goal\n\nMigrate NIP-17 (Private Direct Messages) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip17/` - library code for gift-wrapped DMs\n- DM inbox/conversation UI in gnostr app\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip17-dms/`\n2. Move DM parsing/creation code\n3. Register event handlers:\n   - Kind 14 (chat message, gift-wrapped)\n   - Kind 1059 (gift wrap)\n4. Add UI hooks for:\n   - DM inbox view\n   - Conversation thread\n   - Compose DM dialog\n   - Unread indicators\n5. Settings:\n   - Read receipts\n   - Notification preferences\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete\n- Depends on NIP-44 (encryption) and NIP-59 (gift wrap) which remain core","status":"closed","priority":3,"issue_type":"task","assignee":"bruce","created_at":"2026-01-30T10:20:16.943295-08:00","created_by":"mayor","updated_at":"2026-01-31T15:16:17.623791-08:00","closed_at":"2026-01-31T15:16:17.623791-08:00","close_reason":"NIP-17 DMs plugin scaffolding complete. Implements GnostrPlugin and GnostrEventHandler interfaces. Builds and tests pass.","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-ozu","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T10:20:26.38845-08:00","created_by":"mayor"},{"issue_id":"nostrc-ozu","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T10:20:26.456805-08:00","created_by":"mayor"}]}
{"id":"nostrc-pgo1","title":"Add unbind+teardown callbacks to search-results-view factory","description":"The search results factory connects setup and bind signals but has NO unbind signal handler. When g_list_store_remove_all(self-\u003eresults_model) is called (lines 409, 460), NoteCardRows are disposed without prepare_for_unbind -\u003e Pango SEGV.\n\nFix: Added unbind_result_row and teardown_result_row callbacks that call gnostr_note_card_row_prepare_for_unbind, and connected them to the factory.","status":"closed","priority":0,"issue_type":"task","assignee":"nostrc/boris","created_at":"2026-02-11T00:16:23.029573-08:00","created_by":"boris","updated_at":"2026-02-11T00:16:23.029573-08:00","closed_at":"2026-02-11T00:16:23.029573-08:00","close_reason":"Added unbind_result_row and teardown_result_row callbacks to gnostr-search-results-view.c factory. Connected unbind+teardown signals. Compiles clean.","labels":["lifecycle","pango-segv"]}
{"id":"nostrc-pgo2","title":"Add prepare_for_unbind to repo-browser dispose for NoteCardRow cleanup","description":"NoteCardRows are created manually in create_repo_row() and added to a GtkListBox. rebuild_list already calls prepare_for_unbind before clearing, but gnostr_repo_browser_dispose tears down the widget tree (via gtk_widget_unparent) without calling prepare_for_unbind first -\u003e Pango SEGV on app shutdown or view destruction.\n\nFix: Added NoteCardRow iteration and prepare_for_unbind calls at the top of gnostr_repo_browser_dispose, before widget tree teardown.","status":"closed","priority":0,"issue_type":"task","assignee":"nostrc/boris","created_at":"2026-02-11T00:16:23.029573-08:00","created_by":"boris","updated_at":"2026-02-11T00:16:23.029573-08:00","closed_at":"2026-02-11T00:16:23.029573-08:00","close_reason":"Added NoteCardRow prepare_for_unbind iteration in gnostr_repo_browser_dispose before widget tree teardown. Walks ListBoxRow -\u003e Box -\u003e NoteCardRow hierarchy. Compiles clean.","labels":["lifecycle","pango-segv"]}
{"id":"nostrc-pko","title":"GTK crash in gtk_image_definition_unref - unreachable code","description":"Random crash with:\n```\nGtk:ERROR:../../../gtk/gtkimagedefinition.c:156:gtk_image_definition_unref: code should not be reached\n```\n\nThis indicates corrupted image reference counting in GTK internals. Likely causes:\n1. Double-free of a GtkImage or icon\n2. Using a GtkImage after it's been destroyed\n3. Corrupting the image definition type enum\n\nNeed to find what's triggering the invalid image_definition state.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-29T22:14:01.098396-08:00","created_by":"mayor","updated_at":"2026-01-29T22:37:18.608125-08:00","closed_at":"2026-01-29T22:37:18.608125-08:00","close_reason":"Fixed: Changed avatar/media async callbacks to use GWeakRef instead of g_object_ref. When widget is disposed during scrolling, weak ref returns NULL and callback safely skips the update."}
{"id":"nostrc-pkq","title":"Verify go_context_ref usage for connection_context race fix","description":"## Background\nnostrc-aak added refcounting to GoContext, but go_context_ref() is never called anywhere in the codebase. The fix only calls go_context_unref() in relay_free_impl.\n\n## Investigation Findings\n\n### Worker Threads (message_loop, write_operations)\nThe worker threads ARE properly synchronized:\n1. Workers call go_wait_group_done when they exit\n2. relay_free_impl calls go_wait_group_wait before freeing context\n3. By the time go_context_unref runs, all workers have exited\n4. **Conclusion: NO RACE for worker threads**\n\n### External API (nostr_relay_query_sync)\nThere IS a potential race condition in nostr_relay_query_sync (line 882):\n1. External code calls nostr_relay_query_sync\n2. It enters go_select with connection_context-\u003edone\n3. Meanwhile, relay is freed by another thread\n4. relay_free_impl waits for workers (but query_sync is NOT a worker)\n5. After workers exit, go_context_unref frees the context\n6. query_sync may still be in go_select, accessing freed memory\n\n**This is a real race condition that needs fixing.**\n\n## Recommended Fix\n\nAdd go_context_ref/unref around external API calls that access connection_context:\n\n```c\nNostrEvent **nostr_relay_query_sync(...) {\n    GoContext *ctx = relay-\u003epriv-\u003econnection_context;\n    go_context_ref(ctx);  // Hold a reference\n    // ... do work with go_select using ctx-\u003edone ...\n    go_context_unref(ctx);  // Release reference\n    return result;\n}\n```\n\n## References\n- Original fix: commit 687ace6\n- Original bug: nostrc-aak\n- Affected code: libnostr/src/relay.c:882","status":"closed","priority":2,"issue_type":"task","assignee":"billy","created_at":"2026-01-29T11:28:33.025833-08:00","created_by":"nostrc/crew/billy","updated_at":"2026-01-29T11:37:34.697899-08:00","closed_at":"2026-01-29T11:37:34.697899-08:00","close_reason":"Fixed: Added go_context_ref/unref to nostr_relay_query_sync to prevent use-after-free race when relay is freed while in go_select. Commit 1dae568."}
{"id":"nostrc-pvy","title":"Handle subscription backpressure - events dropped when queue full","description":"## Problem\n\nMassive event drops when subscription queue is full:\n```\n[WARN][sub] event drop: queue full sid=4\n[WARN][sub] event drop: queue full sid=4\n... (hundreds of times)\n```\n\nEvents are being produced by relay threads faster than the main thread can consume them, causing data loss.\n\n## Current Behavior\n\n- Fixed-size queue between relay threads and main thread\n- When queue is full, events are silently dropped with a warning\n- No backpressure signal to slow down producers\n- No metrics on how many events are lost\n\n## Desired Behavior\n\nOptions to consider:\n\n### 1. Backpressure to producers\n- Block or slow relay threads when queue is full\n- Risk: could cause relay connection issues\n\n### 2. Dynamic queue sizing\n- Grow queue when under pressure\n- Shrink when idle\n- Risk: memory usage\n\n### 3. Prioritized dropping\n- Drop older events first (keep recent)\n- Drop by event kind priority\n- Never drop certain critical events (DMs, zaps)\n\n### 4. Batch processing\n- Process events in larger batches on main thread\n- Reduce per-event overhead\n\n### 5. Rate limiting at source\n- Tell relays to slow down (CLOSE/resubscribe)\n- Request smaller time windows\n\n## Files Involved\n\n- libnostr/src/nostr_simple_pool.c (queue management)\n- libnostr/src/relay.c (producer side)\n- apps/gnostr/src/ui/gnostr-main-window.c (consumer side)\n\n## Metrics Needed\n\n- Queue depth over time\n- Events dropped per second\n- Processing latency","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-30T11:20:10.627021-08:00","created_by":"mayor","updated_at":"2026-01-31T13:59:35.023873-08:00","closed_at":"2026-01-31T13:59:35.023873-08:00","close_reason":"All 4 child iterations complete per billy","labels":["p1","performance","reliability"],"dependencies":[{"issue_id":"nostrc-pvy","depends_on_id":"nostrc-o56","type":"related","created_at":"2026-01-30T11:20:15.240965-08:00","created_by":"mayor"}]}
{"id":"nostrc-py1","title":"Relay brown list for persistently failing relays","description":"## Feature\n\nImplement a \"brown list\" for relays that consistently fail to connect. After N failed attempts (when network is otherwise up), temporarily exclude the relay from connection attempts.\n\n## Requirements\n\n### Brown List Logic\n- Track consecutive connection failures per relay\n- After 3 failed attempts (configurable), add relay to brown list\n- Brown-listed relays are not retried for a configurable timeout\n- Reset failure count on successful connection\n- Only brown-list if other relays are connecting (network is up)\n\n### Configuration\n- `brown_list_threshold`: Number of failures before brown-listing (default: 3)\n- `brown_list_timeout`: How long to exclude relay (default: 30 minutes)\n- Per-relay or global settings\n- User can manually clear brown list\n\n### State Tracking\n- Brown list stored persistently (survives app restart)\n- Track: relay URL, failure count, brown-listed timestamp, expiry time\n- Automatic expiry and retry after timeout\n\n### User Feedback\n- Show brown-listed relays in relay settings\n- Indicate why relay is brown-listed (failure count, time remaining)\n- Allow manual retry / remove from brown list\n- Optional notification when relay is brown-listed\n\n## Relationship to Reconnection\n\nThis builds on nostrc-4du (exponential backoff). After backoff attempts exhaust:\n1. Exponential backoff handles temporary failures\n2. Brown list handles persistently dead relays\n3. Prevents wasting resources on known-bad relays\n\n## Acceptance Criteria\n\n- [ ] Relays brown-listed after 3 consecutive failures\n- [ ] Brown-listed relays not retried until timeout expires\n- [ ] Only brown-list when network is confirmed up (other relays work)\n- [ ] User can view and clear brown list\n- [ ] Configurable threshold and timeout\n- [ ] Persists across app restarts","status":"closed","priority":2,"issue_type":"feature","assignee":"billy","created_at":"2026-01-29T13:11:47.103502-08:00","created_by":"mayor","updated_at":"2026-01-29T22:52:55.39549-08:00","closed_at":"2026-01-29T22:52:55.39549-08:00","close_reason":"Implemented relay brown list with configurable threshold (3 failures), timeout (30 min), network health awareness, automatic recovery, and optional persistence. Integrated with NostrSimplePool.","dependencies":[{"issue_id":"nostrc-py1","depends_on_id":"nostrc-4du","type":"blocks","created_at":"2026-01-29T13:11:53.870442-08:00","created_by":"mayor"}]}
{"id":"nostrc-q42","title":"Discover Relay dialog shows spinner but never loads relays","description":"## Problem\n\nThe Discover Relay dialog shows spinner but never populates relays.\n\n## Root Cause\n\nThe two-phase discovery approach is overly complex and fragile:\n\n1. **Phase 1**: Query kind 10166 (monitor announcements) - often returns nothing\n2. **Phase 2**: Query kind 30166 filtered by discovered monitor pubkeys - fails if phase 1 is empty\n\n**The fix**: Query kind 30166 directly WITHOUT author filter. Relay metadata events are addressable (d-tag = relay URL) and can be fetched directly.\n\n## Correct Approach (per NIP-66 spec)\n\n```json\n{\"kinds\": [30166], \"limit\": 500}\n```\n\nThat's it. No need to:\n- Find monitors first (kind 10166)\n- Filter by author pubkeys\n- Do two-phase discovery\n\n## Files to Fix\n\n- `apps/gnostr/src/util/nip66_relay_discovery.c`\n  - Simplify `gnostr_nip66_discover_relays_async()` to just query kind 30166 directly\n  - Remove the two-phase monitor discovery logic\n  - Process returned kind 30166 events through existing `gnostr_nip66_parse_relay_meta()`\n\n## Example kind 30166 event\n\n```json\n{\n  \"kind\": 30166,\n  \"tags\": [\n    [\"d\", \"wss://relay.piazza.today/\"],\n    [\"rtt-open\", \"858\"],\n    [\"N\", \"1\"], [\"N\", \"2\"], ...\n    [\"R\", \"!auth\"], [\"R\", \"ssl\"],\n    [\"l\", \"Germany\", \"countryName\"]\n  ],\n  \"content\": \"{\\\"name\\\":\\\"Piazza Today\\\", \\\"supported_nips\\\":[1,2,4,...]}\"\n}\n```","status":"closed","priority":1,"issue_type":"bug","assignee":"boris","created_at":"2026-01-30T02:20:10.940085-08:00","created_by":"mayor","updated_at":"2026-01-30T13:38:17.477225-08:00","closed_at":"2026-01-30T13:38:17.477225-08:00","close_reason":"Simplified: Query kind 30166 directly without author filter. Removed two-phase discovery. Commit 15fa7d4."}
{"id":"nostrc-q9m","title":"Add control overlay to fullscreen video with esc-to-close toast","description":"## Feature\n\nAdd a control overlay when viewing videos in fullscreen mode.\n\n## Requirements\n\n- Show control overlay on fullscreen video (play/pause, seek, volume, etc.)\n- Display toast/hint showing \"Press Esc to exit fullscreen\"\n- Esc key should close fullscreen and return to normal view\n- Controls should auto-hide after a few seconds of inactivity\n- Show controls on mouse movement or tap\n\n## Notes\n\nLow priority UX enhancement for video playback.","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-01-29T12:08:02.495341-08:00","created_by":"mayor","updated_at":"2026-01-30T12:14:23.90976-08:00","closed_at":"2026-01-30T12:14:23.90976-08:00","close_reason":"Verified implementation complete: fullscreen toast, Esc-to-close, auto-hiding controls. Dependency on nostrc-1wx resolved.","dependencies":[{"issue_id":"nostrc-q9m","depends_on_id":"nostrc-1wx","type":"blocks","created_at":"2026-01-30T02:00:05.637641-08:00","created_by":"mayor"}]}
{"id":"nostrc-qff","title":"Batch reaction/zap queries - eliminate N+1 pattern","description":"Every visible timeline event triggers separate queries for reaction count and zap stats. 50 events = 100 queries. Fix: single bulk query with in-app grouping, or use ndb_note_meta. See storage_ndb_count_reactions() and storage_ndb_get_zap_stats() call sites in gnostr-timeline-view.c.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-07T17:20:11.9681-08:00","created_by":"mayor","updated_at":"2026-02-07T18:40:02.189018-08:00","closed_at":"2026-02-07T18:40:02.189018-08:00","close_reason":"Closed"}
{"id":"nostrc-qm77","title":"Not all profile images appear to be loaded","description":"Some profile avatars/images are not loading. Incomplete image fetching for user profiles.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/barry","created_at":"2026-02-08T13:54:28.85738-08:00","created_by":"mayor","updated_at":"2026-02-08T14:33:09.654762-08:00","closed_at":"2026-02-08T14:33:09.654762-08:00","close_reason":"All three image bugs fixed by barry in c701617: GVfs‚Üílibsoup3 for thumbnails, cache-first avatar lookup, dangling pointer in image viewer"}
{"id":"nostrc-qt6","title":"Thread ancestors not fetched/displayed - incomplete thread trees","description":"Threads still not showing complete parent chain to root.\n\n**Symptoms:**\n- Parent events not being fetched from relays\n- Or if fetched, not being displayed in thread view\n- Results in incomplete/rootless thread trees\n\n**Related bugs:**\n- hq-lo184: NIP-10 5-element e-tag parsing\n- nostrc-7r5: Relay hints ignored (FIXED: 289f3f8)\n\n**Possible causes:**\n1. Fetched events not being inserted into nostrdb\n2. Thread view query not finding inserted ancestors\n3. Fetch happening but response not processed\n4. Events fetched but UI not refreshed\n\n**Investigation needed:**\n- Add logging to trace: fetch request ‚Üí response ‚Üí db insert ‚Üí UI display\n- Verify events are actually arriving from relay hints\n- Check if nostrdb has the events after fetch\n- Check thread view query logic","status":"closed","priority":1,"issue_type":"bug","assignee":"boris","created_at":"2026-01-31T16:12:11.269931-08:00","created_by":"mayor","updated_at":"2026-01-31T16:23:56.178804-08:00","closed_at":"2026-01-31T16:23:56.178804-08:00","close_reason":"Added diagnostic logging in 5642b4d. Relay hints fix (289f3f8) should address root cause. Logging will help verify."}
{"id":"nostrc-qt9q","title":"Article reader GBytes leak + NULL crash + use-after-dispose race","description":"From bruce stress test (nostrc-8bxd): article-reader has GBytes leak (10MB/image), NULL crash if stream read fails, and use-after-dispose race on header image callback.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/barry","created_at":"2026-02-08T17:39:35.318011-08:00","created_by":"mayor","updated_at":"2026-02-08T20:03:51.540261-08:00","closed_at":"2026-02-08T20:03:51.540261-08:00","close_reason":"Fixed by barry in 87a0cb0 - dispose race guard + json memory leak"}
{"id":"nostrc-r01","title":"Remove 'avatar http: fetched' log messages to reduce noise","description":"Remove or reduce verbosity of avatar fetch log messages:\n\n```\navatar http: fetched ...\n```\n\nThese messages are cluttering logs. Either:\n- Remove entirely\n- Change to DEBUG level\n- Rate-limit/batch the logging\n\nQuick grep-and-fix task.","status":"closed","priority":4,"issue_type":"task","assignee":"bruce","created_at":"2026-01-31T17:45:36.131178-08:00","created_by":"mayor","updated_at":"2026-01-31T18:25:39.61118-08:00","closed_at":"2026-01-31T18:25:39.61118-08:00","close_reason":"Fixed by bruce: 0c1c093 - downgrade to DEBUG"}
{"id":"nostrc-rfva","title":"Profile view media tab doesn't load thumbnails or images","description":"The media tab on user profiles fails to load thumbnails and images. Previously worked but now broken.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/barry","created_at":"2026-02-08T13:54:23.70112-08:00","created_by":"mayor","updated_at":"2026-02-08T14:33:09.653409-08:00","closed_at":"2026-02-08T14:33:09.653409-08:00","close_reason":"All three image bugs fixed by barry in c701617: GVfs‚Üílibsoup3 for thumbnails, cache-first avatar lookup, dangling pointer in image viewer"}
{"id":"nostrc-ro0","title":"Timeline images not loading but visible in image viewer on click","description":"Images in timeline don't display, but clicking them opens the image viewer with the image visible.\n\n**Symptoms:**\n- Timeline shows placeholder/empty space for images\n- Clicking the image area opens viewer with correct image\n- Image data IS being fetched (viewer works)\n\n**This indicates:**\n- Image fetch/cache working correctly\n- Problem is in timeline thumbnail rendering, not data loading\n\n**Possible causes:**\n1. Thumbnail widget not receiving/displaying texture\n2. Sizing/allocation issue hiding the image\n3. Thumbnail generation failing but full image works\n4. Widget visibility or opacity issue\n\n**Investigation:**\n- Check if thumbnail widget gets the pixbuf/texture\n- Verify widget allocation (width/height \u003e 0)\n- Check CSS/opacity on timeline image widgets\n- Compare thumbnail code path vs viewer code path","status":"closed","priority":2,"issue_type":"bug","assignee":"barry","created_at":"2026-01-31T16:55:44.934932-08:00","created_by":"mayor","updated_at":"2026-01-31T16:58:01.265101-08:00","closed_at":"2026-01-31T16:58:01.265101-08:00","close_reason":"Resolved by recent commit - timeline images now loading"}
{"id":"nostrc-rvzp","title":"Some images display in timeline but not in image viewer","description":"Images render correctly in the timeline feed but fail to display when opened in the dedicated image viewer. Likely a loading or URL handling issue in the image viewer component.","status":"closed","priority":2,"issue_type":"bug","assignee":"nostrc/barry","created_at":"2026-02-08T13:54:34.018407-08:00","created_by":"mayor","updated_at":"2026-02-08T14:33:09.655419-08:00","closed_at":"2026-02-08T14:33:09.655419-08:00","close_reason":"All three image bugs fixed by barry in c701617: GVfs‚Üílibsoup3 for thumbnails, cache-first avatar lookup, dangling pointer in image viewer"}
{"id":"nostrc-s23b","title":"Implement NIP-65 relay list metadata","description":"NIP-65 defines kind 10002 relay list metadata ‚Äî user's preferred relays with read/write markers. Currently relay lists are hardcoded or from GSettings.\n\nImplement:\n- Parse kind 10002 events for relay preferences\n- Publish own relay list on settings change\n- Use other users' relay lists for targeted message delivery (outbox model)\n- Relay picker UI that reads from kind 10002\n- Fallback to default relays when no list published","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-02-08T12:55:32.649913-08:00","created_by":"mayor","updated_at":"2026-02-08T14:10:43.371037-08:00","closed_at":"2026-02-08T14:10:43.371037-08:00","close_reason":"Already fully implemented - NIP-65 core lib, app layer, outbox model, UI all present"}
{"id":"nostrc-s2m3","title":"harden-2+3: Fix auto-close + main window raw timers","status":"open","priority":0,"issue_type":"bug","assignee":"billy","created_at":"2026-02-10T16:44:45.409976-08:00","created_by":"mayor","updated_at":"2026-02-10T16:44:45.409976-08:00"}
{"id":"nostrc-sbqe","title":"Phase 4: Architectural Improvements","description":"Future architectural improvements. Requires Phases 2-3 to prove value before starting. More design work needed.","status":"closed","priority":3,"issue_type":"epic","created_at":"2026-02-10T22:39:28.783484-08:00","created_by":"mayor","updated_at":"2026-02-10T23:44:17.107308-08:00","closed_at":"2026-02-10T23:44:17.107308-08:00","close_reason":"Phase 4 complete: worker thread (4A), NDB dedup (4B), tiered bind (4C)"}
{"id":"nostrc-sbqe.1","title":"4A: Move item creation to worker thread","description":"Dispatcher dispatches note keys to a dedicated worker thread that owns NDB transactions, does populate_from_note, mute checks, and dedup. Main thread only receives pre-built items and inserts into model.\n\nRequires Phase 2A (cached render result) to be complete first.","status":"closed","priority":1,"issue_type":"feature","assignee":"barry","created_at":"2026-02-10T22:41:12.106183-08:00","created_by":"mayor","updated_at":"2026-02-10T23:40:54.418868-08:00","closed_at":"2026-02-10T23:40:54.418868-08:00","close_reason":"Moved NDB batch processing to GTask worker thread. on_sub_timeline_batch now dispatches to batch_process_thread_func (NDB reads, kind/mute checks). batch_process_complete_cb on main thread does dedup + pipeline insert + signals. Clean thread safety.","dependencies":[{"issue_id":"nostrc-sbqe.1","depends_on_id":"nostrc-sbqe","type":"parent-child","created_at":"2026-02-10T22:41:12.107142-08:00","created_by":"mayor"},{"issue_id":"nostrc-sbqe.1","depends_on_id":"nostrc-dqwq.1","type":"blocks","created_at":"2026-02-10T22:41:46.465099-08:00","created_by":"mayor"}]}
{"id":"nostrc-sbqe.2","title":"4B: Earlier dedup in NDB dispatcher","description":"Maintain a shared set of recently-dispatched note keys at the dispatcher level. Filter duplicates before invoking model handlers. Reduces handler invocations by 30-50% when connected to 5+ relays.\n\nFile: gobject/src/gn-ndb-sub-dispatcher.c","status":"closed","priority":1,"issue_type":"feature","assignee":"boris","created_at":"2026-02-10T22:41:17.230029-08:00","created_by":"mayor","updated_at":"2026-02-10T23:36:44.884039-08:00","closed_at":"2026-02-10T23:36:44.884039-08:00","close_reason":"Per-subid dedup in NDB dispatcher","dependencies":[{"issue_id":"nostrc-sbqe.2","depends_on_id":"nostrc-sbqe","type":"parent-child","created_at":"2026-02-10T22:41:17.230728-08:00","created_by":"mayor"}]}
{"id":"nostrc-sbqe.3","title":"4C: Tiered bind (minimal bind + deferred visibility)","description":"Split bind into Tier 1 (3 labels: author, timestamp, content) and Tier 2 (media, embeds, OG, NIP-05, reactions ‚Äî on map signal). Fast scroll only pays Tier 1 cost.\n\nBuilds on Phase 2B (deferred media creation).","status":"closed","priority":1,"issue_type":"feature","assignee":"billy","created_at":"2026-02-10T22:41:22.367493-08:00","created_by":"mayor","updated_at":"2026-02-10T23:44:11.92208-08:00","closed_at":"2026-02-10T23:44:11.92208-08:00","close_reason":"Tiered bind across all 3 factory paths. Tier 1 (immediate): author name, timestamp, content markup, IDs. Tier 2 (map signal): avatar, NIP-05, media, OG, embeds, profile signals, thread info. Event ID validation on map to detect recycled rows.","dependencies":[{"issue_id":"nostrc-sbqe.3","depends_on_id":"nostrc-sbqe","type":"parent-child","created_at":"2026-02-10T22:41:22.36864-08:00","created_by":"mayor"},{"issue_id":"nostrc-sbqe.3","depends_on_id":"nostrc-dqwq.2","type":"blocks","created_at":"2026-02-10T22:41:51.57603-08:00","created_by":"mayor"}]}
{"id":"nostrc-sjv","title":"Add queue health metrics instrumentation","description":"## Goal\n\nAdd instrumentation to measure queue health baseline before optimizing.\n\n## Metrics to Track\n\n### Queue Stats (per subscription)\n```c\ntypedef struct {\n  guint64 events_enqueued;      // Total events added to queue\n  guint64 events_dequeued;      // Total events processed\n  guint64 events_dropped;       // Total events dropped (queue full)\n  guint current_depth;          // Current queue size\n  guint peak_depth;             // High water mark\n  guint queue_capacity;         // Max queue size\n  gint64 last_enqueue_time_us;  // Timestamp of last enqueue\n  gint64 last_dequeue_time_us;  // Timestamp of last dequeue\n  gint64 total_wait_time_us;    // Cumulative time events spent in queue\n} QueueMetrics;\n```\n\n### Derived Metrics\n- **Drop rate**: events_dropped / events_enqueued (target: \u003c 0.1%)\n- **Queue utilization**: current_depth / queue_capacity (target: \u003c 80%)\n- **Avg latency**: total_wait_time_us / events_dequeued (target: \u003c 100ms)\n- **Throughput**: events_dequeued / time_window (events/sec)\n\n## Implementation\n\n1. Add QueueMetrics struct to subscription context\n2. Update counters at enqueue/dequeue/drop points\n3. Add `gnostr_simple_pool_get_queue_metrics()` API\n4. Log summary every 60 seconds at DEBUG level\n5. Expose via GObject properties for UI display\n\n## Baseline Targets\n\n| Metric | Acceptable | Warning | Critical |\n|--------|------------|---------|----------|\n| Drop rate | \u003c 0.1% | 0.1-1% | \u003e 1% |\n| Queue util | \u003c 80% | 80-95% | \u003e 95% |\n| Latency | \u003c 100ms | 100-500ms | \u003e 500ms |\n\n## Files to Modify\n\n- libnostr/src/nostr_simple_pool.c\n- libnostr/include/nostr/simple_pool.h","notes":"Implemented queue health metrics instrumentation:\n\n## Changes\n- Added QueueMetrics struct to subscription-private.h with all requested fields\n- Updated subscription.c to track metrics at enqueue/drop points\n- Added nostr_subscription_mark_event_consumed() for dequeue tracking\n- Added nostr_subscription_get_queue_metrics() API\n- Added gnostr_simple_pool_get_queue_metrics() for pool-level aggregation\n- Added periodic DEBUG logging every 60 seconds\n\n## API\n- NostrQueueMetrics struct with events_enqueued/dequeued/dropped, depth, peak, capacity, timestamps\n- GnostrQueueMetrics struct aggregates across all subscriptions in pool\n\nAll subscription tests pass.","status":"closed","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-01-30T11:28:07.813673-08:00","created_by":"mayor","updated_at":"2026-01-30T13:16:53.115038-08:00","closed_at":"2026-01-30T13:16:53.115038-08:00","close_reason":"Closed","labels":["instrumentation","metrics"],"dependencies":[{"issue_id":"nostrc-sjv","depends_on_id":"nostrc-pvy","type":"parent-child","created_at":"2026-01-30T11:28:41.922094-08:00","created_by":"mayor"}]}
{"id":"nostrc-sln","title":"ASAN: heap-use-after-free in emit_batch_sorted (nostr_simple_pool.c:198)","description":"Race condition crash on exit.\n\n**Stack trace:**\n- READ at nostr_simple_pool.c:198 in emit_batch_sorted\n- Freed at nostr_simple_pool.c:129 in emit_events_on_main  \n- Allocated at nostr_simple_pool.c:535 in subscribe_many_thread\n\n**Root cause:**\nThread T23 (subscribe_many_thread) allocates a GPtrArray, passes it to main thread via g_main_context_invoke (emit_events_on_main), which frees it. But T23 continues and reads from the freed array at line 198.\n\n**Fix approach:**\nEither:\n1. Don't free in emit_events_on_main - let caller free after invoke returns\n2. Copy data before invoking main thread\n3. Use refcounting on the batch array\n\nFile: gobject/src/nostr_simple_pool.c","notes":"Fixed duplicate batch_len declaration from parallel fix attempts. Removed redundant declaration.","status":"closed","priority":1,"issue_type":"bug","assignee":"bruce","created_at":"2026-01-31T13:06:32.048315-08:00","created_by":"mayor","updated_at":"2026-01-31T13:42:05.61201-08:00","closed_at":"2026-01-31T13:42:05.612012-08:00","close_reason":"Fixed by billy in commit 91e6058 - cache batch-\u003elen before invoke","dependencies":[{"issue_id":"nostrc-sln","depends_on_id":"nostrc-d6j","type":"blocks","created_at":"2026-01-31T13:34:44.238402-08:00","created_by":"mayor"}]}
{"id":"nostrc-sx2","title":"Audit and consolidate all duplicate parsers/handlers across codebase","description":"The codebase has multiple duplicate implementations of the same functionality scattered across files. This leads to bugs (like nostrc-mef) where fixes are applied to one location but not others.\n\nAUDIT SCOPE:\n1. NIP-related parsing (NIP-10 threads, NIP-25 reactions, NIP-57 zaps, etc.)\n2. Event kind handlers (kind 0 profiles, kind 1 notes, kind 7 reactions, etc.)\n3. Tag parsing (e-tags, p-tags, t-tags, etc.)\n4. JSON parsing utilities\n5. Nostr protocol utilities (signature verification, event creation, etc.)\n\nCONSOLIDATION RULES:\n1. NIP-related code without GLib/GTK dependencies ‚Üí nips/\u003cnip-number\u003e/ folder\n2. NIP-related code WITH GLib/GTK dependencies ‚Üí gobject/src/nip\u003cnumber\u003e/ or apps/gnostr/src/nip\u003cnumber\u003e/\n3. One canonical implementation per concept - no duplicates\n4. All callers refactored to use the canonical implementation\n\nDELIVERABLES:\n1. List of all duplicate implementations found\n2. Proposed consolidation plan (which impl becomes canonical)\n3. Refactoring to eliminate duplicates\n4. Tests for canonical implementations","status":"closed","priority":1,"issue_type":"task","assignee":"bruce","created_at":"2026-01-29T17:04:27.978916-08:00","created_by":"mayor","updated_at":"2026-01-29T19:54:56.069397-08:00","closed_at":"2026-01-29T19:54:56.069397-08:00","close_reason":"Audit complete. Found 23+ duplicate parser/handler implementations across 8 categories. Full report in refinery/rig/docs/PARSER_AUDIT_nostrc-sx2.md. Consolidation work tracked as follow-up.","labels":["status:in_progress"]}
{"id":"nostrc-sx2.1","title":"State change: status ‚Üí in_progress","description":"Set status to in_progress","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-29T19:52:17.921236-08:00","created_by":"mayor","updated_at":"2026-01-29T19:52:17.921236-08:00","dependencies":[{"issue_id":"nostrc-sx2.1","depends_on_id":"nostrc-sx2","type":"parent-child","created_at":"2026-01-29T19:52:17.922048-08:00","created_by":"mayor"}]}
{"id":"nostrc-szl","title":"Subscription lifecycle issue: subs closing too soon, EOSE for unknown subs","description":"## Problem\n\nSubscriptions are being closed prematurely and EOSE (End of Stored Events) messages are arriving for subscriptions that are no longer known/tracked.\n\n## Symptoms\n\n- EOSE messages received for unknown subscription IDs\n- Subscriptions appear to close before expected\n- Possible data loss from events arriving after sub closed\n\n## Possible Causes\n\n1. **Timeout too aggressive**\n   - Subscription timeout firing before relay responds\n   - Slow relays triggering premature closure\n\n2. **Processing backpressure**\n   - Event processing not keeping up with incoming data\n   - Queue backup causing timeout to fire\n   - Data flow being choked\n\n3. **Race condition**\n   - Sub closed while EOSE still in flight\n   - Cleanup racing with incoming messages\n\n4. **Reference counting**\n   - Sub object freed while relay still referencing it\n   - Sub ID removed from tracking table too early\n\n## Investigation\n\n1. Add logging for subscription lifecycle (open, EOSE, close, timeout)\n2. Check timeout values - are they appropriate for slow relays?\n3. Trace what triggers subscription closure\n4. Check if event processing queue is backing up\n5. Verify sub ID tracking table management\n6. Look for races between relay message handling and sub cleanup\n\n## Related\n\nMay be related to the data flow and timeline architecture - if events are being processed slowly, timeouts could fire prematurely.","status":"closed","priority":1,"issue_type":"bug","assignee":"billy","created_at":"2026-01-29T12:12:59.364844-08:00","created_by":"mayor","updated_at":"2026-01-29T12:35:21.05188-08:00","closed_at":"2026-01-29T12:35:21.05188-08:00","close_reason":"Fixed EOSE late arrival logging: Added lifecycle logging (NOSTR_DEBUG_LIFECYCLE env), changed EOSE_LATE from ERROR to debug+metric since it's expected behavior when timeouts fire."}
{"id":"nostrc-tbv","title":"Implement streaming result cursors for large NDB queries","description":"Currently queries allocate arrays of 256+ results and buffer all in memory. Could use LMDB range cursors to stream results page-by-page, reducing peak memory usage for large query sets. Implement cursor-based pagination in ndb_query wrapper.","status":"closed","priority":3,"issue_type":"task","assignee":"nostrc/billy","created_at":"2026-02-07T17:20:48.202075-08:00","created_by":"mayor","updated_at":"2026-02-08T02:57:40.198916-08:00","closed_at":"2026-02-08T02:57:40.198916-08:00","close_reason":"Closed"}
{"id":"nostrc-tel","title":"Package: macOS Homebrew formula","description":"## Goal\n\nCreate Homebrew formula for easy macOS installation via `brew install gnostr`.\n\n## Tasks\n\n1. Create formula\n   - Formula file (gnostr.rb)\n   - Dependencies: gtk4, libadwaita, gstreamer, etc.\n   - Build from source or bottle\n\n2. Homebrew tap\n   - Create homebrew-gnostr tap repo\n   - Host formula there initially\n   - Later: submit to homebrew-core\n\n3. CI workflow\n   - Test formula builds on macOS\n   - Create bottles for Intel and Apple Silicon\n   - Upload bottles\n\n## Installation\n```bash\nbrew tap gnostr/gnostr\nbrew install gnostr\n```","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T10:59:59.9809-08:00","created_by":"mayor","updated_at":"2026-01-30T12:23:26.661362-08:00","closed_at":"2026-01-30T12:23:26.661362-08:00","close_reason":"Homebrew formulas created: gnostr.rb, gnostr-signer.rb with README documentation","labels":["deployment","macos"],"dependencies":[{"issue_id":"nostrc-tel","depends_on_id":"nostrc-bn3","type":"parent-child","created_at":"2026-01-30T11:00:25.331929-08:00","created_by":"mayor"}]}
{"id":"nostrc-tkti","title":"harden-4+5: Fix vadjustment leak + relay registry TOCTOU","status":"open","priority":1,"issue_type":"bug","assignee":"boris","created_at":"2026-02-10T16:44:50.563314-08:00","created_by":"mayor","updated_at":"2026-02-10T16:44:50.563314-08:00"}
{"id":"nostrc-ues","title":"Build error: events_dropped missing from SubscriptionPrivate struct","description":"**Error**: Test file references `sub-\u003epriv-\u003eevents_dropped` but field doesn't exist in SubscriptionPrivate.\n\n**Location**: tests/test_subscription_lifecycle.c:173\n\n**Root cause**: Test was committed but the struct field addition in subscription-private.h wasn't synced.\n\n**Fix**: Add to subscription-private.h:\n```c\n_Atomic uint64_t events_enqueued;\n_Atomic uint64_t events_dropped;\n```\n\nOr remove/guard the test assertion until the metrics fields are properly added.","notes":"Fixed by updating tests to use public API nostr_subscription_events_dropped() instead of directly accessing internal struct fields. The fields were moved into QueueMetrics struct in nostrc-sjv.","status":"closed","priority":0,"issue_type":"bug","assignee":"billy","created_at":"2026-01-30T13:29:12.898854-08:00","created_by":"mayor","updated_at":"2026-01-30T13:42:19.307202-08:00","closed_at":"2026-01-30T13:42:19.307202-08:00","close_reason":"Closed"}
{"id":"nostrc-ugrw","title":"Signal handler disconnect errors: instance has no handler with id","description":"Timeline spammed with GLib-GObject-CRITICAL: instance has no handler with id NNNN. Signal handlers being disconnected from wrong instance or after handler already removed. Likely related to nostrc-img1 lazy-load signal handler disconnect fix or GNostrRelay state signal watchers in pools.","status":"closed","priority":2,"issue_type":"bug","assignee":"crew","created_at":"2026-02-09T17:10:52.462309-08:00","created_by":"mayor","updated_at":"2026-02-09T17:15:39.048536-08:00","closed_at":"2026-02-09T17:15:39.048536-08:00","close_reason":"Fixed in nostrc-img2: weak ref callback during GtkPicture finalization now NULLs out picture and handler IDs to skip already-cleared signal handlers"}
{"id":"nostrc-uhd","title":"Migrate NIP-55 Android Signer to plugin","description":"## Goal\n\nMigrate NIP-55 (Android Signer Application) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip55l/` - Android signer operations\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip55-androidsigner/`\n2. Move Android signer bridge\n3. Plugin API for signer operations (similar to NIP-46):\n   ```c\n   void gnostr_nip55_sign_event(plugin, event, callback);\n   void gnostr_nip55_get_public_key(plugin, callback);\n   ```\n4. Add UI hooks for:\n   - Android signer detection\n   - Permission requests\n   - Signer selection\n\n## Platform Notes\n- Only relevant on Android\n- Plugin should gracefully no-op on other platforms\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"closed","priority":3,"issue_type":"task","assignee":"billy","created_at":"2026-01-30T10:20:55.301211-08:00","created_by":"mayor","updated_at":"2026-01-31T17:49:29.728078-08:00","closed_at":"2026-01-31T17:49:29.728078-08:00","close_reason":"Completed by billy","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-uhd","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T10:20:59.585115-08:00","created_by":"mayor"},{"issue_id":"nostrc-uhd","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T10:20:59.653466-08:00","created_by":"mayor"}]}
{"id":"nostrc-v2se","title":"nostr_glib_event test segfaults after json-roundtrip","description":"Test 2/5 (nostr_glib_event) segfaults after json-roundtrip test. Likely regression from 5c256bd (nostrc-737 structured error reporting in JSON parsers). Needs investigation and fix.","status":"closed","priority":1,"issue_type":"bug","assignee":"nostrc/brett","created_at":"2026-02-08T12:51:15.20112-08:00","created_by":"mayor","updated_at":"2026-02-08T12:55:07.632212-08:00","closed_at":"2026-02-08T12:55:07.632212-08:00","close_reason":"Closed"}
{"id":"nostrc-vtv","title":"Review bruce's audit bug fixes","description":"## Objective\n\nReview bruce's fixes for the 4 audit bugs and verify they are correct.\n\n## Bugs to Review\n\n1. **nostrc-aak** [P1]: Memory leak - connection_context not freed in relay.c\n2. **nostrc-5o5** [P1]: Memory leak - conn-\u003epriv not freed when service thread running  \n3. **nostrc-d6t** [P1]: Profile provider not thread-safe (crash risk)\n4. **nostrc-0v0** [P2]: Invalid signature tracking list grows unbounded\n\n## Review Checklist\n\nFor each fix:\n- [ ] Verify the memory leak/race is actually fixed\n- [ ] Check for new issues introduced by the fix\n- [ ] Confirm no regressions in related code paths\n- [ ] Validate thread safety where applicable\n\n## Deliverables\n\n- File beads for any issues found in the fixes\n- Brief summary confirming fixes are correct or noting problems","status":"closed","priority":1,"issue_type":"task","assignee":"billy","created_at":"2026-01-29T10:37:07.936463-08:00","created_by":"mayor","updated_at":"2026-01-29T11:28:44.483199-08:00","closed_at":"2026-01-29T11:28:44.483199-08:00","close_reason":"Review complete: 3 of 4 fixes verified correct. Filed nostrc-pkq for potential issue with nostrc-aak refcount fix - infrastructure is correct but go_context_ref() is never called, may not fully fix the race.","dependencies":[{"issue_id":"nostrc-vtv","depends_on_id":"nostrc-aak","type":"blocks","created_at":"2026-01-29T10:37:15.658847-08:00","created_by":"mayor"},{"issue_id":"nostrc-vtv","depends_on_id":"nostrc-5o5","type":"blocks","created_at":"2026-01-29T10:37:15.71268-08:00","created_by":"mayor"},{"issue_id":"nostrc-vtv","depends_on_id":"nostrc-d6t","type":"blocks","created_at":"2026-01-29T10:37:15.761042-08:00","created_by":"mayor"},{"issue_id":"nostrc-vtv","depends_on_id":"nostrc-0v0","type":"blocks","created_at":"2026-01-29T10:37:15.823682-08:00","created_by":"mayor"}]}
{"id":"nostrc-w0n","title":"Re-enable NDB signature verification","description":"NDB_FLAG_SKIP_NOTE_VERIFY is currently ON (disabled for testing). This is a security concern for production - unverified events could be injected. Re-enable verification. Profile the performance impact and optimize if needed (verification is CPU-bound but multi-threaded ingester should handle it).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T17:20:27.518226-08:00","created_by":"mayor","updated_at":"2026-02-07T18:39:34.911678-08:00","closed_at":"2026-02-07T18:39:34.911678-08:00","close_reason":"Closed"}
{"id":"nostrc-x3on","title":"Back chevron in thread view causes app stall requiring restart","status":"in_progress","priority":1,"issue_type":"bug","assignee":"bruce","created_at":"2026-02-08T20:04:24.663014-08:00","created_by":"mayor","updated_at":"2026-02-08T20:04:53.182087-08:00"}
{"id":"nostrc-x52i","title":"harden-7+9: Timer audit sweep + coding standards","status":"open","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-02-10T16:45:00.831968-08:00","created_by":"mayor","updated_at":"2026-02-10T16:45:00.831968-08:00"}
{"id":"nostrc-y9f","title":"Migrate NIP-47 Nostr Wallet Connect to plugin","description":"## Goal\n\nMigrate NIP-47 (Nostr Wallet Connect) from built-in to plugin architecture.\n\n## Current Implementation\n- `nips/nip47/` - NWC client/wallet protocol\n- Settings for NWC connection string\n- Wallet balance display\n\n## Migration Steps\n\n1. Create plugin: `plugins/nip47-nwc/`\n2. Move NWC client implementation\n3. Register event handlers:\n   - Kind 23194 (request)\n   - Kind 23195 (response)\n4. Plugin API for other plugins to request payments:\n   `gnostr_nwc_pay_invoice(plugin, invoice, callback)`\n5. Add UI hooks for:\n   - Wallet settings page\n   - Balance indicator\n   - Transaction history\n6. Settings:\n   - NWC connection string\n   - Default wallet\n\n## Integration Notes\n- NIP-57 zaps plugin will depend on this for sending\n- Must expose API for inter-plugin communication\n\n## Dependencies\n- Plugin loader (nostrc-oxt) must be complete","status":"closed","priority":3,"issue_type":"task","assignee":"boris","created_at":"2026-01-30T09:26:56.015449-08:00","created_by":"mayor","updated_at":"2026-01-31T18:28:52.000855-08:00","closed_at":"2026-01-31T18:28:52.000855-08:00","close_reason":"Plugin migration complete with all interfaces implemented - GnostrPlugin, GnostrEventHandler, GnostrUIExtension. Commit 11a6407.","labels":["nip","plugin"],"dependencies":[{"issue_id":"nostrc-y9f","depends_on_id":"nostrc-bv7","type":"parent-child","created_at":"2026-01-30T09:27:01.117709-08:00","created_by":"mayor"},{"issue_id":"nostrc-y9f","depends_on_id":"nostrc-oxt","type":"blocks","created_at":"2026-01-30T09:27:01.211285-08:00","created_by":"mayor"}]}
{"id":"nostrc-yaci","title":"Avatar fetch gets HTML error pages: no Content-Type check","description":"8 distinct avatar URLs return HTML 200 instead of images. No Content-Type validation on response, no negative caching. Add Content-Type check and cache failed URLs to avoid repeated fetches.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-08T12:34:48.680046-08:00","created_by":"mayor","updated_at":"2026-02-08T12:50:58.719438-08:00","closed_at":"2026-02-08T12:50:58.719438-08:00","close_reason":"Closed"}
{"id":"nostrc-yb6","title":"Thread viewer profile image size irregular - must be 48x48px","description":"## Problem\n\nProfile image/avatar size in thread viewer is irregular. Must be constrained to 48x48px even when displaying just initials.\n\n## Similar Fix\n\nThis is the same pattern as the Discover panel avatar fix (247a388):\n- Avatar container needs explicit width-request and height-request\n- Initials label needs same constraints\n\n## Files to Check\n\n- Thread viewer UI files (.blp and .ui)\n- gnostr-thread-view.c for avatar handling","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T10:56:35.151423-08:00","created_by":"mayor","updated_at":"2026-01-30T10:57:42.079126-08:00","closed_at":"2026-01-30T10:57:42.079126-08:00","close_reason":"Added width-request: 48 and height-request: 48 to avatar_initials label in note-card-row.blp","labels":["avatar","ui"]}
{"id":"nostrc-yct","title":"timeline has_note_key uses O(n) linear scan","description":"has_note_key() (lines 238-244) does O(n) linear scan for each new note. With 1000+ notes and batch insertions, this becomes O(n¬≤). Consider using a GHashTable for O(1) lookups keyed by note_key. The notes GArray can remain for ordered iteration. File: apps/gnostr/src/model/gn-timeline-model.c","status":"closed","priority":3,"issue_type":"task","assignee":"bruce","created_at":"2026-01-29T09:43:35.182248-08:00","created_by":"flotilla_budabit/crew/gus","updated_at":"2026-01-29T10:33:42.298854-08:00","closed_at":"2026-01-29T10:33:42.298854-08:00","close_reason":"Fixed: added note_key_set GHashTable for O(1) lookups instead of O(n) linear scan"}
{"id":"nostrc-yd2","title":"integrate timeline batch mode API into initial load","description":"The begin_batch/end_batch API (lines 715-752) is defined but not called anywhere. Need to integrate into the initial timeline load path to prevent widget recycling storms during startup. The API documentation suggests wrapping initial subscription load. File: apps/gnostr/src/model/gn-timeline-model.c","status":"closed","priority":2,"issue_type":"task","assignee":"bruce","created_at":"2026-01-29T09:43:40.749234-08:00","created_by":"flotilla_budabit/crew/gus","updated_at":"2026-01-29T10:33:42.262164-08:00","closed_at":"2026-01-29T10:33:42.262164-08:00","close_reason":"Fixed: model now starts in batch mode with 500ms timeout to end after initial load"}
{"id":"nostrc-yfp","title":"Launch gnostr and triage bugs from runtime logs","description":"Build and launch the gnostr application, capture all runtime output (stdout/stderr), and parse out bugs, warnings, critical errors, and crashes from the logs.\n\nSteps:\n1. Build gnostr from the rig (cmake build)\n2. Launch the application with verbose/debug logging enabled\n3. Capture all GLib warnings (g_warning, g_critical, g_error)\n4. Capture ASAN/UBSAN/TSAN reports if sanitizers enabled\n5. Capture segfaults, assertion failures, unhandled signals\n6. Capture GTK deprecation warnings and widget errors\n7. Capture NostrDB errors and relay connection failures\n8. Parse and categorize all issues by severity\n9. Create individual beads for each distinct bug found\n10. Close this bead with a summary report\n\nRun for at least 30-60 seconds to capture startup + initial sync + timeline load.","status":"closed","priority":1,"issue_type":"task","assignee":"nostrc/boris","created_at":"2026-02-08T12:22:52.921627-08:00","created_by":"mayor","updated_at":"2026-02-08T12:33:19.679349-08:00","closed_at":"2026-02-08T12:33:19.679349-08:00","close_reason":"Closed"}
{"id":"nostrc-yg9","title":"Worker thread stack too small for ASAN - need explicit stack size","description":"subscribe_many_thread (Thread T25) still overflows under ASAN even after hq-somxz fix removed JSON serialization. Now crashes on g_ptr_array_new_with_free_func at line 732 - basic malloc. Root cause: g_thread_new uses default pthread stack size (~8MB) which is insufficient under ASAN (3-4x frame inflation). Fix: replace g_thread_new with pthread_create + pthread_attr_setstacksize (e.g. 32MB for ASAN builds), or refactor subscribe_many_thread to reduce stack frame size.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-07T15:51:07.53575-08:00","created_by":"mayor","updated_at":"2026-02-07T18:40:07.373232-08:00","closed_at":"2026-02-07T18:40:07.373232-08:00","close_reason":"Closed"}
{"id":"nostrc-zkj","title":"Integrate NDB profile search for user discovery","description":"NDB_DB_PROFILE_SEARCH provides full-text search on profile names/display names. Currently 0% used. Add profile search UI - could be in discovery tab, contact search, or mention autocomplete. Use ndb_text_search on profile index.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-07T17:20:32.677139-08:00","created_by":"mayor","updated_at":"2026-02-08T02:17:53.548872-08:00","closed_at":"2026-02-08T02:17:53.548872-08:00","close_reason":"Closed"}
{"id":"nostrc-zwn4","title":"Implement NIP-23 long-form content (articles)","description":"NIP-23 defines kind 30023 long-form content ‚Äî blog posts/articles on Nostr.\n\nImplement:\n- Parse kind 30023 events (title, summary, image, published_at, content in markdown)\n- Article card in timeline (different from note cards ‚Äî shows title, summary, cover image)\n- Article reader view with markdown rendering\n- Article composer/editor for creating long-form posts\n- d-tag for replaceable events (editing published articles)","status":"closed","priority":2,"issue_type":"task","assignee":"nostrc/barry","created_at":"2026-02-08T13:27:13.377172-08:00","created_by":"mayor","updated_at":"2026-02-08T14:10:48.482806-08:00","closed_at":"2026-02-08T14:10:48.482806-08:00","close_reason":"NIP-23 long-form content done by barry, pushed 0148d33"}
